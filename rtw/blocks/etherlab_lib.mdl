Library {
  Name			  "etherlab_lib"
  Version		  6.4
  MdlSubVersion		  0
  SavedCharacterEncoding  "ISO-8859-1"
  LibraryType		  "BlockLibrary"
  SaveDefaultBlockParams  on
  SampleTimeColors	  off
  LibraryLinkDisplay	  "all"
  WideLines		  off
  ShowLineDimensions	  off
  ShowPortDataTypes	  off
  ShowLoopsOnError	  on
  IgnoreBidirectionalLines off
  ShowStorageClass	  off
  ShowTestPointIcons	  on
  ShowViewerIcons	  on
  SortedOrder		  off
  ExecutionContextIcon	  off
  ShowLinearizationAnnotations on
  ScopeRefreshTime	  0.035000
  OverrideScopeRefreshTime on
  DisableAllScopes	  off
  BlockNameDataTip	  off
  BlockParametersDataTip  off
  BlockDescriptionStringDataTip	off
  ToolBar		  on
  StatusBar		  on
  BrowserShowLibraryLinks off
  BrowserLookUnderMasks	  off
  Created		  "Tue Dec 27 14:12:39 2005"
  Creator		  "rich"
  UpdateHistory		  "UpdateHistoryNever"
  ModifiedByFormat	  "%<Auto>"
  LastModifiedBy	  "rich"
  ModifiedDateFormat	  "%<Auto>"
  LastModifiedDate	  "Tue Aug 26 00:32:13 2008"
  ModelVersionFormat	  "1.%<AutoIncrement:678>"
  ConfigurationManager	  "rcs"
  LinearizationMsg	  "none"
  Profile		  off
  ParamWorkspaceSource	  "MATLABWorkspace"
  CovSaveName		  "covdata"
  CovMetricSettings	  "dw"
  CovNameIncrementing	  off
  CovHtmlReporting	  on
  covSaveCumulativeToWorkspaceVar on
  CovSaveSingleToWorkspaceVar on
  CovCumulativeReport	  off
  CovReportOnPause	  on
  ExtModeBatchMode	  off
  ExtModeEnableFloating	  on
  ExtModeTrigType	  "manual"
  ExtModeTrigMode	  "normal"
  ExtModeTrigPort	  "1"
  ExtModeTrigElement	  "any"
  ExtModeTrigDuration	  1000
  ExtModeTrigDurationFloating "auto"
  ExtModeTrigHoldOff	  0
  ExtModeTrigDelay	  0
  ExtModeTrigDirection	  "rising"
  ExtModeTrigLevel	  0
  ExtModeArchiveMode	  "off"
  ExtModeAutoIncOneShot	  off
  ExtModeIncDirWhenArm	  off
  ExtModeAddSuffixToVar	  off
  ExtModeWriteAllDataToWs off
  ExtModeArmWhenConnect	  on
  ExtModeSkipDownloadWhenConnect off
  ExtModeLogAll		  on
  ExtModeAutoUpdateStatusClock off
  ProdHWDeviceType	  "32-bit Generic"
  ShowModelReferenceBlockVersion off
  ShowModelReferenceBlockIO off
  BlockDefaults {
    Orientation		    "right"
    ForegroundColor	    "black"
    BackgroundColor	    "white"
    DropShadow		    off
    NamePlacement	    "normal"
    FontName		    "Bitstream Charter"
    FontSize		    10
    FontWeight		    "normal"
    FontAngle		    "normal"
    ShowName		    on
  }
  BlockParameterDefaults {
    Block {
      BlockType		      "S-Function"
      FunctionName	      "system"
      SFunctionModules	      "''"
      PortCounts	      "[]"
    }
    Block {
      BlockType		      SubSystem
      ShowPortLabels	      on
      Permissions	      "ReadWrite"
      PermitHierarchicalResolution "All"
      TreatAsAtomicUnit	      off
      SystemSampleTime	      "-1"
      RTWFcnNameOpts	      "Auto"
      RTWFileNameOpts	      "Auto"
      RTWMemSecFuncInitTerm   "Inherit from model"
      RTWMemSecFuncExecute    "Inherit from model"
      RTWMemSecDataConstants  "Inherit from model"
      RTWMemSecDataInternal   "Inherit from model"
      RTWMemSecDataParameters "Inherit from model"
      SimViewingDevice	      off
      DataTypeOverride	      "UseLocalSettings"
      MinMaxOverflowLogging   "UseLocalSettings"
    }
  }
  AnnotationDefaults {
    HorizontalAlignment	    "center"
    VerticalAlignment	    "middle"
    ForegroundColor	    "black"
    BackgroundColor	    "white"
    DropShadow		    off
    FontName		    "Bitstream Charter"
    FontSize		    10
    FontWeight		    "normal"
    FontAngle		    "normal"
  }
  LineDefaults {
    FontName		    "Bitstream Charter"
    FontSize		    9
    FontWeight		    "normal"
    FontAngle		    "normal"
  }
  System {
    Name		    "etherlab_lib"
    Location		    [790, 495, 1385, 888]
    Open		    on
    ModelBrowserVisibility  off
    ModelBrowserWidth	    200
    ScreenColor		    "white"
    PaperOrientation	    "landscape"
    PaperPositionMode	    "auto"
    PaperType		    "usletter"
    PaperUnits		    "inches"
    TiledPaperMargins	    [0.500000, 0.500000, 0.500000, 0.500000]
    TiledPageScale	    1
    ShowPageBoundaries	    off
    ZoomFactor		    "100"
    ReportName		    "simulink-default.rpt"
    Block {
      BlockType		      SubSystem
      Name		      "EtherCAT"
      Ports		      []
      Position		      [295, 39, 366, 100]
      MinAlgLoopOccurrences   off
      RTWSystemCode	      "Auto"
      FunctionWithSeparateData off
      MaskHideContents	      off
      System {
	Name			"EtherCAT"
	Location		[898, 520, 1395, 994]
	Open			on
	ModelBrowserVisibility	off
	ModelBrowserWidth	200
	ScreenColor		"white"
	PaperOrientation	"landscape"
	PaperPositionMode	"auto"
	PaperType		"A4"
	PaperUnits		"centimeters"
	TiledPaperMargins	[0.500000, 0.500000, 0.500000, 0.500000]
	TiledPageScale		1
	ShowPageBoundaries	off
	ZoomFactor		"100"
	Block {
	  BlockType		  "S-Function"
	  Name			  "AIN_0"
	  Ports			  [0, 1]
	  Position		  [25, 80, 105, 120]
	  BackgroundColor	  "yellow"
	  FunctionName		  "ec_slave2"
	  Parameters		  "Address,SlaveConfig,SdoConfig,output,debug,"
"tsample"
	  MaskType		  "EL31xx"
	  MaskDescription	  "Beckhoff 2,4,8-Channel 16-Bit Analog Input"
"\n\nOutput Type:\n  1-Byte output: one bit coded input\n  Vector output: Outp"
"ut vector is <Channels> wide\n  Separate outputs: have <Channels> number of o"
"utputs\n\nInput Gain/Offset:\n  Specify a possible Gain and Offset for the in"
"put signal"
	  MaskHelp		  "This block generically implements the Ether"
"CAT 16-Bit Analog Input Terminal for various models.\n<p/>\nThe following Ter"
"minals are supported:\n<center>\n<table width=\"80%\">\n<tr><td>EL3102,4,8</t"
"d><td>-10..10V Voltage Input</td></tr>\n<tr><td>EL3112,4   </td><td>0..20mA C"
"urrent Input</td></tr>\n<tr><td>EL3122,4   </td><td>4..20mA Current Input</td"
"></tr>\n<tr><td>EL3142,4,8</td><td>0..20mA Current Input</td></tr>\n<tr><td>E"
"L3152,4,8</td><td>4..20mA Current Input</td></tr>\n<tr><td>EL3162,4,8</td><td"
">0..10V Voltage Input</td></tr>\n</table>\n</center>\n<p/>\nChoose and set th"
"e following options:\n<h4>Master:</h4>\nSet the EtherCAT Master of this termi"
"nal.\n\n<h4>Slave Index:</h4>\nSet the EtherCAT slave index. Following addres"
"s formats are allowed:\n<ol>\n<li> Absolute addressing: a number <<b><tt>n</t"
"t></b>> representing the (zero based) absolute index. <b><tt>n</tt></b> is ty"
"pically larger than 0 because the first coupler has that address.\n\n<li> Fie"
"ld addressing: Has the form <<b><tt>f:n</tt></b>> where <b><tt>f</tt></b> is "
"the (zero based) EtherCAT coupler field and \n<b><tt>n</tt></b> is the termin"
"al offset in that field. Take note that <b><tt>n</tt></b> is also greater tha"
"n 0.\n\n<li> SSId addressing: the Secondary Slave Addressing has the form <<b"
"><tt>#s:n</tt></b>> where <b><tt>s</tt></b> is the Secondary Slave Id of the "
"EtherCAT coupler and <b><tt>n</tt></b> is the offset in that field. The SSId "
"has to be preprogrammed into the coupler with other service tools.\n</ol>\n\n"
"<h4>Device Model:</h4>\nChoose the model at the Indexed position of the maste"
"r.\n\n<h4>Output Type:</h4>\n<ul>\n<li>Choose <b>Vector Output</b> to have a "
"single output as a vector\nwith a size corresponding to the channel count of "
"the terminal. This mode also allows a status output port to be displayed. <br"
"/>\n<li>Choose <b>Separate Outputs</b> to have one output for every channel."
"\n</ul>\n<h4>Output Full Scale</h4>\nWhen <b>Output Data Type</b> is set to <"
"b>Double with scale and offset</b>, the block's output value at full scale te"
"rminal input can be set here.\n\n<h4>Output Offset</h4>\nWhen <b>Output Data "
"Type</b> is set to <b>Double with scale and offset</b>, the blocks output at "
"zero terminal input can be set here. Note that the Full Scale above is also i"
"ncreased by this amount. Note furthermore that this corresponds to the minimu"
"m input for terminals such as 4..20mA.\n\n<h4>Output Data Type</h4>\nChoose t"
"he block's output data type for the output signal. Available are:\n<ul>\n<li>"
"<b><tt>Raw</tt></b> outputting the internal raw value as <tt>int16_T</tt> or "
"<tt>uint16_T</tt> as appropriate\n<li><b><tt>Double</tt></b> outputting 0..10"
", -10..10, 0..0.02 and 0.004..0.02 depending on the Model as appropriate\n<li"
"><b><tt>Double with scale and offset</tt></b>, allowing the output to be scal"
"ed with an offset.\n</ul>\n\n<p>\nChoosing <b>Status Output</b> provides a po"
"rt of type <tt>uint8_T</tt> where the status is presented. This is only enabl"
"ed when <b>Vector Output</b> is selected. Terminal input over- and underrange"
" can be detected using this output. See the terminal's documentation.\n\n<h4>"
"Output Filter</h4>\nWhen not in <b>Raw</b> mode, the <b>Output Filter</b> che"
"ckbox becomes available, allowing the use of an internal low pass filter. Ent"
"er the <b>LPF Time Constant</b> for the filter in the field below.\n<br>For c"
"ontinuous sample time systems (0 in Sample Time), the filter is also continuo"
"us. Discrete samples systems (Sample Time > 0) uses an equivalent discrete lo"
"w pass filter with a similar time constant.\n\n<p>\nSet the <b>Sample Time</b"
"> for the block. <tt>0</tt> is continuous sample time (runs at the model's ba"
"se rate). Setting <tt>-1</tt> will try to set the time using back propagation"
".\n"
	  MaskPromptString	  "Master|Slave Index|Device Model |Output Typ"
"e |Output Scale|Output Offset|Output Data Type|Status Output|Output Filter|LP"
"F Time Constant (sec)|Sample Time|Debug"
	  MaskStyleString	  "edit,edit,popup(EL3102|EL3152|EL3162),popup"
"(Vector Output|Separate Outputs),edit,edit,popup(Raw bits|Double|Double with "
"scale and offset),checkbox,checkbox,edit,edit,edit"
	  MaskTunableValueString  "off,off,off,off,off,off,off,off,off,off,off"
",off"
	  MaskCallbackString	  "|||el31xx_check('output_type');\n|||el31xx_"
"check('dtype');||el31xx_check('filter');|||"
	  MaskEnableString	  "on,on,on,on,off,off,on,on,on,off,on,on"
	  MaskVisibilityString	  "on,on,on,on,on,on,on,on,on,on,on,off"
	  MaskToolTipString	  "on,on,on,on,on,on,on,on,on,on,on,on"
	  MaskVarAliasString	  ",,,,,,,,,,,"
	  MaskVariables		  "master=@1;index=@2;model=&3;output_type=@4;"
"scale=@5;offset=@6;dtype=@7;status=@8;filter=@9;tau=@10;tsample=@11;debug=@12"
";"
	  MaskInitialization	  "masterStr = '';\npositionStr = '';\n[Addres"
"s masterStr positionStr] = getEtherCATAddress(gcb,master,index);\n\nSdoConfig"
" = [];\n\n% Find the product code from the available models\nmodels = struct("
"...\n    'EL3102'  ,{{hex2dec('0C1E3052') 0 '-10..10V'}}, ...\n    'EL3152'  "
",{{hex2dec('0C503052') 0 '4..20mA'}}, ...\n    'EL3162'  ,{{hex2dec('0C5A3052"
"') 0 '0-10V'}} ...  \n    );\n\nif isfield(models,model)\n    selection = mod"
"els.(model);\nelse\n    errordlg([gcb ': Slave model \"' model '\" is not imp"
"lemented'])\nend\n\nfunc = selection{3};\n\nEtherCATInfoFile = 'EtherCATInfo_"
"el3xxx';\ntry \n    load(EtherCATInfoFile);\ncatch\n    errordlg([gcb ': Coul"
"d not load EtherCATInfo MAT file '...\n        'EtherCATInfo_el3xxx']);\n    "
"% Regenerate with: \n    %  EtherCATInfo_el3xxx = getEtherCATInfo('Beckhoff E"
"L3xxx.xml')\n    %  save EtherCATInfo_el3xxx 'EtherCATInfo_el3xxx'\nend\nLayo"
"utVersion = 0;\n\noutput = [];\n\ndevice = EtherCATInfo_el3xxx(selection{1},s"
"election{2});\nif isempty(device)\n    errordlg(sprintf(...\n        ['%s: Co"
"uld not find device with\\n'...\n        'ProductCode \\t#x%08X\\n'...\n     "
"   'RevisionNo \\t#x%08X\\n'...\n        'in file %s.'],...\n        gcs, sel"
"ection{1}, selection{2}, EtherCATInfoFile));\nelse\n    channels = str2double"
"(model(6));\n    if status\n        StatusPdoEntries = [12544 + (1:channels);"
" ones(1,channels)]';\n        PdoEntries = [12544 + (1:channels); 1 + ones(1,"
"channels)]';\n    else\n        PdoEntries = [25600 + ones(1,channels); 1:cha"
"nnels]';\n        %% Actually the above line is correct, but because the slav"
"es\n        % are faulty, we are forced to use the Pdo Entry below\n        P"
"doEntries = [12544 + (1:channels); 1 + ones(1,channels)]';\n    end\n    \n  "
"  output.Pdo.Exclude = hex2dec('1A10');\n\n    SlaveConfig = genSlaveConfig(d"
"evice);\n    if output_type == 1\n        % Vector output chosen\n\n        o"
"utput.Port(1).PdoEntry = PdoEntries;\n\n        if status\n            output"
".Port(2).PdoEntry = StatusPdoEntries;\n        end\n\n        if dtype ~= 1\n"
"             output.Port(1).PdoFullScale = 2^15;\n\n            if dtype == 3"
"\n                output.Port(1).Gain = scale;\n                output.Port(1"
").Offset = offset;\n                output.Port(1).GainName = 'FullScale';\n "
"               output.Port(1).OffsetName = 'Offset';\n            end\n      "
"      if filter\n                if sum(tau == 0)\n                    errord"
"lg([gcb ': Specify a nonzero time constant '...\n                        'for"
" the output filter.']);\n                end\n                if (tsample)\n "
"                   output.Port(1).Filter = tsample./tau;\n                   "
" output.Port(1).FilterName = 'InputWeight';\n                else\n          "
"          output.Port(1).Filter = 2*pi./tau;\n                    output.Port"
"(1).FilterName = 'Omega';\n                end\n            end\n        end"
"\n\n    else\n        % Separate outputs chosen\n        % Distribute each ro"
"w of output_pdo_map to output(x).pdo_map\n        output.Port = cell2struct(m"
"at2cell(PdoEntries,ones(1,channels),2),'PdoEntry',2);\n        if status\n   "
"         output.Port = [output.Port; ...\n                cell2struct(mat2cel"
"l(StatusPdoEntries,ones(1,channels),2),'PdoEntry',2)];\n        end\n\n      "
"  if dtype ~= 1\n            for i = 1:channels\n                output.Port("
"i).PdoFullScale = 2^15;\n            end\n\n            if dtype == 3\n      "
"          if ~isempty(scale)\n                    for i = 1:channels\n       "
"                 % Choose scale(1) for every output if scale\n               "
"         % is a scalar\n                        output.Port(i).Gain = scale(m"
"in(i,max(size(scale))));\n                        output.Port(i).GainName = ["
"'FullScale' num2str(i)];\n                    end\n                end\n\n   "
"             if ~isempty(offset)\n                    for i = 1:channels\n   "
"                     % Choose offset(1) for every output if offset\n         "
"               % is a scalar\n                        output.Port(i).Offset ="
" offset(min(i,max(size(offset))));\n                        output.Port(i).Of"
"fsetName = ['Offset' num2str(i)];\n                    end\n                e"
"nd\n            end\n\n            if filter && ~isempty(tau)\n              "
"  if sum(tau == 0)\n                    errordlg([gcb ': Specify a nonzero ti"
"me constant '...\n                        'for the output filter.']);\n      "
"          end\n\n                if tsample(1)\n                    k = tsamp"
"le(1)./tau;\n                    prefix = 'InputWeight';\n                els"
"e\n                    k = 2*pi./tau;\n                    prefix = 'Omega';"
"\n                end\n                for i = 1:channels\n                  "
"  % Choose k(1) for every output if k\n                    % is a scalar\n   "
"                 output.Port(i).Filter = k(min(i,max(size(k))));\n           "
"         output.Port(i).FilterName = [prefix num2str(i)];\n                en"
"d\n\n            end\n        end\n    end\nend\n\n"
	  MaskDisplay		  "fprintf('%s\\n%s AIn\\nM:%s Idx:%s',...\n  "
"  model,func,masterStr,positionStr)\n\n"
	  MaskIconFrame		  on
	  MaskIconOpaque	  on
	  MaskIconRotate	  "none"
	  MaskIconUnits		  "autoscale"
	  MaskValueString	  "0|1|EL3102|Vector Output|1|0|Double|off|off"
"|0.1|0|0"
	  MaskTabNameString	  ",,,,,,,,,,,"
	}
	Block {
	  BlockType		  "S-Function"
	  Name			  "AOUT_0"
	  Ports			  [1]
	  Position		  [180, 80, 260, 120]
	  BackgroundColor	  "yellow"
	  FunctionName		  "ec_slave2"
	  Parameters		  "Address,SlaveConfig,SdoConfig,input,debug,t"
"sample"
	  MaskType		  "EL41xx"
	  MaskDescription	  "Beckhoff 2,4,8-Channel 16-Bit Analog Output"
"\n\nInput Type:\n  1-Byte input: one bit coded input\n  Vector input: Input v"
"ector is <Channels> wide\n  Separate inputs: have <Channels> number of inputs"
"\n"
	  MaskHelp		  "This block generically implements the Ether"
"CAT 16-Bit Analog Input Terminal for various models.\n<p/>\nThe block input i"
"s generally a <tt>double</tt> corresponding the the terminal's capability. Th"
"us a 4..20mA terminal expects values in the range [0.004..0.02). If a digital"
" input is required, only <tt>uint16</tt> or <tt>int16</tt> is accepted, depen"
"ding on whether the the terminal is bipolar or not.\n<p/>\nExceeding the inpu"
"t range simply saturates the terminal's output.\n<p/>\nThe following Terminal"
"s are supported:\n<center>\n<table width=\"80%\">\n<tr><td>EL4102,4,8</td><td"
">0..10V Voltage Output</td></tr>\n<tr><td>EL4112,4,8</td><td>0..20mA Current "
"Output</td></tr>\n<tr><td>EL4122,4,8</td><td>4..20mA Current Output</td></tr>"
"\n<tr><td>EL4132,4,8</td><td>-10..10V Voltage Output</td></tr>\n</table>\n</c"
"enter>\n<p/>\nChoose and set the following options:\n<h4>Master:</h4>\nSet th"
"e EtherCAT Master of this terminal.\n\n<h4>Slave Index:</h4>\nSet the EtherCA"
"T slave index. Following address formats are allowed:\n<ol>\n<li> Absolute ad"
"dressing: a number <<b><tt>n</tt></b>> representing the (zero based) absolute"
" index. <b><tt>n</tt></b> is typically larger than 0 because the first couple"
"r has that address.\n\n<li> Field addressing: Has the form <<b><tt>f:n</tt></"
"b>> where <b><tt>f</tt></b> is the (zero based) EtherCAT coupler field and \n"
"<b><tt>n</tt></b> is the terminal offset in that field. Take note that <b><tt"
">n</tt></b> is also greater than 0.\n\n<li> SSId addressing: the Secondary Sl"
"ave Addressing has the form <<b><tt>#s:n</tt></b>> where <b><tt>s</tt></b> is"
" the Secondary Slave Id of the EtherCAT coupler and <b><tt>n</tt></b> is the "
"offset in that field. The SSId has to be preprogrammed into the coupler with "
"other service tools.\n</ol>\n\n<h4>Device Model:</h4>\nChoose the device at t"
"he Indexed position of the master.\n\n<h4>Input Type:</h4>\n<ul>\n<li>Choose "
"<b>Vector Input</b> to have a single input as a vector\nwith a size correspon"
"ding to the channel count of the terminal. This mode also allows a control in"
"put and a status output port to be displayed.\n<li>Choose <b>Separate Inputs<"
"/b> to have one input for every channel.\n</ul>\n\n<p>\nChoosing <b>Status Ou"
"tput</b> provides a port of type <tt>uint8_T</tt> where the status is present"
"ed. This is only enabled when <b>Vector Output</b> is selected. Note: at the "
"time of writing (1.2.2006) the terminals do not have a status output, and hen"
"ce this option is disabled!\n\n<p>\nSet the <b>Sample Time</b> for the block."
" <tt>0</tt> is continuous sample time (runs at the model's base rate). Settin"
"g <tt>-1</tt> will try to set the time using back propagation.\n"
	  MaskPromptString	  "Master|Slave Index|Device Model |Input Type"
" |Input Scale (empty for none)|Sample Time (-1 for inherited)|Debug"
	  MaskStyleString	  "edit,edit,popup(EL4102v2|EL4112|EL4122|EL41"
"32v2|-- Obsolete|EL4102|EL4132),popup(Vector Input|Separate Inputs),edit,edit"
",edit"
	  MaskTunableValueString  "off,off,off,off,off,off,off"
	  MaskCallbackString	  "|||\n|||"
	  MaskEnableString	  "on,on,on,on,on,on,on"
	  MaskVisibilityString	  "on,on,on,on,on,on,off"
	  MaskToolTipString	  "on,on,on,on,on,on,on"
	  MaskVarAliasString	  ",,,,,,"
	  MaskVariables		  "master=@1;index=@2;model=&3;input_type=@4;s"
"cale=@5;tsample=@6;debug=@7;"
	  MaskInitialization	  "masterStr = '';\npositionStr = '';\n[Addres"
"s masterStr positionStr] = getEtherCATAddress(gcb,master,index);\n\nSdoConfig"
" = [];\n\n% Find the product code from the available models\nmodels = struct("
"...\n    'EL4102'  ,{{hex2dec('10063052'), hex2dec('F0000000'), '0..10V' }}, "
"...\n    'EL4102v2',{{hex2dec('10063052'), 0                  , '0..10V' }}, "
"...\n    'EL4132'  ,{{hex2dec('10243052'), hex2dec('F0000000'), '+-10V'  }}, "
"...\n    'EL4132v2',{{hex2dec('10243052'), 0                  , '+-10V'  }}, "
"...\n    'EL4122'  ,{{hex2dec('101a3052'), 0                  , '4..20mA'}},."
"..  \n    'EL4112'  ,{{hex2dec('10103052'), 0                  , '0..20mA'}} "
"...  \n    );\n\nSdoConfig = [];\n\nif isfield(models,model)\n    selection ="
" models.(model);\nelse\n    errordlg([gcb ': Slave model \"' model '\" is not"
" implemented'])\nend\n\nfunc = selection{3};\n\nEtherCATInfoFile = 'EtherCATI"
"nfo_el4xxx';\ntry \n    load(EtherCATInfoFile);\ncatch\n    errordlg([gcb ': "
"Could not load EtherCATInfo MAT file '...\n        'EtherCATInfo_el4xxx']);\n"
"    % Regenerate with: \n    %  EtherCATInfo_el4xxx = getEtherCATInfo('Beckho"
"ff EL4xxx.xml')\n    % Note that in this case you will not have Rev #xF000000"
"0 for\n    % EL4132 then, unless you create one yourself\nend\n\nLayoutVersio"
"n = 0;\n\ndevice = EtherCATInfo_el4xxx(selection{1},selection{2});\ninput = ["
"];\nif isempty(device)\n    errordlg(sprintf(...\n        ['%s: Could not fin"
"d device with\\n'...\n        'ProductCode \\t#x%08X\\n'...\n        'Revisio"
"nNo \\t#x%08X\\n'...\n        'in file %s.'],...\n        gcs, selection{1}, "
"selection{2}, EtherCATInfoFile));\nelse\n    SlaveConfig = genSlaveConfig(dev"
"ice);\n    % Number of channels is given by the 6'th character of model strin"
"g\n    channels = str2double(model(6));\n\n    input = [];\n    if input_type"
" == 1\n        PdoEntryMap = getEntries(device, 'GroupType', 'All');\n       "
" input.Port = cell2struct(PdoEntryMap,'PdoEntry',1);\n        input.Port.PdoF"
"ullScale = 2^15;\n        if ~isempty(scale)\n            input.Port.Gain = s"
"cale;\n            input.Port.GainName = 'FullScale';\n        end\n    elsei"
"f input_type == 2\n        PdoEntryMap = getEntries(device);\n        fs = re"
"pmat({2^15},1,channels);\n        input.Port = struct('PdoEntry', PdoEntryMap"
", 'PdoFullScale', 2^15);\n        if ~isempty(scale)\n            for i = 1:c"
"hannels\n                input.Port(i).Gain = scale(min(i,max(size(scale))));"
"\n                input.Port(i).GainName = ['FullScale' num2str(i)];\n       "
"     end\n        end\n    end\nend\n\n"
	  MaskDisplay		  "fprintf('%s\\n%s AIn\\nM:%s Idx:%s',...\n  "
"  model,func,masterStr,positionStr)\n"
	  MaskIconFrame		  on
	  MaskIconOpaque	  on
	  MaskIconRotate	  "none"
	  MaskIconUnits		  "autoscale"
	  MaskValueString	  "0|1|EL4132v2|Vector Input|[]|-1|0"
	  MaskTabNameString	  ",,,,,,"
	}
	Block {
	  BlockType		  "S-Function"
	  Name			  "DIN_0"
	  Ports			  [0, 1]
	  Position		  [25, 19, 105, 61]
	  BackgroundColor	  "yellow"
	  FunctionName		  "ec_slave2"
	  Parameters		  "Address,SlaveConfig,SdoConfig,IOSpec,debug,"
"tsample"
	  MaskType		  "EL10xx"
	  MaskDescription	  "Beckhoff EtherCAT Digital Input\nEL1002,4,8"
":	3ms filter\nEL1012,4,8:	10us filter\nEL1034           24V flo"
"ating, 10us filter\nEL1004v2: Newer version with PDO at 0x6000\n\nOutput Type"
":\n  1-Byte output: one bit coded output\n  Vector output: Output vector is <"
"Channels> wide\n  Separate outputs: have <Channels> number of outputs"
	  MaskHelp		  "This block implements the Beckhoff's EtherC"
"AT series of Digital Input Terminals.\n<p/>\nChoose or set the following opti"
"ons:\n<h4>Master:</h4>\nSet the EtherCAT Master number that this terminal is "
"connected to.\n\n<h4>Slave Index:</h4>\nSet the EtherCAT slave index. Followi"
"ng address formats are allowed:\n<ol>\n<li> Absolute addressing: a number <<b"
"><tt>n</tt></b>> representing the (zero based) absolute index. <b><tt>n</tt><"
"/b> is typically larger than 0 because the first coupler has that address.\n"
"\n<li> Field addressing: Has the form <<b><tt>f:n</tt></b>> where <b><tt>f</t"
"t></b> is the (zero based) EtherCAT coupler field and \n<b><tt>n</tt></b> is "
"the terminal offset in that field. Take note that <b><tt>n</tt></b> is also g"
"reater than 0.\n\n<li> SSId addressing: the Secondary Slave Addressing has th"
"e form <<b><tt>#s:n</tt></b>> where <b><tt>s</tt></b> is the Secondary Slave "
"Id of the EtherCAT coupler and <b><tt>n</tt></b> is the offset in that field."
" The SSId has to be preprogrammed into the coupler with other service tools."
"\n</ol>\n\n<h4> Device Model</h4>\nSelect the model that is used. This sets t"
"he number of outputs of this block.\n\n<h4>Output Type</h4>\nThe block output"
" type corresponding to the terminal inputs can be one of the following:\n<ul>"
"\n<li><b>1-Byte Output</b>: This sets one output where each digital input to "
"the terminal occupies one bit.\n<li><b>Vector Output</b>: This sets one outpu"
"t vector with a width equal to the number of digital inputs to the terminal. "
"\n<li><b>Separate Outputs</b>: This sets the number of outputs corresponding "
"to the digital inputs to the terminal. \n</ul>\n\n<h4>Output Data Type</h4>\n"
"Select the output data type that is required.\n\n<h4>Sample Time</h4>\nSelect"
" the correct sample time. Setting this to 0 makes for a sample time at the mo"
"del's base rate. If another block can set the sample time, choose -1 for inhe"
"rited sample time."
	  MaskPromptString	  "Master|Slave Index|Device Model |Output Typ"
"e|Sample Time|Deug Level"
	  MaskStyleString	  "edit,edit,popup(EL1004v2|EL1008|EL1014v2|EL"
"1018|EL1034|-- Obsolete|EL1004|EL1014),popup(Vector Output|Separate Outputs),"
"edit,edit"
	  MaskTunableValueString  "off,off,off,off,off,off"
	  MaskCallbackString	  "|||||"
	  MaskEnableString	  "on,on,on,on,on,on"
	  MaskVisibilityString	  "on,on,on,on,on,off"
	  MaskToolTipString	  "on,on,on,on,on,on"
	  MaskVarAliasString	  ",,,,,"
	  MaskVariables		  "master=@1;index=@2;model=&3;output_type=&4;"
"tsample=@5;debug=@6;"
	  MaskInitialization	  "masterStr = '';\npositionStr = '';\n[Addres"
"s masterStr positionStr] = getEtherCATAddress(gcb,master,index);\n\nSdoConfig"
" = [];\n\n% Find the product code from the available models\nmodels = struct("
"...\n    'EL1004'  ,[hex2dec('03ec3052')     hex2dec('0010000A')], ...\n    '"
"EL1004v2',[hex2dec('03ec3052')     hex2dec('00100000')], ...\n    'EL1008'  ,"
"[hex2dec('03f03052')     hex2dec('00100000')], ...\n    'EL1014v2',[hex2dec('"
"03f63052')     hex2dec('00100000')], ...  \n    'EL1014'  ,[hex2dec('03f63052"
"')     hex2dec('00000000')], ...  \n    'EL1018'  ,[hex2dec('03fa3052')     h"
"ex2dec('00100000')], ...\n    'EL1034'  ,[hex2dec('040a3052')     hex2dec('00"
"100000')]  ...\n    );\n\nif isfield(models,model)\n    selection = models.(m"
"odel);\nelse\n    errordlg([gcb ': Slave model \"' model '\" is not implement"
"ed'])\nend\n\nEtherCATInfoFile = 'EtherCATInfo_el1xxx';\ntry \n    load(Ether"
"CATInfoFile);\ncatch\n    errordlg([gcb ': Could not load EtherCATInfo MAT fi"
"le '...\n        'EtherCATInfo_el1xxx']);\n    % Regenerate with: \n    %  Et"
"herCATInfo_el1xxx = getEtherCATInfo('Beckhoff EL1xxx.xml')\n    %  save Ether"
"CATInfo_el1xxx\nend\n\nLayoutVersion = 0;\n\nIOSpec = [];\n\ndevice = EtherCA"
"TInfo_el1xxx(selection(1),selection(2));\nif isempty(device)\n    errordlg(sp"
"rintf(...\n        ['%s: Could not find device with\\n'...\n        'ProductC"
"ode \\t#x%08X\\n'...\n        'RevisionNo \\t#x%08X\\n'...\n        'in file "
"%s.'],...\n        gcs, selection(1), selection(2), EtherCATInfoFile));\nelse"
"\n    \n    SlaveConfig = genSlaveConfig(device);\n    \n    if strcmp(output"
"_type, 'Vector Output')\n        % Only one output, with all rows of pdo_map"
"\n        PdoEntryMap = getEntries(device, 'GroupType', 'All');\n        IOSp"
"ec.Port = cell2struct(PdoEntryMap,'PdoEntry',1);\n\n    elseif strcmp(output_"
"type, 'Separate Outputs')\n        % Have (channel) number of outputs, each c"
"ontaining one row of pdo_map\n        PdoEntryMap = getEntries(device);\n    "
"    IOSpec.Port = cell2struct(PdoEntryMap,'PdoEntry',1);\n    else\n        e"
"rrordlg([gcb ': unknown output type: ' output_type]);\n        IOSpec = [];\n"
"    end\nend"
	  MaskDisplay		  "fprintf('%s\\nM:%s Idx:%s',...\n    model,m"
"asterStr,positionStr)\n\n"
	  MaskIconFrame		  on
	  MaskIconOpaque	  on
	  MaskIconRotate	  "none"
	  MaskIconUnits		  "autoscale"
	  MaskValueString	  "0|1|EL1004v2|Vector Output|0|0"
	  MaskTabNameString	  ",,,,,"
	}
	Block {
	  BlockType		  "S-Function"
	  Name			  "DOUT_0"
	  Ports			  [1]
	  Position		  [180, 19, 260, 61]
	  BackgroundColor	  "yellow"
	  FunctionName		  "ec_slave2"
	  Parameters		  "Address,SlaveConfig,SdoConfig,IOSpec,debug,"
"tsample"
	  MaskType		  "EL20xx"
	  MaskDescription	  "Beckhoff EtherCAT Digital Output\nEL2002,4:"
"	24V 0.5A\nEL2032:		24V 2A, Optional Status (with Vector"
" Input)\n\nInput Type:\n  1-Byte input: one bit coded input\n  Vector input: "
"Input vector is <Channels> wide\n  Separate inputs: have <Channels> number of"
" inputs\n"
	  MaskHelp		  "This block implements the Beckhoff's EtherC"
"AT series of Digital Output Terminals.\n<p/>\nChoose or set the following opt"
"ions:\n<h4>Master:</h4>\nSet the EtherCAT Master number that this terminal is"
" connected to.\n\n<h4>Slave Index:</h4>\nSet the EtherCAT slave index. Follow"
"ing address formats are allowed:\n<ol>\n<li> Absolute addressing: a number <<"
"b><tt>n</tt></b>> representing the (zero based) absolute index. <b><tt>n</tt>"
"</b> is typically larger than 0 because the first coupler has that address.\n"
"\n<li> Field addressing: Has the form <<b><tt>f:n</tt></b>> where <b><tt>f</t"
"t></b> is the (zero based) EtherCAT coupler field and \n<b><tt>n</tt></b> is "
"the terminal offset in that field. Take note that <b><tt>n</tt></b> is also g"
"reater than 0.\n\n<li> SSId addressing: the Secondary Slave Addressing has th"
"e form <<b><tt>#s:n</tt></b>> where <b><tt>s</tt></b> is the Secondary Slave "
"Id of the EtherCAT coupler and <b><tt>n</tt></b> is the offset in that field."
" The SSId has to be preprogrammed into the coupler with other service tools."
"\n</ol>\n\n<h4> Device Model</h4>\nSelect the model that is used. This sets t"
"he maximum number of inputs of this block. Having fewer inputs is allowed.<br"
">\n Some models have an optional status byte. These have the <b>Status Output"
"</b> below enabled.\n\n<h4>Input Type</h4>\nThe input type can be one of the "
"following:\n<ul>\n<li><b>1-Byte Input</b>: This sets one block input bit code"
"d corresponding to the digital output of the terminal.\n<li><b>Vector Input</"
"b>: This sets one input vector where each element corresponds to a digital ou"
"tput of the terminal.\n<li><b>Separate Inputs</b>: This sets the number of bl"
"ock inputs corresponding to the digital output count of the terminal. \n</ul>"
"\n\n<h4>Status Output</h4>\nSome models have a status bit to monitor the atta"
"ched hardware. Check this box to make it available as a block output in simul"
"ink. This option is not available if <b>Separate Inputs</b> is selected.\n\n<"
"h4>Sample Time</h4>\nSelect the correct sample time. Setting this to 0 makes "
"for a sample time at the model's base rate. If another block can set the samp"
"le time, choose -1 for inherited sample time."
	  MaskPromptString	  "Master|Slave Index|Device Model |Input Type"
"|Sample Time (-1 for inherited)|Debug"
	  MaskStyleString	  "edit,edit,popup(EL2004v2|EL2008|EL2032v2|EL"
"2602|EL2612|EL2622|-- Obsolete|EL2004|EL2032),popup(Vector Input|Separate Inp"
"uts),edit,edit"
	  MaskTunableValueString  "off,off,off,off,off,off"
	  MaskCallbackString	  "|||||"
	  MaskEnableString	  "on,on,on,on,on,on"
	  MaskVisibilityString	  "on,on,on,on,on,off"
	  MaskToolTipString	  "on,on,on,on,on,on"
	  MaskVarAliasString	  ",,,,,"
	  MaskVariables		  "master=@1;index=@2;model=&3;input_type=&4;t"
"sample=@5;debug=@6;"
	  MaskInitialization	  "masterStr = '';\npositionStr = '';\n[Addres"
"s masterStr positionStr] = getEtherCATAddress(gcb,master,index);\n\nSdoConfig"
" = [];\n\n% Find the product code from the available models\nmodels = struct("
"...\n    'EL2004'  ,[hex2dec('07d43052')  hex2dec('00000000')], ...\n    'EL2"
"004v2',[hex2dec('07d43052')  hex2dec('00100000')], ...\n    'EL2008'  ,[hex2d"
"ec('07d83052')  hex2dec('00100000')], ...\n    'EL2032'  ,[hex2dec('07f03052'"
")  hex2dec('00000000')], ...\n    'EL2032v2',[hex2dec('07f03052')  hex2dec('0"
"0100000')], ...\n    'EL2602'  ,[hex2dec('0a2a3052')  hex2dec('00100000')], ."
"..\n    'EL2612'  ,[hex2dec('0a343052')  hex2dec('00100000')], ...\n    'EL26"
"22'  ,[hex2dec('0a3e3052')  hex2dec('00100000')]  ...\n    );\n\nif isfield(m"
"odels,model)\n    selection = models.(model);\nelse\n    errordlg([gcb ': Sla"
"ve model \"' model '\" is not implemented'])\nend\n\nLayoutVersion = 0;\n\ntr"
"y \n    load EtherCATInfo_el2xxx;\ncatch\n    errordlg([gcb ': Could not load"
" EtherCATInfo MAT file '...\n        'EtherCATInfo_el2xxx']);\n    % Regenera"
"te with: \n    %  EtherCATInfo_el2xxx = getEtherCATInfo('Beckhoff EL2xxx.xml'"
")\n    %  save EtherCATInfo_el2xxx 'EtherCATInfo_el2xxx'\nend\n\nIOSpec = [];"
"\n\ndevice = EtherCATInfo_el2xxx(selection(1),selection(2));\nif isempty(devi"
"ce)\n    errordlg(sprintf(...\n        ['%s: Could not find device with\\n'.."
".\n        'ProductCode \\t#x%08X\\n'...\n        'RevisionNo \\t#x%08X\\n'.."
".\n        'in file \"%s\".'],...\n        gcs, selection(1), selection(2), '"
"EtherCATInfo_el2xxx'));\nelse\n    SlaveConfig = genSlaveConfig(device);\n   "
" \n    if strcmp(input_type,'Vector Input')\n        % Only one output, with "
"all rows of pdo_map\n        PdoEntryMap = getEntries(device, 'GroupType', 'A"
"ll');\n        IOSpec.Port = cell2struct(PdoEntryMap,'PdoEntry',1);\n    else"
"if strcmp(input_type, 'Separate Inputs')\n        % Have (channel) number of "
"outputs, each containing one row of pdo_map\n        PdoEntryMap = getEntries"
"(device);\n        IOSpec.Port = cell2struct(PdoEntryMap,'PdoEntry',1);\n    "
"else\n        errordlg([gcb ': unknown input type: ' input_type]);\n    end\n"
"end\n"
	  MaskDisplay		  "fprintf('%s\\nM:%s Idx:%s',...\n    model,m"
"asterStr,positionStr)\n\n"
	  MaskIconFrame		  on
	  MaskIconOpaque	  on
	  MaskIconRotate	  "none"
	  MaskIconUnits		  "autoscale"
	  MaskValueString	  "0|1|EL2004v2|Vector Input|0|0"
	  MaskTabNameString	  ",,,,,"
	}
	Block {
	  BlockType		  "S-Function"
	  Name			  "Domain State"
	  Ports			  [0, 2]
	  Position		  [315, 81, 390, 114]
	  BackgroundColor	  "yellow"
	  FunctionName		  "domain_state"
	  Parameters		  "master,domain,input,output,tsample"
	  MaskType		  "Domain State"
	  MaskDescription	  "Displays the following domain state informa"
"tion:\n* Working Counter\n* Domain state:\n	0 - No slaves\n	1 -"
" Domain incomplete\n	2 - Domain complete"
	  MaskPromptString	  "Master|Domain|Direction|Sample Time"
	  MaskStyleString	  "edit,edit,popup(Input Only|Output Only|Inpu"
"t and Output),edit"
	  MaskTunableValueString  "off,off,off,off"
	  MaskCallbackString	  "|||"
	  MaskEnableString	  "on,on,on,on"
	  MaskVisibilityString	  "on,on,on,on"
	  MaskToolTipString	  "on,on,on,on"
	  MaskVarAliasString	  ",,,"
	  MaskVariables		  "master=@1;domain=@2;direction=@3;tsample=@4"
";"
	  MaskInitialization	  "switch direction\n    case 1\n        input"
" = 1;\n        output = 0;\n    case 2\n        input = 0;\n        output = "
"1;\n    case 3\n        input = 1;\n        output = 1;\nend"
	  MaskDisplay		  "fprintf('Domain State\\nM:%u d:%u',\nmaster"
",domain);"
	  MaskIconFrame		  on
	  MaskIconOpaque	  on
	  MaskIconRotate	  "none"
	  MaskIconUnits		  "autoscale"
	  MaskValueString	  "0|0|Input Only|0"
	  MaskTabNameString	  ",,,"
	}
	Block {
	  BlockType		  "S-Function"
	  Name			  "ENC_0"
	  Ports			  [0, 1]
	  Position		  [25, 198, 105, 242]
	  BackgroundColor	  "yellow"
	  FunctionName		  "ec_slave2"
	  Parameters		  "Address,SlaveConfig,SdoConfig,IOSpec,debug,"
"tsample"
	  MaskType		  "EL5101"
	  MaskDescription	  "Beckhoff EtherCAT Incremental Encoder Input"
	  MaskHelp		  "This block implements the EtherCAT Incremen"
"tal Encoder Input Terminal EL5101.\n\nThe first output is data, the second op"
"tional output is a Status Byte. Various options affect the behaviour of the t"
"erminal and the block's output:\n\n<h4>Master:</h4>\nSet the EtherCAT Master "
"of this terminal.\n\n<h4>Slave Index:</h4>\nSet the EtherCAT slave index. Fol"
"lowing address formats are allowed:\n<ol>\n<li> Absolute addressing: a string"
" '<b><tt>n</tt></b>' representing the (zero based) absolute index. <b><tt>n</"
"tt></b> is typically larger than 0 because the first coupler has that address"
".\n\n<li> SSId addressing: the Secondary Slave Addressing has the form '<b><t"
"t>#s:n</tt></b>' where <b><tt>s</tt></b> is the Secondary Slave Id of the Eth"
"erCAT coupler and <b><tt>n</tt></b> is the offset in that field. The SSId has"
" to be preprogrammed into the coupler with other service tools.\n</ol>\n\n<h4"
">Configuration Parameters</h4>\n<dl>\n<dt><b><tt>Enable Register Reload</tt><"
"/b></dt> \n<dd>When the counter value wraps (either overflows or underflows),"
" reload the value specified in <em>Counter Reload Value</em>. This option can"
"not be used together with <em>Enable Index Reset</em></dd>\n\n<dt><b><tt>Enab"
"le Index Reset</tt></b></dt> \n<dd>activates terminal input \"C\", which rese"
"ts the counter value. This option cannot be used together with <em>Enable Reg"
"ister Reload</em>.</dd>\n\n<dt><b><tt>Enable FWD Count</tt></b></dt> \n<dd>di"
"sables quadrature evaluation of the \"A\" and \"B\" terminal inputs. Counter "
"only counts up.</dd>\n\n<dt><b><tt>Gate</tt></b></dt> \n<dd>\nStops the count"
"er on either <b>Rising</b> or <b>Falling</b> edge. This input is enabled when"
" <em>Latch Output Port</en> is enabled.\n</dd>\n\n<dt><b><tt>Frequency Window"
"</tt></b></dt>\n<dd>Value determines the width of the Window variable in incr"
"ements of 16us (whatever that means???) This input is enabled when <em>Freque"
"ncy Output Port</em> is selected</dd>\n\n<dt><b><tt>Counter Reload Value</tt>"
"</b></dt>\n<dd>The value with which the counter is reloaded in case of <em>En"
"able Register Reload</em> is activated</dd>\n</dl>\n\n<h4>Inputs</h4>\nEnable"
" <tt><b>Control Input Port</b></tt> or <tt><b>Preset Input Port</b></tt>. Ref"
"er to the documentation for these rather complex inputs. The ordering of the "
"inputs matches the ordering in the configuration mask.\n\n<h4>Output Data Typ"
"e</h4>\nChoose the block's output data type for the output signal. Available "
"are:\n<ul>\n<li><b><tt>Raw</tt></b> outputting the internal raw value as <tt>"
"uint32_T</tt> as appropriate\n<li><b><tt>Double</tt></b> outputting 0..1 corr"
"esponding to the Full Scale. Full Scale is affected by the Frame Type, SSI Fr"
"ame Size and Data Length. Refer to manufactuer's documentation.\n</ul>\n\n<h4"
">Outputs</h4>\nSelect the desired outputs as presented int the configuratoin "
"mask. The ordering matches the ordering in the mask. Refer to manufacturors d"
"ocumentation.\n\n<p>\nSet the <b>Sample Time</b> for the block. <tt>0</tt> is"
" continuous sample time (runs at the model's base rate). Setting <tt>-1</tt> "
"will try to set the time using back propagation.\n"
	  MaskPromptString	  "Master|Slave Index|Enable Register Reload|E"
"nable Index Reset|Enable FWD Count|Gate|Frequency Window (0..65535)|Counter R"
"eload Value (0..65535)  |Control Input Port|Preset Input Port|Output Data Typ"
"e|Counter Value Output Port|Latch Output Port|Frequency Output Port|Period Ou"
"tput Port|Window Output Port|Status Output Port|Sample Time (-1 inherited)|De"
"bug"
	  MaskStyleString	  "edit,edit,checkbox,checkbox,checkbox,popup("
"None|Positive|Negative),edit,edit,checkbox,checkbox,popup(Raw bits|Double),ch"
"eckbox,checkbox,checkbox,checkbox,checkbox,checkbox,edit,edit"
	  MaskTunableValueString  "off,off,off,off,off,off,off,off,off,off,off"
",off,off,off,off,off,off,off,off"
	  MaskCallbackString	  "||el5101_check('Reload');|el5101_check('Ind"
"exReset');|||||||||el5101_check('Latch');|el5101_check('Freq');|||||"
	  MaskEnableString	  "on,on,on,on,on,off,off,off,on,on,on,on,on,o"
"n,on,on,on,on,on"
	  MaskVisibilityString	  "on,on,on,on,on,on,on,on,on,on,on,on,on,on,o"
"n,on,on,on,off"
	  MaskToolTipString	  "on,on,on,on,on,on,on,on,on,on,on,on,on,on,o"
"n,on,on,on,on"
	  MaskVarAliasString	  ",,,,,,,,,,,,,,,,,,"
	  MaskVariables		  "master=@1;index=@2;reload=@3;reset=@4;fwdco"
"unt=@5;gate=@6;freqwin=@7;reloadvalue=@8;control=@9;preset=@10;dtype=@11;valu"
"e=@12;latch=@13;freq=@14;period=@15;window=@16;status=@17;tsample=@18;debug=@"
"19;"
	  MaskInitialization	  "masterStr = '';\npositionStr = '';\n[Addres"
"s masterStr positionStr] = getEtherCATAddress(gcb,master,index);\n\nproduct_c"
"ode = hex2dec('13ed3052');\nrevision_no = hex2dec('00010000');\nLayoutVersion"
" = 0;\n\ntry \n    load EtherCATInfo_el5xxx\ncatch\n    errordlg([gcb ': Coul"
"d not load EtherCATInfo MAT file '...\n        'EtherCATInfo_el5xxx']);\n    "
"% Regenerate with: \n    %  EtherCATInfo_el5xxx = getEtherCATInfo('Beckhoff E"
"L5xxx.xml')\n    %  save EtherCATInfo_el5xxx 'EtherCATInfo_el5xxx'\nend\ndevi"
"ce = EtherCATInfo_el5xxx(product_code, revision_no);\n\n\n% PDO Entry is a de"
"finition of all PDO's that exist in the slave\n% List here a matrix, where ev"
"ery row has 3 elements:\n% 1: PDO index\n% 2: PDO subindex\n% 3: Bit size (8,"
"16,32); Negative values mean signed values\npdo_entry = struct(...\n    'stat"
"us' , [hex2dec('6000'), 1], ...\n    'value'  , [hex2dec('6000'), 2], ...\n  "
"  'latch'  , [hex2dec('6000'), 3], ...\n    'freq'   , [hex2dec('6000'), 4], "
"...\n    'period' , [hex2dec('6000'), 5], ...\n    'window' , [hex2dec('6000'"
"), 6], ...\n    'control', [hex2dec('7000'), 1], ...\n    'preset' , [hex2dec"
"('7000'), 2]);\n\n\n% SDO Config is the configuration of a slave\n% It is a m"
"atrix, every row having 4 elements:\n% 1: SDO Index\n% 2: SDO Subindex\n% 3: "
"Size    (8,16,32)\n% 4: value\nSdoConfig = [\n    hex2dec('8000'), 1,  8, rel"
"oadvalue == 1;... % Reload\n    hex2dec('8000'), 2,  8, reset == 1      ;... "
"% Index Reset\n    hex2dec('8000'), 3,  8, fwdcount == 1   ;... % Forward Cou"
"nt\n    hex2dec('8000'), 4,  8, gate == 2       ;... % Positive Gate\n    hex"
"2dec('8000'), 5,  8, gate == 3       ;... % Negative Gate\n    hex2dec('8001'"
"), 1, 16, freqwin         ;... % Frequency Window\n    hex2dec('8001'), 2, 16"
", reloadvalue     ;... % Reload Value\n    ];\nSdoConfig = cell2struct(...\n "
"   num2cell(SdoConfig),...\n    {'Index' 'SubIndex' 'BitLen' 'Value'}, 2);\n"
"\n% This maps ???\n% It is a matrix, every row having 4 elements:\n% 1: PDO d"
"irection as seen by the slave: 0 = output; 1 = Input\n% 2: PDO Index\n% 3: St"
"arting row of PDO entry (Zero based)\n% 4: Number of PDO entry rows\nIOSpec ="
" [];\nif ~isempty(device)\n    SlaveConfig = genSlaveConfig(device);\n    \n%"
"    IOSpec.Pdo.Exclude = [hex2dec('1A00') hex2dec('1600')];\n    \n    port ="
" 1;\n    if value\n        IOSpec.Port(port).PdoEntry = pdo_entry.value;\n   "
"     if dtype == 2\n            IOSpec.Port(port).PdoFullScale = 2^16;\n     "
"   end\n\n        port = port + 1;\n    end\n    if latch\n        IOSpec.Por"
"t(port).PdoEntry = pdo_entry.latch;\n        if dtype == 2\n            IOSpe"
"c.Port(port).PdoFullScale = 2^16;\n        end\n\n        port = port + 1;\n "
"   end\n    if freq\n        IOSpec.Port(port).PdoEntry = pdo_entry.freq;\n  "
"      if dtype == 2\n            IOSpec.Port(port).PdoFullScale = 2^32;\n    "
"    end\n\n        port = port + 1;\n    end\n    if period\n        IOSpec.P"
"ort(port).PdoEntry = pdo_entry.period;\n        if dtype == 2\n            IO"
"Spec.Port(port).PdoFullScale = 2^16;\n        end\n\n        port = port + 1;"
"\n    end\n    if window\n        IOSpec.Port(port).PdoEntry = pdo_entry.wind"
"ow;\n        if dtype == 2\n            IOSpec.Port(port).PdoFullScale = 2^16"
";\n        end\n\n        port = port + 1;\n    end\n    if status\n        I"
"OSpec.Port(port).PdoEntry = pdo_entry.status;\n\n        port = port + 1;\n  "
"  end\n\n    if control\n        IOSpec.Port(port).PdoEntry = pdo_entry.contr"
"ol;\n\n        port = port + 1;\n    end\n    if preset\n        IOSpec.Port("
"port).PdoEntry = pdo_entry.preset;\n        if dtype == 2\n            IOSpec"
"(port).PdoFullScale = 2^16;\n        end\n\n        port = port + 1;\n    end"
"\nend\n"
	  MaskDisplay		  "fprintf('EL5101\\nIncr.-Enc\\nM:%s Idx:%s',"
"...\n    masterStr, positionStr)\n"
	  MaskIconFrame		  on
	  MaskIconOpaque	  on
	  MaskIconRotate	  "none"
	  MaskIconUnits		  "autoscale"
	  MaskValueString	  "0|1|off|off|off|None|100|65535|off|off|Doub"
"le|on|off|off|off|off|off|0|0"
	  MaskTabNameString	  ",,,,,,,,,,,,,,,,,,"
	}
	Block {
	  BlockType		  "S-Function"
	  Name			  "Generic Slave"
	  Ports			  []
	  Position		  [170, 259, 250, 301]
	  BackgroundColor	  "yellow"
	  FunctionName		  "ec_slave2"
	  Parameters		  "Address,SlaveConfig,SdoConfig,IOSpec,debug,"
"tsample"
	  MaskType		  "Generic EtherCAT Slave"
	  MaskDescription	  "Implements a generic EtherCAT Slave as desc"
"ribed in the EtherCATInfo XML File"
	  MaskPromptString	  "Master|Slave Index|EtherCATInfo (filename o"
"r object)|Product Code|Revision (empty for latest)|Mapped PDO (empty for all)"
"|Group PDO Entries|SDO Config|Sample Time (-1 inherited)|Debug"
	  MaskStyleString	  "edit,edit,edit,edit,edit,edit,popup(No Grou"
"ping|Group Data Types in PDO|Group Data Types),edit,edit,edit"
	  MaskTunableValueString  "off,off,off,off,off,off,off,off,off,off"
	  MaskCallbackString	  "|||||||||"
	  MaskEnableString	  "on,on,on,on,on,on,on,on,on,on"
	  MaskVisibilityString	  "on,on,on,on,on,on,on,on,on,off"
	  MaskToolTipString	  "on,on,on,on,on,on,on,on,on,on"
	  MaskVarAliasString	  ",,,,,,,,,"
	  MaskVariables		  "master=@1;index=@2;ethercatinfo=@3;product_"
"code=@4;revision=@5;pdo_list=@6;group=&7;sdo_config=@8;tsample=@9;debug=@10;"
	  MaskInitialization	  "masterStr = '';\npositionStr = '';\nproduct"
"_name = 'Unknown';\n[Address masterStr positionStr] = getEtherCATAddress(gcb,"
"master,index);\n\n% Generate a LayoutVersion that is unique for every slave\n"
"% of this type to enure that a separate slave config is generated\n% for ever"
"y slave\nLayoutVersion = 0;\n\nif ~(isnumeric(product_code) && isnumeric(revi"
"sion) ...\n        && isnumeric(pdo_list))\n    fname = '';\n    errordlg([gc"
"b ':Value for Product Code, Revision Number '...\n        'Pdo List and Sdo C"
"onfig must be numeric']);\nend\n\nSdoConfig = [];\nif isempty(sdo_config)\n  "
"  SdoConfig = [];\nelseif isnumeric(sdo_config) && size(sdo_config,2) == 4\n "
"   SdoConfig = struct(...\n        'Index', sdo_config(:,1), ...\n        'Su"
"bIndex', sdo_config(:,2), ...\n        'BitLen', sdo_config(:,3),...\n       "
" 'Value', sdo_config(:,4));\nelseif isstruct(sdo_config)\n    SdoConfig = sdo"
"_config;\nelse\n    errordlg([gcb ':Value Sdo Config must be a numeric M-by-4"
" '...\n        'matrix [Index SubIndex BitLen Value] '...\n        'or a stru"
"cture vector with the fields '...\n        '''Index'', ''SubIndex'', ''BitLen"
"'' and ''Value''']);\nend\n\nif isa(ethercatinfo, class(EtherCATInfo))\n    e"
"i = ethercatinfo;\nelseif isa(ethercatinfo,'char')\n    ei = EtherCATInfo;\n "
"   \n    if length(ethercatinfo)\n        try\n            ei = EtherCATInfo("
"ethercatinfo);\n        catch\n        end\n\n        if isempty(ei)\n       "
"     try\n                load(ethercatinfo);\n                eval(['ei = ' "
"ethercatinfo ';']);\n            catch\n            end\n        end\n\n     "
"   if isempty(ei)\n            warndlg([gcb ':File ''' ethercatinfo ''' not f"
"ound']);\n        end\n    end\nelse\n    errordlg([gcb ':File name for Ether"
"CAT Info not a valid string']);\nend\n\n\nIOSpec = [];\nSlaveConfig = [];\n\n"
"if ~isempty(ei)\n    if ~isempty(product_code) && product_code(1)\n        de"
"v = ei(product_code, revision);\n        if isempty(dev)\n            errordl"
"g([gcb ': Product with specified Product Code '...\n                'and Revi"
"sion Number does not exist']);\n        end\n    else\n        dev = ei{1};\n"
"    end\n    \n    SlaveConfig = genSlaveConfig(dev);\n\n    switch lower(gro"
"up)\n        case 'group data types in pdo'\n            type = 'PDO';\n     "
"   case 'group data types'\n            type = 'ALL';\n        otherwise\n   "
"         type = 'None';\n    end\n    \n    PdoEntries = getEntries(dev,'Grou"
"pType',type);\n    if ~isempty(SlaveConfig)\n        product_name = SlaveConf"
"ig.Descriptions.Devices.Device.Type.TextContent;\n    end\n    IOSpec.Port = "
"struct('PdoEntry', PdoEntries);\nend\n"
	  MaskDisplay		  "fprintf('%s\\nM:%s Idx:%s',...\n    product"
"_name,masterStr,positionStr);\n"
	  MaskSelfModifiable	  on
	  MaskIconFrame		  on
	  MaskIconOpaque	  on
	  MaskIconRotate	  "none"
	  MaskIconUnits		  "autoscale"
	  MaskValueString	  "0|1|''|hex2dec('0')|[]|[]|Group Data Types "
"in PDO|[]|0|0"
	  MaskTabNameString	  ",,,,,,,,,"
	}
	Block {
	  BlockType		  "S-Function"
	  Name			  "Infrastructure"
	  Ports			  []
	  Position		  [315, 140, 405, 180]
	  BackgroundColor	  "yellow"
	  FunctionName		  "ec_slave2"
	  Parameters		  "Address,SlaveConfig,SdoConfig,output,debug,"
"tsample"
	  MaskType		  "Infrastructure Block"
	  MaskDescription	  "EtherCAT Infrastructure Slaves. \n\nThe fol"
"lowing slaves are available:\nEK1100	EtherCAT Coupler\nEK1110	E"
"therCAT Extension\nEK1122	2-Port EtherCAT Junction\nEL9110	24V "
"w. Diag.\nEL9160	230V w. Diag.\nEL9210	24V w. Fuse & Diag.\nEL9"
"260	230V w. Fuse & Diag.\n\nIncluding these slaves (even if they don't"
" have outputs)\nin the bus configuration will cause them to go into the\noper"
"ational mode\n"
	  MaskPromptString	  "Master|Slave Index|Device Model |Sample Tim"
"e (-1 inherited)|Debug"
	  MaskStyleString	  "edit,edit,popup(EK1100|EK1110|EK1122|EL9110"
"|EL9160|EL9210|EL9260),edit,edit"
	  MaskTunableValueString  "off,off,off,off,off"
	  MaskCallbackString	  "||||"
	  MaskEnableString	  "on,on,on,on,on"
	  MaskVisibilityString	  "on,on,on,on,off"
	  MaskToolTipString	  "on,on,on,on,on"
	  MaskVarAliasString	  ",,,,"
	  MaskVariables		  "master=@1;index=@2;model=&3;tsample=@4;debu"
"g=@5;"
	  MaskInitialization	  "masterStr = '';\npositionStr = '';\n[Addres"
"s masterStr positionStr] = getEtherCATAddress(gcb,master,index);\n\nSdoConfig"
" = [];\nfunc = 'Unknown';\n\n% Find the product code from the available model"
"s\nmodels = struct( ...\n    'EK1100', {{hex2dec('044c2c52') hex2dec('0000000"
"0') 'EtherCAT Coupler'    }}, ...\n    'EK1110', {{hex2dec('04562c52') hex2de"
"c('00000000') 'EtherCAT Extension'  }}, ...\n    'EL9110', {{hex2dec('2396305"
"2') hex2dec('00100000') '24V w. Diag.'        }}, ...\n    'EL9160', {{hex2de"
"c('23c83052') hex2dec('00100000') '230V w. Diag.'       }}, ...\n    'EL9210'"
", {{hex2dec('23fa3052') hex2dec('00100000') '24V w. Fuse & Diag.' }}, ...\n  "
"  'EL9260', {{hex2dec('242c3052') hex2dec('00100000') '230V w. Fuse & Diag.'}"
"}, ...\n    'EK1122', {{hex2dec('04622c52') hex2dec('00100000') '2-Port Ether"
"cat Junction'}} ...\n    );\n\nif isfield(models,model)\n    selection = mode"
"ls.(model);\n    func = selection{3};\nelse\n    errordlg([gcb ': Slave model"
" \"' model '\" is not implemented'])\nend\n\ntry\n    switch model(1:2)\n    "
"    case 'EK'\n            EtherCATInfoFile = 'EtherCATInfo_ekxxxx';\n       "
"     load(EtherCATInfoFile);\n            ei = EtherCATInfo_ekxxxx;\n        "
"case 'EL'\n            EtherCATInfoFile = 'EtherCATInfo_el9xxx';\n           "
" load(EtherCATInfoFile);\n            ei = EtherCATInfo_el9xxx;\n    end\ncat"
"ch\n    errordlg([gcb ': Could not load EtherCATInfo MAT file ' EtherCATInfoF"
"ile]);\nend\nLayoutVersion = 0;\n\noutput = [];\ndev = ei(selection{1}, selec"
"tion{2});\nSlaveConfig = genSlaveConfig(dev);\nif ~isempty(dev)\n    PdoEntri"
"es = getEntries(dev);\n    output.Port = struct('PdoEntry',PdoEntries);\nend "
"       \n        "
	  MaskDisplay		  "fprintf('%s\\n%s\\nM:%s Idx:%s',...\n    mo"
"del,func,masterStr,positionStr)\n\n"
	  MaskIconFrame		  on
	  MaskIconOpaque	  on
	  MaskIconRotate	  "none"
	  MaskIconUnits		  "autoscale"
	  MaskValueString	  "0|0|EK1100|0|0"
	  MaskTabNameString	  ",,,,"
	}
	Block {
	  BlockType		  "S-Function"
	  Name			  "K-Bus"
	  Ports			  []
	  Position		  [25, 258, 105, 322]
	  BackgroundColor	  "yellow"
	  FunctionName		  "ec_slave2"
	  Parameters		  "Address,SlaveConfig,SdoConfig,IOSpec,debug,"
"tsample"
	  MaskType		  "K-Bus Coupler"
	  MaskDescription	  "Beckhoff EK1110 K-Bus to EtherCAT Coupler\n"
"\nGroup Pdo Entries:\n  * Data Types in PDO: This option groups all Pdo Entri"
"es in a \n	PDO with the same data type together\n  * All Data Types: A"
"ll Pdo Entries with the same data typ\n	are grouped together.\n"
	  MaskHelp		  "This block provides an interface to the K-B"
"us process image for the EK1120 Coupler.\n<p>\nChoose and set the following o"
"ptions:\n<h4>Master:</h4>\nSet the EtherCAT Master of this terminal.\n\n<h4>S"
"lave Index:</h4>\nSet the EtherCAT slave index. Following address formats are"
" allowed:\n<ol>\n<li> Absolute addressing: a string '<b><tt>n</tt></b>' repre"
"senting the (zero based) absolute index. <b><tt>n</tt></b> is typically large"
"r than 0 because the first coupler has that address.\n\n<li> SSId addressing:"
" the Secondary Slave Addressing has the form '<b><tt>#s:n</tt></b>' where <b>"
"<tt>s</tt></b> is the Secondary Slave Id of the EtherCAT coupler and <b><tt>n"
"</tt></b> is the offset in that field. The SSId has to be preprogrammed into "
"the coupler with other service tools.\n</ol>\n\n<h4>EtherCATInfo XML File:</h"
"4>\nA string path pointing to the XML description of the k-Bus Coupler\n\n<h4"
">Sample Time:</h4>\nSet the <b>Sample Time</b> for the block. <tt>0</tt> is c"
"ontinuous sample time (runs at the model's base rate). Setting <tt>-1</tt> wi"
"ll try to set the time using back propagation.\n\n"
	  MaskPromptString	  "Master|Slave Index|EtherCATInfo XML file|Gr"
"oup Pdo Entries|Sample Time (-1 inherited)|Debug"
	  MaskStyleString	  "edit,edit,edit,popup(No Grouping|Group Data"
" Types in PDO|Group Data Types),edit,edit"
	  MaskTunableValueString  "off,off,off,off,off,off"
	  MaskCallbackString	  "|||||"
	  MaskEnableString	  "on,on,on,on,on,on"
	  MaskVisibilityString	  "on,on,on,on,on,off"
	  MaskToolTipString	  "on,on,on,on,on,on"
	  MaskVarAliasString	  ",,,,,"
	  MaskVariables		  "master=@1;index=@2;ethercatinfo=@3;group=&4"
";tsample=@5;debug=@6;"
	  MaskInitialization	  "masterStr = '';\npositionStr = '';\ndisplay"
"_name = '';\n[Address masterStr positionStr] = getEtherCATAddress(gcb,master,"
"index);\n\nSdoConfig = [];\n\n% Generate a LayoutVersion that is unique for e"
"very slave\n% of this type to enure that a separate slave config is generated"
"\n% for every slave\nLayoutVersion = Address.Domain * 2^16 + Address.Position"
";\n\nfname = '';\n\ntry\n    fname = char(ethercatinfo);\ncatch\n    errordlg"
"([gcb ':File name for EtherCAT Info not a valid string']);\nend\n    \nIOSpec"
" = [];\nSlaveConfig = [];\n\nif isempty(fname)\n    IOSpec = [];\n    SlaveCo"
"nfig = [];\nelseif isempty(dir(fname))\n    warndlg([gcb ':File ''' fname '''"
" not found']);\nelse\n    switch lower(group)\n        case 'group data types"
" in pdo'\n            type = 'PDO';\n        case 'group data types'\n       "
"     type = 'ALL';\n        otherwise\n            type = 'None';\n    end\n "
"   \n    ei = EtherCATInfo(fname);\n    SlaveConfig = genSlaveConfig(ei{1});"
"\n    PdoEntries = getEntries(ei{1},'GroupType',type);\n    IOSpec.Port = str"
"uct('PdoEntry', PdoEntries);\n%     IOSpec.Pdo.SmAssignment = [6911 3];\n%   "
"  IOSpec.Pdo.Selection = [6911];\n%     IOSpec.Pdo.Variant = 4;\n    IOSpec.P"
"do.Unique = 1;\n\n    [p f e] = fileparts(fname);\n    display_name = [f e];"
"\nend"
	  MaskDisplay		  "fprintf('BK1120\\nK-Bus Coupler\\n%s\\nM:%s"
" Idx:%s',...\n    display_name,masterStr,positionStr);\n"
	  MaskIconFrame		  on
	  MaskIconOpaque	  on
	  MaskIconRotate	  "none"
	  MaskIconUnits		  "autoscale"
	  MaskValueString	  "0|1|''|Group Data Types in PDO|0|0"
	  MaskTabNameString	  ",,,,,"
	}
	Block {
	  BlockType		  "S-Function"
	  Name			  "MSD_0"
	  Ports			  [2, 2]
	  Position		  [325, 217, 460, 288]
	  BackgroundColor	  "yellow"
	  FunctionName		  "moog_msd"
	  Parameters		  "master,index,tsample,iomode"
	  MaskType		  "Moog MSC"
	  MaskDescription	  "Moog Servodrive Controller"
	  MaskPromptString	  "Master|Slave Index|Sample Time|Input/Output"
" Mode"
	  MaskStyleString	  "edit,edit,edit,popup(Inputs and Outputs|Inp"
"uts only|Outputs only)"
	  MaskTunableValueString  "off,off,off,off"
	  MaskCallbackString	  "|||moog_msd_callback('display_callback',gcb"
")"
	  MaskEnableString	  "on,on,on,on"
	  MaskVisibilityString	  "on,on,on,on"
	  MaskToolTipString	  "on,on,on,on"
	  MaskVarAliasString	  ",,,"
	  MaskVariables		  "master=@1;index=&2;tsample=@3;iomode=@4;"
	  MaskInitialization	  "moog_msd_callback('display_callback',gcb)"
	  MaskDisplay		  "fprintf('Moog Servo Drive\\nM:%i Idx:%s', m"
"aster, index) image(imread('moog.png'), [.3, .7, .4, .2]) port_label('input',"
" 1, 'control') port_label('input', 2, 'v_tgt') port_label('output', 1, 'statu"
"s') port_label('output', 2, 'v_cur')"
	  MaskSelfModifiable	  on
	  MaskIconFrame		  on
	  MaskIconOpaque	  on
	  MaskIconRotate	  "none"
	  MaskIconUnits		  "normalized"
	  MaskValueString	  "0|0|0|Inputs and Outputs"
	  MaskTabNameString	  ",,,"
	}
	Block {
	  BlockType		  "S-Function"
	  Name			  "MTS_0"
	  Ports			  [0, 3]
	  Position		  [170, 365, 250, 405]
	  BackgroundColor	  "yellow"
	  FunctionName		  "ec_slave2"
	  Parameters		  "Address,SlaveConfig,SdoConfig,IOSpec,0,tsam"
"ple"
	  MaskType		  "MTS R-Series"
	  MaskDescription	  "MTS R-Series Position Senor\n\nOutput 1: po"
"sition vector (magnets 1-5) in meter\nOptional output 2: speed vector (magnet"
"s 1-5) in m/s\nOptional output 3: status vector (magnets 1-5)"
	  MaskHelp		  "This block generically implements the MTS R"
"-Series Position Sensor for various models.\n<p/>\nThe following Terminals ar"
"e supported:\n<center>\n<table width=\"80%\">\n<tr><td>1 Magnet</td><td> </td"
"></tr>\n<tr><td>2 Magnets</td><td> </td></tr>\n<tr><td>3 Magnets</td><td> </t"
"d></tr>\n<tr><td>4 Magnets</td><td> </td></tr>\n<tr><td>5 Magnets</td><td> </"
"td></tr>\n</table>\n</center>\n<p/>\nChoose and set the following options:\n<"
"h4>Master:</h4>\nSet the EtherCAT Master of this terminal.\n\n<h4>Slave Index"
":</h4>\nSet the EtherCAT slave index. Following address formats are allowed:"
"\n<ol>\n<li> Absolute addressing: a number <<b><tt>n</tt></b>> representing t"
"he (zero based) absolute index. <b><tt>n</tt></b> is typically larger than 0 "
"because the first coupler has that address.\n\n<li> Field addressing: Has the"
" form <<b><tt>f:n</tt></b>> where <b><tt>f</tt></b> is the (zero based) Ether"
"CAT coupler field and \n<b><tt>n</tt></b> is the terminal offset in that fiel"
"d. Take note that <b><tt>n</tt></b> is also greater than 0.\n\n<li> SSId addr"
"essing: the Secondary Slave Addressing has the form <<b><tt>#s:n</tt></b>> wh"
"ere <b><tt>s</tt></b> is the Secondary Slave Id of the EtherCAT coupler and <"
"b><tt>n</tt></b> is the offset in that field. The SSId has to be preprogramme"
"d into the coupler with other service tools.\n</ol>\n\n<h4>Device Model:</h4>"
"\nChoose the model at the Indexed position of the master.\n\n<h4>Output Type:"
"</h4>\n<ul>\n<li>Choose <b>Vector Output</b> to have a single output as a vec"
"tor\nwith a size corresponding to the channel count of the terminal. This mod"
"e also allows a status output port to be displayed. <br/>\n<li>Choose <b>Sepa"
"rate Outputs</b> to have one output for every channel.\n</ul>\n<h4>Output Ful"
"l Scale</h4>\nWhen <b>Output Data Type</b> is set to <b>Double with scale and"
" offset</b>, the block's output value at full scale terminal input can be set"
" here.\n\n<h4>Output Offset</h4>\nWhen <b>Output Data Type</b> is set to <b>D"
"ouble with scale and offset</b>, the blocks output at zero terminal input can"
" be set here. Note that the Full Scale above is also increased by this amount"
". Note furthermore that this corresponds to the minimum input for terminals s"
"uch as 4..20mA.\n\n<h4>Output Data Type</h4>\nChoose the block's output data "
"type for the output signal. Available are:\n<ul>\n<li><b><tt>Raw</tt></b> out"
"putting the internal raw value as <tt>int16_T</tt> or <tt>uint16_T</tt> as ap"
"propriate\n<li><b><tt>Double</tt></b> outputting 0..10, -10..10, 0..0.02 and "
"0.004..0.02 depending on the Model as appropriate\n<li><b><tt>Double with sca"
"le and offset</tt></b>, allowing the output to be scaled with an offset.\n</u"
"l>\n\n<p>\nChoosing <b>Status Output</b> provides a port of type <tt>uint8_T<"
"/tt> where the status is presented. This is only enabled when <b>Vector Outpu"
"t</b> is selected. Terminal input over- and underrange can be detected using "
"this output. See the terminal's documentation.\n\n<h4>Output Filter</h4>\nWhe"
"n not in <b>Raw</b> mode, the <b>Output Filter</b> checkbox becomes available"
", allowing the use of an internal low pass filter. Enter the <b>LPF Time Cons"
"tant</b> for the filter in the field below.\n<br>For continuous sample time s"
"ystems (0 in Sample Time), the filter is also continuous. Discrete samples sy"
"stems (Sample Time > 0) uses an equivalent discrete low pass filter with a si"
"milar time constant.\n\n<p>\nSet the <b>Sample Time</b> for the block. <tt>0<"
"/tt> is continuous sample time (runs at the model's base rate). Setting <tt>-"
"1</tt> will try to set the time using back propagation.\n"
	  MaskPromptString	  "Master|Slave Index|Device Model |Sensorleng"
"th in m|Output Offset|Revert Position|Velicity Output|Status Output|Output Fi"
"lter|LPF Time Constant (sec)|Sample Time"
	  MaskStyleString	  "edit,edit,popup(1 Magnet|2 Magnets|3 Magnet"
"s|4 Magnets|5 Magnets),edit,edit,checkbox,checkbox,checkbox,checkbox,edit,edi"
"t"
	  MaskTunableValueString  "off,off,off,off,off,off,off,off,off,off,off"
	  MaskCallbackString	  "||||||||mtsrseries_check('filter');||"
	  MaskEnableString	  "on,on,on,on,on,on,on,on,on,off,on"
	  MaskVisibilityString	  "on,on,on,on,on,on,on,on,on,on,on"
	  MaskToolTipString	  "on,on,on,on,on,on,on,on,on,on,on"
	  MaskVarAliasString	  ",,,,,,,,,,"
	  MaskVariables		  "master=@1;index=@2;model=&3;sensorlen=@4;of"
"fset=@5;do_revert=@6;velocity_output=@7;status=@8;filter=@9;tau=@10;tsample=@"
"11;"
	  MaskInitialization	  "\nmasterStr = '';\npositionStr = '';\n[Addr"
"ess masterStr positionStr] = getEtherCATAddress(gcb,master,index);\n\n\n% Fin"
"d the product code from the available models\nproduct_id = hex2dec('26483052'"
");\nversion_id = hex2dec('03020101');\nlabe_id = 'MTS Temposonics';\n\n\nfunc"
" = model;\n\nEtherCATInfoFile = 'EtherCATInfo_mts';\ntry \n    load(EtherCATI"
"nfoFile);\ncatch\n    errordlg([gcb ': Could not load EtherCATInfo MAT file '"
"...\n        'EtherCATInfo_mts']);\n    % Regenerate with: \n    %  EtherCATI"
"nfo_el3xxx = getEtherCATInfo('Beckhoff EL3xxx.xml')\n    %  save EtherCATInfo"
"_el3xxx 'EtherCATInfo_el3xxx'\nend\n\n\nIOSpec = [];\nSdoConfig = []; \n\ndev"
"ice = EtherCATInfo_mts(product_id,version_id);\nif isempty(device)\n    error"
"dlg(sprintf(...\n        ['%s: Could not find device with\\n'...\n        'Pr"
"oductCode \\t#x%08X\\n'...\n        'RevisionNo \\t#x%08X\\n'...\n        'in"
" file %s.'],...\n        gcs, product_id, version_id, EtherCATInfoFile));\nel"
"se\n    SlaveConfig = genSlaveConfig(device);\n\n    % SDO Config is the conf"
"iguration of a slave\n    % It is a matrix, every row having 4 elements:\n   "
" % 1: SDO Index\n    % 2: SDO Subindex\n    % 3: Size    (8,16,32)\n    % 4: "
"value\n    SdoConfig = [...\n       SdoConfig;...\n       hex2dec('200A'), he"
"x2dec('0'),  32, do_revert; ... % Revert Measuring Direction\n      ];\n\n\n "
"   IOSpec.Pdo.Unique=1;\n \n    anz_magnets=str2num(model(1));\n    pdo_entry"
"_pos=[];\n    pdo_entry_vel=[];\n    pdo_entry_status=[];\n    zaehler=1;\n  "
"  for j=1:anz_magnets\n        pdo_entry_pos=[pdo_entry_pos;hex2dec('3101') ("
"zaehler+1)];\n        pdo_entry_vel=[pdo_entry_vel;hex2dec('3101') (zaehler+2"
")];\n        pdo_entry_status=[pdo_entry_status;hex2dec('3101') (zaehler)];\n"
"        zaehler=zaehler+4;\n    end\n    % Position, Velocity, Status Vector "
"output\n    IOSpec.Port(1).PdoEntry = pdo_entry_pos;\n    if velocity_output "
"== 1\n       IOSpec.Port(2).PdoEntry = pdo_entry_vel;\n    end\n    if status"
" == 1\n       IOSpec.Port(3).PdoEntry = pdo_entry_status;\n    end\n\n    if "
"sensorlen == 0\n         sensorlen = 1;\n     end\n     IOSpec.Port(1).PdoFul"
"lScale = sensorlen*1000000;\n     if velocity_output == 1\n         IOSpec.Po"
"rt(2).PdoFullScale = 2^31;   \n     end   \n     IOSpec.Port(1).Gain = sensor"
"len;\n     IOSpec.Port(1).Offset = offset;\n     %IOSpec.Port(1).GainName = '"
"FullScalePosition';\n     IOSpec.Port(1).OffsetName = 'OffsetPosition';\n    "
" IOSpec.Port(2).Gain = 1000;\n     IOSpec.Port(2).Offset = 0;\n     %IOSpec.P"
"ort(2).GainName = 'FullScaleSpeed';\n     %IOSpec.Port(2).OffsetName = 'Offse"
"tSpeed';\n      \n     if filter\n         if sum(tau == 0)\n             err"
"ordlg([gcb ': Specify a nonzero time constant '...\n             'for the out"
"put filter.']);\n         end\n         if (tsample)\n             IOSpec.Por"
"t(1).Filter = tsample./tau;\n             IOSpec.Port(1).FilterName = 'InputW"
"eight';\n         else\n             IOSpec.Port(1).Filter = 2*pi./tau;\n    "
"         IOSpec.Port(1).FilterName = 'Omega';\n         end\n     end\n    \n"
"    SdoConfig = cell2struct(...\n    num2cell(SdoConfig),...\n    {'Index' 'S"
"ubIndex' 'BitLen' 'Value'}, 2);\nend\n"
	  MaskDisplay		  "fprintf(...\n    'MTS R-Series\\n%s\\n%s Id"
"x:%s',...\n    model,...\n    masterStr,...\n    positionStr\n)\n"
	  MaskIconFrame		  on
	  MaskIconOpaque	  on
	  MaskIconRotate	  "none"
	  MaskIconUnits		  "autoscale"
	  MaskValueString	  "0|1|1 Magnet|0|0|off|on|on|off|0.1|0"
	  MaskTabNameString	  ",,,,,,,,,,"
	}
	Block {
	  BlockType		  "S-Function"
	  Name			  "Master State"
	  Ports			  [0, 3]
	  Position		  [315, 29, 390, 61]
	  BackgroundColor	  "yellow"
	  FunctionName		  "master_state"
	  Parameters		  "master,tsample"
	  MaskType		  "Master State"
	  MaskDescription	  "Outputs master state:\n* number of respondi"
"ng slaves\n* Slave states\n* Link up\n"
	  MaskPromptString	  "Master|Sample Time"
	  MaskStyleString	  "edit,edit"
	  MaskTunableValueString  "off,off"
	  MaskCallbackString	  "|"
	  MaskEnableString	  "on,on"
	  MaskVisibilityString	  "on,on"
	  MaskToolTipString	  "on,on"
	  MaskVarAliasString	  ","
	  MaskVariables		  "master=@1;tsample=@2;"
	  MaskDisplay		  "fprintf('Master State\\nM: %u',\nmaster);"
	  MaskIconFrame		  on
	  MaskIconOpaque	  on
	  MaskIconRotate	  "none"
	  MaskIconUnits		  "autoscale"
	  MaskValueString	  "0|0"
	  MaskTabNameString	  ","
	}
	Block {
	  BlockType		  "S-Function"
	  Name			  "RTD_0"
	  Ports			  [0, 1]
	  Position		  [30, 359, 125, 401]
	  BackgroundColor	  "yellow"
	  FunctionName		  "ec_slave2"
	  Parameters		  "Address,SlaveConfig,SdoConfig,IOSpec,0,tsam"
"ple"
	  MaskType		  "EL320x"
	  MaskDescription	  "Beckhoff 1, 2, 4-Channel Pt100 (RTD) Input "
"Terminal\n\nOutput Type:\n  Vector output: Output vector is <Channels> wide\n"
	  MaskHelp		  "This block generically implements the Ether"
"CAT 16-Bit Pt100 (RTD) Input Terminal for various models.\n<p/>\nThe followin"
"g Terminals are supported:\n<center>\n<table width=\"80%\">\n<tr><td>EL3201,2"
",4</td><td>Pt100, NiCr Input</td></tr>\n</table>\n</center>\n<p/>\nChoose and"
" set the following options:\n<h4>Master:</h4>\nSet the EtherCAT Master of thi"
"s terminal.\n\n<h4>Slave Index:</h4>\nSet the EtherCAT slave index. Following"
" address formats are allowed:\n<ol>\n<li> Absolute addressing: a number <<b><"
"tt>n</tt></b>> representing the (zero based) absolute index. <b><tt>n</tt></b"
"> is typically larger than 0 because the first coupler has that address.\n\n<"
"li> Field addressing: Has the form <<b><tt>f:n</tt></b>> where <b><tt>f</tt><"
"/b> is the (zero based) EtherCAT coupler field and \n<b><tt>n</tt></b> is the"
" terminal offset in that field. Take note that <b><tt>n</tt></b> is also grea"
"ter than 0.\n\n<li> SSId addressing: the Secondary Slave Addressing has the f"
"orm <<b><tt>#s:n</tt></b>> where <b><tt>s</tt></b> is the Secondary Slave Id "
"of the EtherCAT coupler and <b><tt>n</tt></b> is the offset in that field. Th"
"e SSId has to be preprogrammed into the coupler with other service tools.\n</"
"ol>\n\n<h4>Device Model:</h4>\nChoose the model at the Indexed position of th"
"e master.\n\n<h4>RTD-Element:</h4>\nChoose the type of the connected RTD-elem"
"ent for each channel.\n\n<h4>Connection Type:</h4>\nChoose the type of the co"
"nnection type for each channel.\n\n<h4>Enable Filter:</h4>\nEnables the devic"
"e internal filter and sets the filter frequency to 50 Hz.\n\n<p>\nSet the <b>"
"Sample Time</b> for the block. <tt>0</tt> is continuous sample time (runs at "
"the model's base rate). Setting <tt>-1</tt> will try to set the time using ba"
"ck propagation.\n"
	  MaskPromptString	  "Master|Slave Index|Device Model | RTD-Eleme"
"nt Channel 1|Connection Type Channel 1|RTD-Element Channel 2|Connection Type "
"Channel 2|RTD-Element Channel 3|Connection Type Channel 3|RTD-Element Channel"
" 4|Connection Type Channel 4|Enable Filter|Enable Status Output|Sample Time"
	  MaskStyleString	  "edit,edit,popup(EL3201|EL3202|EL3204),popup"
"(Pt100|Ni100|Pt1000|Pt500|Pt200|Ni1000 (-60-250C)|Ni1000 (-30-160C)|Ni120|1"
"/16 Ohm|1/64 Ohm),popup(2-wire|3-wire|4-wire|not connected),popup(Pt100|Ni100"
"|Pt1000|Pt500|Pt200|Ni1000 (-60-250C)|Ni1000 (-30-160C)|Ni120|1/16 Ohm|1/64"
" Ohm),popup(2-wire|3-wire|not connected),popup(Pt100|Ni100|Pt1000|Pt500|Pt200"
"|Ni1000 (-60-250C)|Ni1000 (-30-160C)|Ni120|1/16 Ohm|1/64 Ohm),popup(2-wire|"
"not connected),popup(Pt100|Ni100|Pt1000|Pt500|Pt200|Ni1000 (-60-250C)|Ni1000"
" (-30-160C)|Ni120|1/16 Ohm|1/64 Ohm),popup(2-wire|not connected),checkbox,ch"
"eckbox,edit"
	  MaskTunableValueString  "off,off,off,off,off,off,off,off,off,off,off"
",off,off,off"
	  MaskCallbackString	  "||el320x_check('model');||el320x_check('mod"
"el');\n||el320x_check('model');\n||el320x_check('model');\n||el320x_check('mo"
"del');\n|||"
	  MaskEnableString	  "on,on,on,on,on,on,on,off,off,off,off,on,on,"
"on"
	  MaskVisibilityString	  "on,on,on,on,on,on,on,on,on,on,on,on,on,on"
	  MaskToolTipString	  "on,on,on,on,on,on,on,on,on,on,on,on,on,on"
	  MaskVarAliasString	  ",,,,,,,,,,,,,"
	  MaskVariables		  "master=@1;index=@2;model=&3;rtd_element_1=@"
"4;connection_type_1=@5;rtd_element_2=@6;connection_type_2=@7;rtd_element_3=@8"
";connection_type_3=@9;rtd_element_4=@10;connection_type_4=@11;enable_filter=@"
"12;enable_status=@13;tsample=@14;"
	  MaskInitialization	  "masterStr = '';\npositionStr = '';\n[Addres"
"s masterStr positionStr] = getEtherCATAddress(gcb,master,index);\nSdoConfig ="
" [];\n\n% Find the product code from the available models\nmodels = struct( ."
"..\n    'EL3201' ,{{hex2dec('0C813052') hex2dec('100000') '1 Port RTD' 1}}, ."
"..\n    'EL3202' ,{{hex2dec('0C823052') hex2dec('100000') '2-Port RTD' 2}}, ."
"..\n    'EL3204' ,{{hex2dec('0C843052') hex2dec('100000') '4-Port RTD' 4}} .."
".\n    );\n\nif isfield(models,model)\n    selection = models.(model);\nelse"
"\n    errordlg([gcb ': Slave model \"' model '\" is not implemented'])\nend\n"
"\nfunc = selection{3};\n\nEtherCATInfoFile = 'EtherCATInfo_el3xxx';\ntry \n  "
"  load(EtherCATInfoFile);\ncatch\n    errordlg([gcb ': Could not load EtherCA"
"TInfo MAT file '...\n        'EtherCATInfo_el3xxx']);\n    % Regenerate with:"
" \n    %  EtherCATInfo_el3xxx = getEtherCATInfo('Beckhoff EL3xxx.xml')\n    %"
"  save EtherCATInfo_el3xxx 'EtherCATInfo_el3xxx'\nend\n\n\nIOSpec = [];\nSdoC"
"onfig = []; \n\ndevice = EtherCATInfo_el3xxx(selection{1},selection{2});\nif "
"isempty(device)\n    errordlg(sprintf(...\n        ['%s: Could not find devic"
"e with\\n'...\n        'ProductCode \\t#x%08X\\n'...\n        'RevisionNo \\t"
"#x%08X\\n'...\n        'in file %s.'],...\n        gcs, selection{1}, selecti"
"on{2}, EtherCATInfoFile));\nelse\n    SlaveConfig = genSlaveConfig(device);\n"
"\n\n    % SDO Config is the configuration of a slave\n    % It is a matrix, e"
"very row having 4 elements:\n    % 1: SDO Index\n    % 2: SDO Subindex\n    %"
" 3: Size    (8,16,32)\n    % 4: value\n    if enable_filter == 1\n        Sdo"
"Config = [...\n            SdoConfig;...\n            hex2dec('8000'), hex2de"
"c('6'),  8, enable_filter;... % Enable Filter for all Channels\n            h"
"ex2dec('8000'), hex2dec('15'),  16, 0;...           % Default Filter Freq=50H"
"z\n         ];\n    end; \n\n    %Get Connection Type Index\n    connect_1=co"
"nnection_type_1-1;     \n    switch connection_type_2\n        case 1\n      "
"      connect_2=0;\n        case 2\n            connect_2=1;\n        case 3"
"\n            connect_2=3;\n    end;\n    switch connection_type_3\n        c"
"ase 1\n            connect_3=0;\n        case 2\n            connect_3=3;\n  "
"  end;\n    switch connection_type_4\n        case 1\n            connect_4=0"
";\n        case 2\n            connect_4=3;\n    end;\n\n\n    %Configuration"
" of the RTD-Element and the connection type and general settings\n    SdoConf"
"ig = [...\n        SdoConfig;...\n            hex2dec('8000'), hex2dec('19'),"
"  16, (rtd_element_1-1);... % RTD-Element Channel 1\n            hex2dec('800"
"0'), hex2dec('1A'),  16, connect_1;... % Connection Type Channel 1\n         "
"   hex2dec('8000'), hex2dec('1'),  8, 0;... % Disable user scaling Channel 1"
"\n            hex2dec('8000'), hex2dec('2'),  8, 0;... % Value as signed int "
"16 Channel 1\n            hex2dec('8000'), hex2dec('7'),  8, 0;... % Disable "
"Limit 1 Channel 1\n            hex2dec('8000'), hex2dec('8'),  8, 0;... % Dis"
"able Limit 2 Channel 1\n            hex2dec('8000'), hex2dec('A'),  8, 0;... "
"% Disable user callibration Channel 1\n            hex2dec('8000'), hex2dec('"
"B'),  8, 1;... % Enable vendor callibration Channel 1\n        ];\n\n    if ~"
"strcmp(model,'EL3201')\n         SdoConfig = [...\n             SdoConfig; .."
".\n            hex2dec('8010'), hex2dec('19'),  16, (rtd_element_2-1);... % R"
"TD-Element Channel 2\n            hex2dec('8010'), hex2dec('1A'),  16, connec"
"t_2;... % Connection Type Channel 2\n            hex2dec('8010'), hex2dec('1'"
"),  8, 0;... % Disable user scaling Channel 2\n            hex2dec('8010'), h"
"ex2dec('2'),  8, 0;... % Value as signed int 16 Channel 2\n            hex2de"
"c('8010'), hex2dec('7'),  8, 0;... % Disable Limit 1 Channel 2\n            h"
"ex2dec('8010'), hex2dec('8'),  8, 0;... % Disable Limit 2 Channel 2\n        "
"    hex2dec('8010'), hex2dec('A'),  8, 0;... % Disable user callibration Chan"
"nel 2\n            hex2dec('8010'), hex2dec('B'),  8, 1;... % Enable vendor c"
"allibration Channel 2\n        ];\n    end;  \n\n    if strcmp(model,'EL3204'"
")\n        SdoConfig = [...\n            SdoConfig; ...\n            hex2dec("
"'8020'), hex2dec('19'),  16, (rtd_element_3-1);... % RTD-Element Channel 3\n "
"           hex2dec('8020'), hex2dec('1A'),  16, connect_3;... % Connection Ty"
"pe Channel 3\n            hex2dec('8020'), hex2dec('1'),  8, 0;... % Disable "
"user scaling Channel 3\n            hex2dec('8020'), hex2dec('2'),  8, 0;... "
"% Value as signed int 16 Channel 3\n            hex2dec('8020'), hex2dec('7')"
",  8, 0;... % Disable Limit 1 Channel 3\n            hex2dec('8020'), hex2dec"
"('8'),  8, 0;... % Disable Limit 2 Channel 3\n            hex2dec('8020'), he"
"x2dec('A'),  8, 0;... % Disable user callibration Channel 3\n            hex2"
"dec('8020'), hex2dec('B'),  8, 1;... % Enable vendor callibration Channel 3\n"
"            hex2dec('8030'), hex2dec('19'),  16, (rtd_element_4-1);... % RTD-"
"Element Channel 4\n            hex2dec('8030'), hex2dec('1A'),  16, connect_4"
";... % Connection Type Channel 4\n            hex2dec('8030'), hex2dec('1'), "
" 8, 0;... % Disable user scaling Channel 4\n            hex2dec('8030'), hex2"
"dec('2'),  8, 0;... % Value as signed int 16 Channel 4\n            hex2dec('"
"8030'), hex2dec('7'),  8, 0;... % Disable Limit 1 Channel 4\n            hex2"
"dec('8030'), hex2dec('8'),  8, 0;... % Disable Limit 2 Channel 4\n           "
" hex2dec('8030'), hex2dec('A'),  8, 0;... % Disable user callibration Channel"
" 4\n            hex2dec('8030'), hex2dec('B'),  8, 1;... % Enable vendor call"
"ibration Channel 4\n         ];\n    end; \n    \n\n    pdo_entry = [ ...\n  "
"    hex2dec('6000'), hex2dec('7');...  % Status Channel 1\n      hex2dec('600"
"0'), hex2dec('11');... % Value Channel 1\n      hex2dec('6010'), hex2dec('7')"
";...  % Status Channel 2\n      hex2dec('6010'), hex2dec('11');... % Value Ch"
"annel 2\n      hex2dec('6020'), hex2dec('7');...  % Status Channel 3\n      h"
"ex2dec('6020'), hex2dec('11');... % Value Channel 3\n      hex2dec('6030'), h"
"ex2dec('7');...  % Status Channel 4\n      hex2dec('6030'), hex2dec('11');..."
" % Value Channel 4\n    ];\n\n    IOSpec.Pdo.Unique=1;\n    pdo_entry_temp=[]"
";\n    gain_entry=[];\n    offset_entry=[];  \n    pdo_entry_status=[];\n    "
"for j=1:selection{4}\n        pdo_entry_temp=[pdo_entry_temp; pdo_entry(2*j,:"
")];\n        gain_entry=[gain_entry 100.0];\n        offset_entry=[offset_ent"
"ry 0.0];\n        pdo_entry_status=[pdo_entry_status;pdo_entry((2*j)-1,:)];\n"
"    end\n\n    IOSpec.Port(1).PdoEntry =  pdo_entry_temp;\n    IOSpec.Port(1)"
".PdoFullScale = 1000;\n    IOSpec.Port(1).Gain = gain_entry;\n    IOSpec.Port"
"(1).Offset = offset_entry;\n    IOSpec.Port(1).GainName = 'FullScale';\n    I"
"OSpec.Port(1).OffsetName = 'Offset';\n    if enable_status == 1\n        IOSp"
"ec.Port(2).PdoEntry =  pdo_entry_status;\n    end;\n               \n    SdoC"
"onfig = cell2struct(...\n    num2cell(SdoConfig),...\n    {'Index' 'SubIndex'"
" 'BitLen' 'Value'}, 2);\nend\n"
	  MaskDisplay		  "fprintf(...\n    '%s\\n%s In\\n%s Idx:%s',."
"..\n    model,...\n    func,...\n    masterStr,...\n    positionStr\n)\n"
	  MaskIconFrame		  on
	  MaskIconOpaque	  on
	  MaskIconRotate	  "none"
	  MaskIconUnits		  "autoscale"
	  MaskValueString	  "0|1|EL3202|Pt100|2-wire|Pt100|2-wire|Pt100|"
"2-wire|Pt100|not connected|off|off|0"
	  MaskTabNameString	  ",,,,,,,,,,,,,"
	}
	Block {
	  BlockType		  "S-Function"
	  Name			  "SSI_0"
	  Ports			  [0, 1]
	  Position		  [25, 140, 105, 180]
	  BackgroundColor	  "yellow"
	  FunctionName		  "ec_slave2"
	  Parameters		  "Address,SlaveConfig,SdoConfig,output,debug,"
"tsample"
	  MaskType		  "EL5001"
	  MaskDescription	  "Beckhoff EtherCAT SSI Input"
	  MaskHelp		  "This block implements the EtherCAT SSI Inpu"
"t Terminal EL5001.\n\nThe first output is data, the second optional output is"
" a Status Byte. Various options affect the behaviour of the terminal and the "
"block's output:\n\n<h4>Master:</h4>\nSet the EtherCAT Master of this terminal"
".\n\n<h4>Slave Index:</h4>\nSet the EtherCAT slave index. Following address f"
"ormats are allowed:\n<ol>\n<li> Absolute addressing: a number <<b><tt>n</tt><"
"/b>> representing the (zero based) absolute index. <b><tt>n</tt></b> is typic"
"ally larger than 0 because the first coupler has that address.\n\n<li> SSId a"
"ddressing: the Secondary Slave Addressing has the form <<b><tt>#s:n</tt></b>>"
" where <b><tt>s</tt></b> is the Secondary Slave Id of the EtherCAT coupler an"
"d <b><tt>n</tt></b> is the offset in that field. The SSId has to be preprogra"
"mmed into the coupler with other service tools.\n</ol>\n\n<h4>Output Full Sca"
"le</h4>\nWhen <b>Output Data Type</b> is set to <b>Double with scale and offs"
"et</b>, the block's output value at full scale terminal input can be set here"
". This value  directly affects the output despite a possible output LPF filte"
"r.\n\n<h4>Output Offset</h4>\nWhen <b>Output Data Type</b> is set to <b>Doubl"
"e with scale and offset</b>, the blocks output at zero terminal input can be "
"set here. Note that the Full Scale above is also increased by this amount. Th"
"is value  directly affects the output despite a possible output LPF filter.\n"
"\n<h4>Output Data Type</h4>\nChoose the block's output data type for the outp"
"ut signal. Available are:\n<ul>\n<li><b><tt>Raw</tt></b> outputting the inter"
"nal raw value as <tt>uint32_T</tt> as appropriate\n<li><b><tt>Double</tt></b>"
" outputting 0..1 corresponding to the Full Scale. Full Scale is affected by t"
"he Frame Type, SSI Frame Size and Data Length. Refer to manufactuer's documen"
"tation.\n<li><b><tt>Double with scale and offset</tt></b>, allowing the outpu"
"t to be scaled with an offset.\n</ul>\n\n<p>\nFor <b>SSI Code</b>, <b>Baudrat"
"e</b>, <b>Frame Type</b>, <b>SSI Frame Size</b>, <b>Data Length</b>, <b>Disab"
"le Frame Error</b>, <b>Enable Inhibit Time</b> and <b>Min Inhibit Time</b>, r"
"efer to manufacturer's documentation.\n<p> \nChoosing <b>Status Output</b> pr"
"ovides a port of type <tt>uint8_T</tt> where the status is presented. Refer t"
"o manufacturors documentation for the used coding.\n\n<h4>Output Filter</h4>"
"\nWhen not in <b>Raw</b> mode, the <b>Output Filter</b> checkbox becomes avai"
"lable, allowing the use of an internal low pass filter. Enter the <b>LPF Time"
" Constant</b> for the filter in the field below.\n<br>For continuous sample t"
"ime systems (0 in Sample Time), the filter is also continuous. Discrete sampl"
"es systems (Sample Time > 0) uses an equivalent discrete low pass filter with"
" a similar time constant.\n\n<p>\nSet the <b>Sample Time</b> for the block. <"
"tt>0</tt> is continuous sample time (runs at the model's base rate). Setting "
"<tt>-1</tt> will try to set the time using back propagation.\n"
	  MaskPromptString	  "Master|Slave Index|Revision|Output Full Sca"
"le|Output Offset|Output Data Type|SSI Code |Baudrate |Frame Type |SSI Frame S"
"ize |Data Length |Disable Frame Error|Enable Inhibit Time|Min Inhibit Time [u"
"s] (1..65535)|Status Output|Output Filter|LPF Time Constant (sec)|Sample Time"
"|Debug"
	  MaskStyleString	  "edit,edit,popup(Rev 0001|Rev 0000),edit,edi"
"t,popup(Raw bits|Double|Double with scale and offset),popup(Binary|Gray),popu"
"p(1250k|1000k|500k|250k|125k),popup(Multiturn (25 bits)|Singleturn (13 bits)|"
"Variable (set size in Frame Size)),popup(1|2|3|4|5|6|7|8|9|10|11|12|13|14|15|"
"16|17|18|19|20|21|22|23|24|25|26|27|28|29|30|31|32),popup(1|2|3|4|5|6|7|8|9|1"
"0|11|12|13|14|15|16|17|18|19|20|21|22|23|24|25|26|27|28|29|30|31|32),checkbox"
",checkbox,edit,checkbox,checkbox,edit,edit,edit"
	  MaskTunableValueString  "off,off,off,off,off,off,off,off,off,off,off"
",off,off,off,off,off,off,off,off"
	  MaskCallbackString	  "|||||el5001_check('dtype');|||el5001_check("
"'frame');||||el5001_check('inhibit');|el5001_check('inh_time');||el5001_check"
"('filter');|||"
	  MaskEnableString	  "on,on,on,off,off,on,on,on,on,off,on,on,on,o"
"ff,on,on,off,on,on"
	  MaskVisibilityString	  "on,on,on,on,on,on,on,on,on,on,on,on,on,on,o"
"n,on,on,on,off"
	  MaskToolTipString	  "on,on,on,on,on,on,on,on,on,on,on,on,on,on,o"
"n,on,on,on,on"
	  MaskVarAliasString	  ",,,,,,,,,,,,,,,,,,"
	  MaskVariables		  "master=@1;index=@2;revision=&3;scale=@4;off"
"set=@5;dtype=@6;code=@7;baud=@8;frame=@9;fsize=@10;length=@11;frame_error=@12"
";inhibit=@13;inh_time=@14;status=@15;filter=@16;tau=@17;tsample=@18;debug=@19"
";"
	  MaskInitialization	  "masterStr = '';\npositionStr = '';\n[Addres"
"s masterStr positionStr] = getEtherCATAddress(gcb,master,index);\n\nproduct_c"
"ode = hex2dec('13893052');\nrevisions = {...\n    'Rev 0001', hex2dec('000100"
"00'); ...\n    'Rev 0000', hex2dec('00000000')};\n\nidx = strcmpi({revisions{"
":,1}}, revision);\n\nif isempty(find(idx))\n    errordlg([gcb ': Revision \"'"
" revision '\" is not implemented'])\nelse\n    revision_no = revisions{idx,2}"
";\nend\n\ntry \n    load EtherCATInfo_el5xxx\ncatch\n    errordlg([gcb ': Cou"
"ld not load EtherCATInfo MAT file '...\n        'EtherCATInfo_el5xxx']);\n   "
" % Regenerate with: \n    %  EtherCATInfo_el5xxx = getEtherCATInfo('Beckhoff "
"EL5xxx.xml')\n    %  save EtherCATInfo_el5xxx 'EtherCATInfo_el5xxx'\nend\n\nL"
"ayoutVersion = 0;\nSdoConfig = [\n    hex2dec('4061'), 1,  8, frame_error    "
" ;... % FrameError\n    hex2dec('4061'), 2,  8, 1               ;... % Power "
"Fail\n    hex2dec('4061'), 3,  8, inhibit         ;... % Enable Inhibit\n    "
"hex2dec('4066'), 0,  8, code == 2       ;... % SSI Code\n    hex2dec('4067'),"
" 0, 16, baud            ;... % Baud Rate\n    hex2dec('4068'), 0,  8, frame-1"
"         ;... % Frame Type\n    hex2dec('4069'), 0, 16, fsize           ;... "
"% Frame Size\n    hex2dec('406A'), 0, 16, length          ;... % Data Length"
"\n    hex2dec('406B'), 0, 16, inh_time        ;... % Inhibit Time\n    ];\nSd"
"oConfig = cell2struct(...\n    num2cell(SdoConfig),...\n    {'Index' 'SubInde"
"x' 'BitLen' 'Value'}, 2);\n\ndevice = EtherCATInfo_el5xxx(product_code, revis"
"ion_no);\n\noutput = [];\n\nif isempty(device)\n    errordlg(sprintf(...\n   "
"     ['%s: Could not find device with\\n'...\n        'ProductCode \\t#x%08X"
"\\n'...\n        'RevisionNo \\t#x%08X\\n'...\n        'in file EtherCATInfo_"
"el5xxx.'],...\n        gcs, product_code, revision_no));\nelse\n    SlaveConf"
"ig = genSlaveConfig(device);\n\n    PdoEntryMap = getEntries(device, 'GroupTy"
"pe', 'None');\n    \n    output.Port.PdoEntry = PdoEntryMap{2};\n    \n    if"
" dtype ~= 1\n        output.Port.PdoFullScale = 2^32;\n        if dtype == 3"
"\n            output.Port.Gain = scale;\n            output.Port.Offset = off"
"set;\n            output.Port.GainName = 'FullScale';\n            output.Por"
"t.OffsetName = 'Offset';\n        end\n        if filter\n            if sum("
"tau == 0)\n                errordlg([gcb ': Specify a nonzero time constant '"
"...\n                    'for the output filter.']);\n            end\n      "
"      if (tsample)\n                output.Port.Filter = tsample/tau;\n      "
"          output.Port.FilterName = 'InputWeight';\n            else\n        "
"        output.Port.Filter = 2*pi/tau;\n                output.Port.FilterNam"
"e = 'Omega';\n            end\n        end\n    end\n\n    if status\n       "
" output.Port(2).PdoEntry = PdoEntryMap{1};\n    end\nend\n\n"
	  MaskDisplay		  "fprintf('EL5001\\nSSI Input\\nM:%s Idx:%s',"
"...\n    masterStr,positionStr)\n\n"
	  MaskIconFrame		  on
	  MaskIconOpaque	  on
	  MaskIconRotate	  "none"
	  MaskIconUnits		  "autoscale"
	  MaskValueString	  "0|1|Rev 0001|1|0|Double|Binary|1250k|Multit"
"urn (25 bits)|25|24|off|off|1|off|off|0.1|0|0"
	  MaskTabNameString	  ",,,,,,,,,,,,,,,,,,"
	}
      }
    }
    Block {
      BlockType		      SubSystem
      Name		      "Generate Code"
      Ports		      []
      Position		      [106, 15, 209, 55]
      BackgroundColor	      "lightBlue"
      ShowName		      off
      OpenFcn		      "model=bdroot;     \ntry               \n  rtwbu"
"ild(model);\ncatch             \n  error(lasterr); \nend               \n    "
"              "
      FontName		      "Arial"
      FontSize		      12
      FontWeight	      "bold"
      MinAlgLoopOccurrences   off
      RTWSystemCode	      "Auto"
      FunctionWithSeparateData off
      MaskHideContents	      off
      MaskDisplay	      "disp(['Generate Code\\n',...\n	  '(doubl"
"e-click)'])"
      MaskIconFrame	      on
      MaskIconOpaque	      on
      MaskIconRotate	      "none"
      MaskIconUnits	      "autoscale"
      System {
	Name			"Generate Code"
	Location		[1035, 233, 1395, 566]
	Open			off
	ModelBrowserVisibility	off
	ModelBrowserWidth	200
	ScreenColor		"white"
	PaperOrientation	"landscape"
	PaperPositionMode	"auto"
	PaperType		"usletter"
	PaperUnits		"inches"
	TiledPaperMargins	[0.500000, 0.500000, 0.500000, 0.500000]
	TiledPageScale		1
	ShowPageBoundaries	off
	ZoomFactor		"100"
      }
    }
    Block {
      BlockType		      "S-Function"
      Name		      "World Time"
      Ports		      [0, 1]
      Position		      [435, 49, 505, 81]
      BackgroundColor	      "yellow"
      FunctionName	      "world_time"
      Parameters	      "tsample"
      MaskType		      "World Time"
      MaskDescription	      "Outputs the current world time for the sample t"
"ime."
      MaskHelp		      "This block outputs the hosts current real world"
" time in seconds since 1.1.1970"
      MaskPromptString	      "Sample Time"
      MaskStyleString	      "edit"
      MaskTunableValueString  "off"
      MaskEnableString	      "on"
      MaskVisibilityString    "on"
      MaskToolTipString	      "on"
      MaskVariables	      "tsample=@1;"
      MaskIconFrame	      on
      MaskIconOpaque	      on
      MaskIconRotate	      "none"
      MaskIconUnits	      "autoscale"
      MaskValueString	      "0"
    }
  }
}
