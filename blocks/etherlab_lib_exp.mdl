Library {
  Name			  "etherlab_lib_exp"
  Version		  6.4
  MdlSubVersion		  0
  SavedCharacterEncoding  "ISO-8859-1"
  LibraryType		  "BlockLibrary"
  SaveDefaultBlockParams  on
  SampleTimeColors	  off
  LibraryLinkDisplay	  "all"
  WideLines		  off
  ShowLineDimensions	  off
  ShowPortDataTypes	  off
  ShowLoopsOnError	  on
  IgnoreBidirectionalLines off
  ShowStorageClass	  off
  ShowTestPointIcons	  on
  ShowViewerIcons	  on
  SortedOrder		  off
  ExecutionContextIcon	  off
  ShowLinearizationAnnotations on
  ScopeRefreshTime	  0.035000
  OverrideScopeRefreshTime on
  DisableAllScopes	  off
  BlockNameDataTip	  off
  BlockParametersDataTip  off
  BlockDescriptionStringDataTip	off
  ToolBar		  on
  StatusBar		  on
  BrowserShowLibraryLinks off
  BrowserLookUnderMasks	  off
  Created		  "Tue Dec 27 14:12:39 2005"
  Creator		  "rich"
  UpdateHistory		  "UpdateHistoryNever"
  ModifiedByFormat	  "%<Auto>"
  LastModifiedBy	  "rich"
  ModifiedDateFormat	  "%<Auto>"
  LastModifiedDate	  "Thu May 29 23:54:48 2008"
  ModelVersionFormat	  "1.%<AutoIncrement:432>"
  ConfigurationManager	  "rcs"
  LinearizationMsg	  "none"
  Profile		  off
  ParamWorkspaceSource	  "MATLABWorkspace"
  CovSaveName		  "covdata"
  CovMetricSettings	  "dw"
  CovNameIncrementing	  off
  CovHtmlReporting	  on
  covSaveCumulativeToWorkspaceVar on
  CovSaveSingleToWorkspaceVar on
  CovCumulativeReport	  off
  CovReportOnPause	  on
  ExtModeBatchMode	  off
  ExtModeEnableFloating	  on
  ExtModeTrigType	  "manual"
  ExtModeTrigMode	  "normal"
  ExtModeTrigPort	  "1"
  ExtModeTrigElement	  "any"
  ExtModeTrigDuration	  1000
  ExtModeTrigDurationFloating "auto"
  ExtModeTrigHoldOff	  0
  ExtModeTrigDelay	  0
  ExtModeTrigDirection	  "rising"
  ExtModeTrigLevel	  0
  ExtModeArchiveMode	  "off"
  ExtModeAutoIncOneShot	  off
  ExtModeIncDirWhenArm	  off
  ExtModeAddSuffixToVar	  off
  ExtModeWriteAllDataToWs off
  ExtModeArmWhenConnect	  on
  ExtModeSkipDownloadWhenConnect off
  ExtModeLogAll		  on
  ExtModeAutoUpdateStatusClock off
  ProdHWDeviceType	  "32-bit Generic"
  ShowModelReferenceBlockVersion off
  ShowModelReferenceBlockIO off
  BlockDefaults {
    Orientation		    "right"
    ForegroundColor	    "black"
    BackgroundColor	    "white"
    DropShadow		    off
    NamePlacement	    "normal"
    FontName		    "Bitstream Charter"
    FontSize		    10
    FontWeight		    "normal"
    FontAngle		    "normal"
    ShowName		    on
  }
  BlockParameterDefaults {
    Block {
      BlockType		      Inport
      Port		      "1"
      UseBusObject	      off
      BusObject		      "BusObject"
      BusOutputAsStruct	      off
      PortDimensions	      "-1"
      SampleTime	      "-1"
      DataType		      "auto"
      OutDataType	      "sfix(16)"
      OutScaling	      "2^0"
      SignalType	      "auto"
      SamplingMode	      "auto"
      LatchByDelayingOutsideSignal off
      LatchByCopyingInsideSignal off
      Interpolate	      on
    }
    Block {
      BlockType		      "S-Function"
      FunctionName	      "system"
      SFunctionModules	      "''"
      PortCounts	      "[]"
    }
    Block {
      BlockType		      SubSystem
      ShowPortLabels	      on
      Permissions	      "ReadWrite"
      PermitHierarchicalResolution "All"
      TreatAsAtomicUnit	      off
      SystemSampleTime	      "-1"
      RTWFcnNameOpts	      "Auto"
      RTWFileNameOpts	      "Auto"
      RTWMemSecFuncInitTerm   "Inherit from model"
      RTWMemSecFuncExecute    "Inherit from model"
      RTWMemSecDataConstants  "Inherit from model"
      RTWMemSecDataInternal   "Inherit from model"
      RTWMemSecDataParameters "Inherit from model"
      SimViewingDevice	      off
      DataTypeOverride	      "UseLocalSettings"
      MinMaxOverflowLogging   "UseLocalSettings"
    }
    Block {
      BlockType		      TriggerPort
      TriggerType	      "rising"
      StatesWhenEnabling      "inherit"
      ShowOutputPort	      off
      OutputDataType	      "auto"
      SampleTimeType	      "triggered"
      SampleTime	      "1"
      ZeroCross		      on
    }
  }
  AnnotationDefaults {
    HorizontalAlignment	    "center"
    VerticalAlignment	    "middle"
    ForegroundColor	    "black"
    BackgroundColor	    "white"
    DropShadow		    off
    FontName		    "Bitstream Charter"
    FontSize		    10
    FontWeight		    "normal"
    FontAngle		    "normal"
  }
  LineDefaults {
    FontName		    "Bitstream Charter"
    FontSize		    9
    FontWeight		    "normal"
    FontAngle		    "normal"
  }
  System {
    Name		    "etherlab_lib_exp"
    Location		    [800, 601, 1395, 994]
    Open		    on
    ModelBrowserVisibility  off
    ModelBrowserWidth	    200
    ScreenColor		    "white"
    PaperOrientation	    "landscape"
    PaperPositionMode	    "auto"
    PaperType		    "usletter"
    PaperUnits		    "inches"
    TiledPaperMargins	    [0.500000, 0.500000, 0.500000, 0.500000]
    TiledPageScale	    1
    ShowPageBoundaries	    off
    ZoomFactor		    "100"
    ReportName		    "simulink-default.rpt"
    Block {
      BlockType		      SubSystem
      Name		      "AddiData"
      Ports		      []
      Position		      [295, 134, 366, 195]
      MinAlgLoopOccurrences   off
      RTWSystemCode	      "Auto"
      FunctionWithSeparateData off
      MaskHideContents	      off
      System {
	Name			"AddiData"
	Location		[1047, 745, 1395, 994]
	Open			off
	ModelBrowserVisibility	off
	ModelBrowserWidth	200
	ScreenColor		"white"
	PaperOrientation	"landscape"
	PaperPositionMode	"auto"
	PaperType		"A4"
	PaperUnits		"centimeters"
	TiledPaperMargins	[0.500000, 0.500000, 0.500000, 0.500000]
	TiledPageScale		1
	ShowPageBoundaries	off
	ZoomFactor		"100"
	Block {
	  BlockType		  "S-Function"
	  Name			  "1710_Chronos"
	  Ports			  [0, 1]
	  Position		  [30, 29, 100, 61]
	  BackgroundColor	  "yellow"
	  FunctionName		  "ad1710_chronos"
	  Parameters		  "b_BoardHandle,b_ModuleNumber,b_ChronoMode,b"
"_PCIInputClock,b_TimeUnit,ul_TimeOut,b_TimeoutUnit"
	  MaskPromptString	  "Board Handle|Module Number|Chrono Mode|PCI "
"Input Clock|Time Unit|Timeout|Timeout Unit"
	  MaskStyleString	  "edit,popup(0|1|2|3),popup(0|1|2|3|4|5|6|7),"
"popup(30MHz|33MHz|40MHz),popup(Nanoseconds|Microseconds|Milliseconds|Seconds|"
"Minutes),edit,popup(Nanoseconds|Micoseconds|Milliseconds|Seconds|Minutes)"
	  MaskTunableValueString  "off,off,off,off,off,off,off"
	  MaskCallbackString	  "||||||"
	  MaskEnableString	  "on,on,on,on,on,on,on"
	  MaskVisibilityString	  "on,on,on,on,on,on,on"
	  MaskToolTipString	  "on,on,on,on,on,on,on"
	  MaskVarAliasString	  ",,,,,,"
	  MaskVariables		  "b_BoardHandle=@1;b_ModuleNumber=@2;b_Chrono"
"Mode=@3;b_PCIInputClock=@4;b_TimeUnit=@5;ul_TimeOut=@6;b_TimeoutUnit=@7;"
	  MaskDisplay		  "fprintf('1710 Chrono\\nB:%i M/d:%i',\nb_Boa"
"rdHandle,b_ModuleNumber);"
	  MaskIconFrame		  on
	  MaskIconOpaque	  on
	  MaskIconRotate	  "none"
	  MaskIconUnits		  "autoscale"
	  MaskValueString	  "0|0|0|30MHz|Microseconds|0|Micoseconds"
	  MaskTabNameString	  ",,,,,,"
	}
	Block {
	  BlockType		  "S-Function"
	  Name			  "1710_ETM"
	  Ports			  [0, 3]
	  Position		  [170, 150, 250, 190]
	  BackgroundColor	  "yellow"
	  FunctionName		  "xPCI1710_etm"
	  Parameters		  "device,module,clock_src,divisor,op_type,tsa"
"mple"
	  MaskType		  "Addi Data 1710 ETM"
	  MaskDescription	  "This block implements the Edge Triggered Ti"
"mer Mode for the 1710 Addi Data timer card. \n"
	  MaskPromptString	  "PCI Device|Module Number|Clock Source|Clock"
" Divisor|Output Data Type |Output Full Scale|Output Offset|Sampling Time (-1 "
"inherited)"
	  MaskStyleString	  "edit,popup(0|1|2|3),popup(Internal 40MHz|PC"
"I Bus 33/30Mhz),edit,popup(double|single|int8|uint8|int16|uint16|int32|uint32"
"|boolean|Inherited via back propagation),edit,edit,edit"
	  MaskTunableValueString  "off,off,off,off,off,on,on,off"
	  MaskCallbackString	  "|||||||"
	  MaskEnableString	  "on,on,on,on,on,on,on,on"
	  MaskVisibilityString	  "on,on,on,on,on,on,on,on"
	  MaskToolTipString	  "on,on,on,on,on,on,on,on"
	  MaskVarAliasString	  ",,,,,,,"
	  MaskVariables		  "device=&1;module=@2;clock_src=@3;divisor=@4"
";op_type=@5;scale=@6;offset=@7;tsample=@8;"
	  MaskInitialization	  "device = test_var(device);"
	  MaskDisplay		  "fprintf('xPCI1710 ETM\\nPCI: %s\\nModule: %"
"i',\ndevice,module-1);"
	  MaskIconFrame		  on
	  MaskIconOpaque	  on
	  MaskIconRotate	  "none"
	  MaskIconUnits		  "autoscale"
	  MaskValueString	  "01:0A|0|Internal 40MHz|1|double|0|0|0"
	  MaskTabNameString	  ",,,,,,,"
	}
	Block {
	  BlockType		  "S-Function"
	  Name			  "1710_INC"
	  Ports			  [0, 1]
	  Position		  [35, 160, 115, 200]
	  BackgroundColor	  "yellow"
	  FunctionName		  "xPCI1710_inc"
	  Parameters		  "device,module,mode,width,op_type,preset,tsa"
"mple"
	  MaskType		  "Addi Data 1710 INC"
	  MaskDescription	  "This block implements the Incremental Count"
"er Mode for the 1710 Addi Data timer card. \n"
	  MaskPromptString	  "PCI Device|Module Number|Mode |Counter Widt"
"h |Output Data Type |Preset Input|Sampling Time (-1 inherited)"
	  MaskStyleString	  "edit,popup(0|1|2|3),popup(Quadruple|Double|"
"Simple|Direct),popup(32-Bit|16-Bit),popup(double|single|int8|uint8|int16|uint"
"16|int32|uint32|boolean|Inherited via back propagation),checkbox,edit"
	  MaskTunableValueString  "off,off,off,off,off,off,off"
	  MaskCallbackString	  "||||||"
	  MaskEnableString	  "on,on,on,on,on,on,on"
	  MaskVisibilityString	  "on,on,on,on,on,on,on"
	  MaskToolTipString	  "on,on,on,on,on,on,on"
	  MaskVarAliasString	  ",,,,,,"
	  MaskVariables		  "device=&1;module=@2;mode=@3;width=@4;op_typ"
"e=@5;preset=@6;tsample=@7;"
	  MaskInitialization	  "device = test_var(device);"
	  MaskDisplay		  "fprintf('xPCI1710 INC\\nPCI: %s\\nModule: %"
"i',\ndevice,module-1);"
	  MaskIconFrame		  on
	  MaskIconOpaque	  on
	  MaskIconRotate	  "none"
	  MaskIconUnits		  "autoscale"
	  MaskValueString	  "03:0E|0|Quadruple|32-Bit|double|off|0"
	  MaskTabNameString	  ",,,,,,"
	}
	Block {
	  BlockType		  "S-Function"
	  Name			  "old1710_ETM"
	  Ports			  [0, 1]
	  Position		  [30, 99, 100, 131]
	  BackgroundColor	  "yellow"
	  FunctionName		  "ad1710_etm"
	  Parameters		  "b_BoardHandle,b_ModuleNumber,b_ClockSelecti"
"on,b_TimingUnit,ul_Timing"
	  MaskType		  "Addi Data 1710 ETM"
	  MaskDescription	  "This block implements the Edge Triggered Mo"
"de for the 1710 Addi Data timer card. \n\nBoth counters are exported as a vec"
"tor."
	  MaskPromptString	  "Board Handle|Module Number|Clock Selection|"
"Timing Unit|Time Base"
	  MaskStyleString	  "edit,popup(0|1|2|3),popup(PCI 30MHz|PCI 33M"
"Hz|Internal 40MHz),popup(Nanoseconds|Microseconds|Milliseconds),edit"
	  MaskTunableValueString  "off,off,off,off,off"
	  MaskCallbackString	  "||||"
	  MaskEnableString	  "on,on,on,on,on"
	  MaskVisibilityString	  "on,on,on,on,on"
	  MaskToolTipString	  "on,on,on,on,on"
	  MaskVarAliasString	  ",,,,"
	  MaskVariables		  "b_BoardHandle=@1;b_ModuleNumber=@2;b_ClockS"
"election=@3;b_TimingUnit=@4;ul_Timing=@5;"
	  MaskDisplay		  "fprintf('1710 ETM\\nB:%i M/d:%i',\nb_BoardH"
"andle,b_ModuleNumber);"
	  MaskIconFrame		  on
	  MaskIconOpaque	  on
	  MaskIconRotate	  "none"
	  MaskIconUnits		  "autoscale"
	  MaskValueString	  "0|0|PCI 30MHz|Microseconds|0"
	  MaskTabNameString	  ",,,,"
	}
      }
    }
    Block {
      BlockType		      "S-Function"
      Name		      "Catch"
      Ports		      [0, 1]
      Position		      [70, 240, 130, 270]
      BackgroundColor	      "orange"
      InitFcn		      "catch_check(gcb,'CheckIds');"
      FunctionName	      "catch"
      Parameters	      "ErrId,dtype,Width,TSample"
      MaskPromptString	      "Error Identifier|Output Data Type Mode |Sample "
"Time (-1 inherited)|Width|Source Paths (Info only)|Source Count"
      MaskStyleString	      "edit,popup(double|single|int8|uint8|int16|uint1"
"6|int32|uint32|boolean|Inherit via back propagation),edit,edit,edit,edit"
      MaskTunableValueString  "off,off,off,off,off,off"
      MaskCallbackString      "catch_check(gcb,'CheckIds');|||||"
      MaskEnableString	      "on,on,on,on,on,on"
      MaskVisibilityString    "on,on,on,on,on,off"
      MaskToolTipString	      "on,on,on,on,on,on"
      MaskVarAliasString      ",,,,,"
      MaskVariables	      "ErrId=&1;dtype=@2;TSample=@3;Width=@4;SrcPath=&"
"5;SrcCount=@6;"
      MaskDisplay	      "fprintf('%s',ErrId);"
      MaskIconFrame	      on
      MaskIconOpaque	      on
      MaskIconRotate	      "none"
      MaskIconUnits	      "autoscale"
      MaskValueString	      "E10|boolean|0|0|0|0"
      MaskTabNameString	      ",,,,,"
    }
    Block {
      BlockType		      SubSystem
      Name		      "EtherCAT"
      Ports		      []
      Position		      [295, 39, 366, 100]
      MinAlgLoopOccurrences   off
      RTWSystemCode	      "Auto"
      FunctionWithSeparateData off
      MaskHideContents	      off
      System {
	Name			"EtherCAT"
	Location		[898, 404, 1395, 772]
	Open			on
	ModelBrowserVisibility	off
	ModelBrowserWidth	200
	ScreenColor		"white"
	PaperOrientation	"landscape"
	PaperPositionMode	"auto"
	PaperType		"A4"
	PaperUnits		"centimeters"
	TiledPaperMargins	[0.500000, 0.500000, 0.500000, 0.500000]
	TiledPageScale		1
	ShowPageBoundaries	off
	ZoomFactor		"100"
	Block {
	  BlockType		  "S-Function"
	  Name			  "AIN_0"
	  Ports			  [0, 1]
	  Position		  [25, 80, 105, 120]
	  BackgroundColor	  "yellow"
	  FunctionName		  "ec_slave"
	  Parameters		  "master,domain,alias,position,model,vendor,p"
"roduct,revision,pdo_entry,pdo_info,sdo_config,input,output,tsample"
	  MaskType		  "EL31xx"
	  MaskDescription	  "Beckhoff 2,4,8-Channel 16-Bit Analog Input"
"\n\nOutput Type:\n  1-Byte output: one bit coded input\n  Vector output: Outp"
"ut vector is <Channels> wide\n  Separate outputs: have <Channels> number of o"
"utputs\n\nInput Gain/Offset:\n  Specify a possible Gain and Offset for the in"
"put signal"
	  MaskHelp		  "This block generically implements the Ether"
"CAT 16-Bit Analog Input Terminal for various models.\n<p/>\nThe following Ter"
"minals are supported:\n<center>\n<table width=\"80%\">\n<tr><td>EL3102,4,8</t"
"d><td>-10..10V Voltage Input</td></tr>\n<tr><td>EL3112,4   </td><td>0..20mA C"
"urrent Input</td></tr>\n<tr><td>EL3122,4   </td><td>4..20mA Current Input</td"
"></tr>\n<tr><td>EL3142,4,8</td><td>0..20mA Current Input</td></tr>\n<tr><td>E"
"L3152,4,8</td><td>4..20mA Current Input</td></tr>\n<tr><td>EL3162,4,8</td><td"
">0..10V Voltage Input</td></tr>\n</table>\n</center>\n<p/>\nChoose and set th"
"e following options:\n<h4>Master:</h4>\nSet the EtherCAT Master of this termi"
"nal.\n\n<h4>Slave Index:</h4>\nSet the EtherCAT slave index. Following addres"
"s formats are allowed:\n<ol>\n<li> Absolute addressing: a number <<b><tt>n</t"
"t></b>> representing the (zero based) absolute index. <b><tt>n</tt></b> is ty"
"pically larger than 0 because the first coupler has that address.\n\n<li> Fie"
"ld addressing: Has the form <<b><tt>f:n</tt></b>> where <b><tt>f</tt></b> is "
"the (zero based) EtherCAT coupler field and \n<b><tt>n</tt></b> is the termin"
"al offset in that field. Take note that <b><tt>n</tt></b> is also greater tha"
"n 0.\n\n<li> SSId addressing: the Secondary Slave Addressing has the form <<b"
"><tt>#s:n</tt></b>> where <b><tt>s</tt></b> is the Secondary Slave Id of the "
"EtherCAT coupler and <b><tt>n</tt></b> is the offset in that field. The SSId "
"has to be preprogrammed into the coupler with other service tools.\n</ol>\n\n"
"<h4>Device Model:</h4>\nChoose the model at the Indexed position of the maste"
"r.\n\n<h4>Output Type:</h4>\n<ul>\n<li>Choose <b>Vector Output</b> to have a "
"single output as a vector\nwith a size corresponding to the channel count of "
"the terminal. This mode also allows a status output port to be displayed. <br"
"/>\n<li>Choose <b>Separate Outputs</b> to have one output for every channel."
"\n</ul>\n<h4>Output Full Scale</h4>\nWhen <b>Output Data Type</b> is set to <"
"b>Double with scale and offset</b>, the block's output value at full scale te"
"rminal input can be set here.\n\n<h4>Output Offset</h4>\nWhen <b>Output Data "
"Type</b> is set to <b>Double with scale and offset</b>, the blocks output at "
"zero terminal input can be set here. Note that the Full Scale above is also i"
"ncreased by this amount. Note furthermore that this corresponds to the minimu"
"m input for terminals such as 4..20mA.\n\n<h4>Output Data Type</h4>\nChoose t"
"he block's output data type for the output signal. Available are:\n<ul>\n<li>"
"<b><tt>Raw</tt></b> outputting the internal raw value as <tt>int16_T</tt> or "
"<tt>uint16_T</tt> as appropriate\n<li><b><tt>Double</tt></b> outputting 0..10"
", -10..10, 0..0.02 and 0.004..0.02 depending on the Model as appropriate\n<li"
"><b><tt>Double with scale and offset</tt></b>, allowing the output to be scal"
"ed with an offset.\n</ul>\n\n<p>\nChoosing <b>Status Output</b> provides a po"
"rt of type <tt>uint8_T</tt> where the status is presented. This is only enabl"
"ed when <b>Vector Output</b> is selected. Terminal input over- and underrange"
" can be detected using this output. See the terminal's documentation.\n\n<h4>"
"Output Filter</h4>\nWhen not in <b>Raw</b> mode, the <b>Output Filter</b> che"
"ckbox becomes available, allowing the use of an internal low pass filter. Ent"
"er the <b>LPF Time Constant</b> for the filter in the field below.\n<br>For c"
"ontinuous sample time systems (0 in Sample Time), the filter is also continuo"
"us. Discrete samples systems (Sample Time > 0) uses an equivalent discrete lo"
"w pass filter with a similar time constant.\n\n<p>\nSet the <b>Sample Time</b"
"> for the block. <tt>0</tt> is continuous sample time (runs at the model's ba"
"se rate). Setting <tt>-1</tt> will try to set the time using back propagation"
".\n"
	  MaskPromptString	  "Master|Slave Index|Device Model |Output Typ"
"e |Output Full Scale|Output Offset|Output Data Type|Status Output|Output Filt"
"er|LPF Time Constant (sec)|Sample Time"
	  MaskStyleString	  "edit,edit,popup(EL3102|EL3152|EL3162),popup"
"(Vector Output|Separate Outputs),edit,edit,popup(Raw bits|Double|Double with "
"scale and offset),checkbox,checkbox,edit,edit"
	  MaskTunableValueString  "off,off,off,off,off,off,off,off,off,off,off"
	  MaskCallbackString	  "|||el31xx_check('output_type');\n|||el31xx_"
"check('dtype');||el31xx_check('filter');||"
	  MaskEnableString	  "on,on,on,on,off,off,on,on,on,off,on"
	  MaskVisibilityString	  "on,on,on,on,on,on,on,on,on,on,on"
	  MaskToolTipString	  "on,on,on,on,on,on,on,on,on,on,on"
	  MaskVarAliasString	  ",,,,,,,,,,"
	  MaskVariables		  "master=@1;index=&2;model=&3;output_type=@4;"
"scale=@5;offset=@6;dtype=@7;status=@8;filter=@9;tau=@10;tsample=@11;"
	  MaskInitialization	  "% Calculate master and domain id.\n% accept"
" 2 forms for master:\n% Scalar: master = value\n% else Vector: [master domain"
"]\nif sum(size(master)) > 2\n    domain = master(2);\n    master = master(1);"
"\n    masterid = sprintf('M:%u.%u', master, domain);\nelse\n    master = mast"
"er(1);\n    domain = 0;\n    masterid = sprintf('M:%u', master);\nend\n\n% Ca"
"lculate slave alias and position, and format positionStr for\n% display in th"
"e block graphics\nif max(size(index))\n    if index(1) == '#'\n        [res,n"
"um] = sscanf(index,'#%u:%u');\n        if num ~= 2\n            res = [0 0];"
"\n        end\n    else\n        value = int16(str2num(index));\n        if ~"
"max(size(value))\n            value = [0];\n        end\n        res = [0 val"
"ue(1)];\n    end\nelse\n    res = [0 0];\nend\nalias = res(1);\nposition = re"
"s(2);\nif alias ~= 0\n    positionStr = sprintf('#%u:%u', alias, position);\n"
"else\n    positionStr = num2str(position);\nend\n\nmodel_idx = find(strcmp(mo"
"del, {'EL3102', 'EL3152', 'EL3162'}));\n\nif model_idx\n    productCode = [he"
"x2dec('0C1E3052') hex2dec('0C503052') ...\n        hex2dec('0C5A3052')];\n   "
" product = productCode(model_idx);\n    func = {'-10..10V','4..20mA','0-10V'}"
";\n    func = func{model_idx};\nelse\n    product = 0;\n    productName = 'No"
"tFound';\n    func = 'NotFound';\nend\nvendor = 2;\nrevision = 1;\n\n% PDO En"
"try is a definition of all PDO's that exist in the slave\n% List here a matri"
"x, where every row has 3 elements:\n% 1: PDO index\n% 2: PDO subindex\n% 3: B"
"it size (8,16,32); Negative values mean signed values\nif model_idx == 1\n   "
" pdo_data_type = -16;\nelse\n    pdo_data_type = 16;\nend\npdo_entry = [ ..."
"\n    hex2dec('3101'), 1, 8; ...\n    hex2dec('3101'), 2, 16; ...\n    hex2de"
"c('3102'), 1, 8; ...\n    hex2dec('3102'), 2, 16];\n\n% SDO Config is the con"
"figuration of a slave\n% It is a matrix, every row having 4 elements:\n% 1: S"
"DO Index\n% 2: SDO Subindex\n% 3: Size    (8,16,32)\n% 4: value\nsdo_config ="
" [];\n\n% This maps ???\n% It is a matrix, every row having 4 elements:\n% 1:"
" PDO direction as seen by the slave: 0 = output; 1 = Input\n% 2: PDO Index\n%"
" 3: Starting row of PDO entry (Zero based)\n% 4: Number of PDO entry rows\npd"
"o_info = [...\n    0, hex2dec('1A00'), 0, 2;...\n    0, hex2dec('1A01'), 2, 2"
";...\n    ];\n   \nif output_type == 1\n    % Vector output chosen\n\n    out"
"put(1).pdo_map = [0 1; 1 1];\n\n    if dtype ~= 1\n        output(1).full_sca"
"le_bits = 15;\n        \n        if dtype == 3\n            output(1).gain = "
"scale;\n            output(1).offset = offset;\n            output(1).gain_na"
"me = 'FullScale';\n            output(1).offset_name = 'Offset';\n        end"
"\n        if filter\n            if sum(tau == 0)\n                errordlg(["
"gcb ': Specify a nonzero time constant '...\n                    'for the out"
"put filter.']);\n            end\n            if (tsample)\n                o"
"utput(1).filter = tsample./tau;\n                output(1).filter_name = 'Inp"
"utWeight';\n            else\n                output(1).filter = 2*pi./tau;\n"
"                output(1).filter_name = 'Omega';\n            end\n        en"
"d\n    end\n\n    if status\n        output(2).pdo_map = [0 0; 1 0];\n    end"
"\n\nelse\n    % Separate outputs chosen\n    output(1).pdo_map = [0 1];\n    "
"output(2).pdo_map = [1 1];\n\n    if dtype ~= 1\n        output(1).full_scale"
"_bits = 15;\n        output(2).full_scale_bits = 15;\n        \n        if dt"
"ype == 3\n            if sum(size(scale)) > 1\n                output(1).gain"
" = scale(1);\n                if sum(size(scale)) > 2\n                    ou"
"tput(2).gain = scale(2);\n                else\n                    output(2)"
".gain = scale(1);\n                end\n                output(1).gain_name ="
" 'FullScale1';\n                output(2).gain_name = 'FullScale2';\n        "
"    end\n\n            if sum(size(offset)) > 1\n                output(1).of"
"fset = offset(1);\n                if sum(size(offset)) > 2\n                "
"    output(2).offset = offset(2);\n                else\n                    "
"output(2).offset = offset(1);\n                end\n                output(1)"
".offset_name = 'Offset1';\n                output(2).offset_name = 'Offset2';"
"\n            end\n        end\n\n        if filter && sum(size(tau)) > 1\n  "
"          if sum(tau == 0)\n                errordlg([gcb ': Specify a nonzer"
"o time constant '...\n                    'for the output filter.']);\n      "
"      end\n\n            if (tsample)\n                k = tsample./tau;\n   "
"             output(1).filter_name = 'InputWeight1';\n                output("
"2).filter_name = 'InputWeight2';\n            else\n                k = 2*pi."
"/tau;\n                output(1).filter_name = 'Omega1';\n                out"
"put(2).filter_name = 'Omega2';\n            end\n            output(1).filter"
" = k(1);\n            if sum(size(tau)) > 2\n                output(2).filter"
" = k(2);\n            else\n                output(2).filter = k(1);\n       "
"     end\n            \n        end\n    end\nend\n\ninput = [];\n"
	  MaskDisplay		  "fprintf(...\n    '%s\\n%s AIn\\n%s Idx:%s',"
"...\n    model,...\n    func,...\n    masterid,...\n    positionStr\n)\n"
	  MaskIconFrame		  on
	  MaskIconOpaque	  on
	  MaskIconRotate	  "none"
	  MaskIconUnits		  "autoscale"
	  MaskValueString	  "0|1|EL3102|Vector Output|1|0|Double|off|off"
"|0.1|0"
	  MaskTabNameString	  ",,,,,,,,,,"
	}
	Block {
	  BlockType		  "S-Function"
	  Name			  "AOUT_0"
	  Ports			  [1]
	  Position		  [180, 80, 260, 120]
	  BackgroundColor	  "yellow"
	  FunctionName		  "ec_slave"
	  Parameters		  "master,domain,alias,position,model,vendor,p"
"roduct,revision,pdo_entry,pdo_info,sdo_config,input,output,tsample"
	  MaskType		  "EL41xx"
	  MaskDescription	  "Beckhoff 2,4,8-Channel 16-Bit Analog Output"
"\n\nInput Type:\n  1-Byte input: one bit coded input\n  Vector input: Input v"
"ector is <Channels> wide\n  Separate inputs: have <Channels> number of inputs"
"\n"
	  MaskHelp		  "This block generically implements the Ether"
"CAT 16-Bit Analog Input Terminal for various models.\n<p/>\nThe block input i"
"s generally a <tt>double</tt> corresponding the the terminal's capability. Th"
"us a 4..20mA terminal expects values in the range [0.004..0.02). If a digital"
" input is required, only <tt>uint16</tt> or <tt>int16</tt> is accepted, depen"
"ding on whether the the terminal is bipolar or not.\n<p/>\nExceeding the inpu"
"t range simply saturates the terminal's output.\n<p/>\nThe following Terminal"
"s are supported:\n<center>\n<table width=\"80%\">\n<tr><td>EL4102,4,8</td><td"
">0..10V Voltage Output</td></tr>\n<tr><td>EL4112,4,8</td><td>0..20mA Current "
"Output</td></tr>\n<tr><td>EL4122,4,8</td><td>4..20mA Current Output</td></tr>"
"\n<tr><td>EL4132,4,8</td><td>-10..10V Voltage Output</td></tr>\n</table>\n</c"
"enter>\n<p/>\nChoose and set the following options:\n<h4>Master:</h4>\nSet th"
"e EtherCAT Master of this terminal.\n\n<h4>Slave Index:</h4>\nSet the EtherCA"
"T slave index. Following address formats are allowed:\n<ol>\n<li> Absolute ad"
"dressing: a number <<b><tt>n</tt></b>> representing the (zero based) absolute"
" index. <b><tt>n</tt></b> is typically larger than 0 because the first couple"
"r has that address.\n\n<li> Field addressing: Has the form <<b><tt>f:n</tt></"
"b>> where <b><tt>f</tt></b> is the (zero based) EtherCAT coupler field and \n"
"<b><tt>n</tt></b> is the terminal offset in that field. Take note that <b><tt"
">n</tt></b> is also greater than 0.\n\n<li> SSId addressing: the Secondary Sl"
"ave Addressing has the form <<b><tt>#s:n</tt></b>> where <b><tt>s</tt></b> is"
" the Secondary Slave Id of the EtherCAT coupler and <b><tt>n</tt></b> is the "
"offset in that field. The SSId has to be preprogrammed into the coupler with "
"other service tools.\n</ol>\n\n<h4>Device Model:</h4>\nChoose the device at t"
"he Indexed position of the master.\n\n<h4>Input Type:</h4>\n<ul>\n<li>Choose "
"<b>Vector Input</b> to have a single input as a vector\nwith a size correspon"
"ding to the channel count of the terminal. This mode also allows a control in"
"put and a status output port to be displayed.\n<li>Choose <b>Separate Inputs<"
"/b> to have one input for every channel.\n</ul>\n\n<p>\nChoosing <b>Status Ou"
"tput</b> provides a port of type <tt>uint8_T</tt> where the status is present"
"ed. This is only enabled when <b>Vector Output</b> is selected. Note: at the "
"time of writing (1.2.2006) the terminals do not have a status output, and hen"
"ce this option is disabled!\n\n<p>\nSet the <b>Sample Time</b> for the block."
" <tt>0</tt> is continuous sample time (runs at the model's base rate). Settin"
"g <tt>-1</tt> will try to set the time using back propagation.\n"
	  MaskPromptString	  "Master|Slave Index|Device Model |Input Type"
" |Scale|Input Full Scale|Status Output|Sample Time (-1 for inherited)"
	  MaskStyleString	  "edit,edit,popup(EL4102|EL4132|EL4122|EL4112"
"),popup(Vector Input|Separate Inputs),checkbox,edit,checkbox,edit"
	  MaskTunableValueString  "off,off,off,off,off,off,off,off"
	  MaskCallbackString	  "|||el41xx_check('input_type');\n|scale_idx "
"= find(strcmp(get_param(gcb,'MaskNames'),'scale'));\nen = get_param(gcb,'Mask"
"Enables');\nif strcmp(get_param(gcb,'scale_on'), 'on')\n    en{scale_idx} = '"
"on';\nelse\n    en{scale_idx} = 'off';\nend\n\nset_param(gcb,'MaskEnables',en"
");\n|||"
	  MaskEnableString	  "on,on,on,on,on,off,off,on"
	  MaskVisibilityString	  "on,on,on,on,on,on,on,on"
	  MaskToolTipString	  "on,on,on,on,on,on,on,on"
	  MaskVarAliasString	  ",,,,,,,"
	  MaskVariables		  "master=@1;index=&2;model=&3;input_type=@4;s"
"cale_on=@5;scale=@6;status=@7;tsample=@8;"
	  MaskInitialization	  "% Calculate master and domain id.\n% accept"
" 2 forms for master:\n% Scalar: master = value\n% else Vector: [master domain"
"]\nif sum(size(master)) > 2\n    domain = master(2);\n    master = master(1);"
"\n    masterid = sprintf('M:%u.%u', master, domain);\nelse\n    master = mast"
"er(1);\n    domain = 0;\n    masterid = sprintf('M:%u', master);\nend\n\n% Ca"
"lculate slave alias and position, and format positionStr for\n% display in th"
"e block graphics\nif max(size(index))\n    if index(1) == '#'\n        [res,n"
"um] = sscanf(index,'#%u:%u');\n        if num ~= 2\n            res = [0 0];"
"\n        end\n    else\n        value = int16(str2num(index));\n        if ~"
"max(size(value))\n            value = [0];\n        end\n        res = [0 val"
"ue(1)];\n    end\nelse\n    res = [0 0];\nend\nalias = res(1);\nposition = re"
"s(2);\nif alias ~= 0\n    positionStr = sprintf('#%u:%u', alias, position);\n"
"else\n    positionStr = num2str(position);\nend\n\nmodels = {'EL4102', 'EL413"
"2', 'EL4122','EL4112'};\n\nmodel_idx = find(strcmp(model, models));\nif model"
"_idx\n    productCode = [hex2dec('10063052') hex2dec('10243052') ...\n       "
" hex2dec('101a3052') hex2dec('10103052')];\n    product = productCode(model_i"
"dx);\n    func = {'0..10V','+-10V','4..20mA','0..20mA'};\n    func = func{mod"
"el_idx};\nelse\n    product = 0;\n    productName = 'NotFound';\n    func = '"
"NotFound';\nend\nvendor = 2;\nrevision = 1;\n\n% PDO Entry is a definition of"
" all PDO's that exist in the slave\n% List here a matrix, where every row has"
" 3 elements:\n% 1: PDO index\n% 2: PDO subindex\n% 3: Bit size (8,16,32); Neg"
"ative values mean signed values\nif model == 2\n    pdo_data_type = -16;\nels"
"e\n    pdo_data_type = 16;\nend\npdo_entry = [ ...\n    hex2dec('6411'), 1, p"
"do_data_type; ...\n    hex2dec('6411'), 2, pdo_data_type];\n\n% SDO Config is"
" the configuration of a slave\n% It is a matrix, every row having 4 elements:"
"\n% 1: SDO Index\n% 2: SDO Subindex\n% 3: Size    (8,16,32)\n% 4: value\nsdo_"
"config = [];\n\n% This maps ???\n% It is a matrix, every row having 4 element"
"s:\n% 1: PDO direction as seen by the slave: 0 = output; 1 = Input\n% 2: PDO "
"Index\n% 3: Starting row of PDO entry (Zero based)\n% 4: Number of PDO entry "
"rows\npdo_info = [...\n    1, hex2dec('1600'), 0, 1;...\n    1, hex2dec('1601"
"'), 1, 1;...\n    ];\n   \n% Vector output chosen\n\ninput(1).pdo_map = [0 0;"
" 1 0];\ninput(1).full_scale_bits = 15;\n\nif scale_on\n    input(1).gain = sc"
"ale;\n    input(1).gain_name = 'FullScale';\nend\n\nif input_type == 2\n    i"
"nput(2) = input(1);\n    input(1).pdo_map = [0 0];\n    input(2).pdo_map = [1"
" 0];\n    if scale_on\n        if max(size(scale)) < 2\n            errordlg("
"[gcb ': At least 2 scale elements required.']);\n        end\n        input(1"
").gain_name = 'FullScale1';\n        input(2).gain_name = 'FullScale2';\n    "
"    input(1).gain = scale(1);\n        input(2).gain = scale(2);\n    end\nen"
"d\n\noutput = [];\n"
	  MaskDisplay		  "fprintf(...\n    '%s\\n%s AIn\\n%s Idx:%s',"
"...\n    model,...\n    func,...\n    masterid,...\n    positionStr\n)\n"
	  MaskIconFrame		  on
	  MaskIconOpaque	  on
	  MaskIconRotate	  "none"
	  MaskIconUnits		  "autoscale"
	  MaskValueString	  "0|1|EL4102|Vector Input|off|0|off|-1"
	  MaskTabNameString	  ",,,,,,,"
	}
	Block {
	  BlockType		  "S-Function"
	  Name			  "DIN_0"
	  Ports			  [0, 1]
	  Position		  [25, 20, 105, 60]
	  BackgroundColor	  "yellow"
	  FunctionName		  "ec_slave"
	  Parameters		  "master,domain,alias,position,model,vendor,p"
"roduct_code,revision,pdo_entry,pdo_info,sdo_config,input,output,tsample"
	  MaskType		  "EL31xx"
	  MaskDescription	  "Beckhoff 2,4,8-Channel 16-Bit Analog Input"
"\n\nOutput Type:\n  1-Byte output: one bit coded input\n  Vector output: Outp"
"ut vector is <Channels> wide\n  Separate outputs: have <Channels> number of o"
"utputs\n\nInput Gain/Offset:\n  Specify a possible Gain and Offset for the in"
"put signal"
	  MaskHelp		  "This block generically implements the Ether"
"CAT 16-Bit Analog Input Terminal for various models.\n<p/>\nThe following Ter"
"minals are supported:\n<center>\n<table width=\"80%\">\n<tr><td>EL3102,4,8</t"
"d><td>-10..10V Voltage Input</td></tr>\n<tr><td>EL3112,4   </td><td>0..20mA C"
"urrent Input</td></tr>\n<tr><td>EL3122,4   </td><td>4..20mA Current Input</td"
"></tr>\n<tr><td>EL3142,4,8</td><td>0..20mA Current Input</td></tr>\n<tr><td>E"
"L3152,4,8</td><td>4..20mA Current Input</td></tr>\n<tr><td>EL3162,4,8</td><td"
">0..10V Voltage Input</td></tr>\n</table>\n</center>\n<p/>\nChoose and set th"
"e following options:\n<h4>Master:</h4>\nSet the EtherCAT Master of this termi"
"nal.\n\n<h4>Slave Index:</h4>\nSet the EtherCAT slave index. Following addres"
"s formats are allowed:\n<ol>\n<li> Absolute addressing: a number <<b><tt>n</t"
"t></b>> representing the (zero based) absolute index. <b><tt>n</tt></b> is ty"
"pically larger than 0 because the first coupler has that address.\n\n<li> Fie"
"ld addressing: Has the form <<b><tt>f:n</tt></b>> where <b><tt>f</tt></b> is "
"the (zero based) EtherCAT coupler field and \n<b><tt>n</tt></b> is the termin"
"al offset in that field. Take note that <b><tt>n</tt></b> is also greater tha"
"n 0.\n\n<li> SSId addressing: the Secondary Slave Addressing has the form <<b"
"><tt>#s:n</tt></b>> where <b><tt>s</tt></b> is the Secondary Slave Id of the "
"EtherCAT coupler and <b><tt>n</tt></b> is the offset in that field. The SSId "
"has to be preprogrammed into the coupler with other service tools.\n</ol>\n\n"
"<h4>Device Model:</h4>\nChoose the model at the Indexed position of the maste"
"r.\n\n<h4>Output Type:</h4>\n<ul>\n<li>Choose <b>Vector Output</b> to have a "
"single output as a vector\nwith a size corresponding to the channel count of "
"the terminal. This mode also allows a status output port to be displayed. <br"
"/>\n<li>Choose <b>Separate Outputs</b> to have one output for every channel."
"\n</ul>\n<h4>Output Full Scale</h4>\nWhen <b>Output Data Type</b> is set to <"
"b>Double with scale and offset</b>, the block's output value at full scale te"
"rminal input can be set here.\n\n<h4>Output Offset</h4>\nWhen <b>Output Data "
"Type</b> is set to <b>Double with scale and offset</b>, the blocks output at "
"zero terminal input can be set here. Note that the Full Scale above is also i"
"ncreased by this amount. Note furthermore that this corresponds to the minimu"
"m input for terminals such as 4..20mA.\n\n<h4>Output Data Type</h4>\nChoose t"
"he block's output data type for the output signal. Available are:\n<ul>\n<li>"
"<b><tt>Raw</tt></b> outputting the internal raw value as <tt>int16_T</tt> or "
"<tt>uint16_T</tt> as appropriate\n<li><b><tt>Double</tt></b> outputting 0..10"
", -10..10, 0..0.02 and 0.004..0.02 depending on the Model as appropriate\n<li"
"><b><tt>Double with scale and offset</tt></b>, allowing the output to be scal"
"ed with an offset.\n</ul>\n\n<p>\nChoosing <b>Status Output</b> provides a po"
"rt of type <tt>uint8_T</tt> where the status is presented. This is only enabl"
"ed when <b>Vector Output</b> is selected. Terminal input over- and underrange"
" can be detected using this output. See the terminal's documentation.\n\n<h4>"
"Output Filter</h4>\nWhen not in <b>Raw</b> mode, the <b>Output Filter</b> che"
"ckbox becomes available, allowing the use of an internal low pass filter. Ent"
"er the <b>LPF Time Constant</b> for the filter in the field below.\n<br>For c"
"ontinuous sample time systems (0 in Sample Time), the filter is also continuo"
"us. Discrete samples systems (Sample Time > 0) uses an equivalent discrete lo"
"w pass filter with a similar time constant.\n\n<p>\nSet the <b>Sample Time</b"
"> for the block. <tt>0</tt> is continuous sample time (runs at the model's ba"
"se rate). Setting <tt>-1</tt> will try to set the time using back propagation"
".\n"
	  MaskPromptString	  "Master|Slave Index|Device Model |Output Typ"
"e|Sample Time"
	  MaskStyleString	  "edit,edit,popup(EL1004|EL1004v2|EL1008|EL10"
"14|EL1014v2|EL1018),popup(Vector Output|Separate Outputs),edit"
	  MaskTunableValueString  "off,off,off,off,off"
	  MaskCallbackString	  "||||"
	  MaskEnableString	  "on,on,on,on,on"
	  MaskVisibilityString	  "on,on,on,on,on"
	  MaskToolTipString	  "on,on,on,on,on"
	  MaskVarAliasString	  ",,,,"
	  MaskVariables		  "master=@1;index=&2;model=&3;output_type=&4;"
"tsample=@5;"
	  MaskInitialization	  "% Calculate master and domain id.\n% accept"
" 2 forms for master:\n% Scalar: master = value\n% else Vector: [master domain"
"]\nif sum(size(master)) > 2\n    domain = master(2);\n    master = master(1);"
"\n    masterid = sprintf('M:%u.%u', master, domain);\nelse\n    master = mast"
"er(1);\n    domain = 0;\n    masterid = sprintf('M:%u', master);\nend\n\n% Ca"
"lculate slave alias and position, and format positionStr for\n% display in th"
"e block graphics\nif max(size(index))\n    if index(1) == '#'\n        [res,n"
"um] = sscanf(index,'#%u:%u');\n        if num ~= 2\n            res = [0 0];"
"\n        end\n    else\n        value = int16(str2num(index));\n        if ~"
"max(size(value))\n            value = [0];\n        end\n        res = [0 val"
"ue(1)];\n    end\nelse\n    res = [0 0];\nend\nalias = res(1);\nposition = re"
"s(2);\nif alias ~= 0\n    positionStr = sprintf('#%u:%u', alias, position);\n"
"else\n    positionStr = num2str(position);\nend\n\nif find(strcmp(model, {'EL"
"1004v2' 'EL1014v2'}))\n    revision = 1;\n    pdo_entry = [hex2dec('6000') 1 "
"1; ...\n                 hex2dec('6010') 1 1; ...\n                 hex2dec('"
"6020') 1 1; ...\n                 hex2dec('6030') 1 1];\nelseif find(strcmp(m"
"odel, {'EL1004' 'EL1014'}))\n    revision = 0;\n    pdo_entry = [hex2dec('310"
"1') 1 1; ...\n                 hex2dec('3101') 2 1; ...\n                 hex"
"2dec('3101') 3 1; ...\n                 hex2dec('3101') 4 1];\nelseif find(st"
"rcmp(model, {'EL1008' 'EL1018'}))\n    revision = 1;\n    pdo_entry = [hex2de"
"c('6000') 1 1; ...\n                 hex2dec('6010') 1 1; ...\n              "
"   hex2dec('6020') 1 1; ...\n                 hex2dec('6030') 1 1; ...\n     "
"            hex2dec('6040') 1 1; ...\n                 hex2dec('6050') 1 1; ."
"..\n                 hex2dec('6060') 1 1; ...\n                 hex2dec('6070"
"') 1 1];\nelse\n    errordlg([gcb ': model ' model ' has not been defined.'])"
";\nend\nif findstr(model,'1004')\n    product_code = hex2dec('03EC3052');\nel"
"seif findstr(model,'1014')\n    product_code = hex2dec('03F63052');\nelseif f"
"indstr(model,'1008')\n    product_code = hex2dec('03f03052');\nelseif findstr"
"(model,'1018')\n    product_code = hex2dec('03fa3052');\nend\n\npdo_info  = ["
"0 hex2dec('1A00') 0 1; ...\n             0 hex2dec('1A01') 1 1; ...\n        "
"     0 hex2dec('1A02') 2 1; ...\n             0 hex2dec('1A03') 3 1];\nif mod"
"el(6) == '8'\n    pdo_info = [pdo_info; ...\n                0 hex2dec('1A04'"
") 4 1; ...\n                0 hex2dec('1A05') 5 1; ...\n                0 hex"
"2dec('1A06') 6 1; ...\n                0 hex2dec('1A07') 7 1];\nend\nvendor ="
" 2;\n\nsdo_config = [];\n\nif strcmp(output_type, 'Vector Output')\n    outpu"
"t(1).pdo_map = [0:size(pdo_info,2)-1; zeros(1,size(pdo_info,2))]';\nelseif st"
"rcmp(output_type, 'Separate Outputs')\n    for i = 1:size(pdo_info,2)\n      "
"  output(i).pdo_map  = [i-1 0];\n    end\nelse\n    errordlg([gcb ': unknown "
"output type: ' output_type]);\n    output = [];\nend\n\ninput = [];\n"
	  MaskDisplay		  "fprintf(...\n    '%s\\n%s Idx:%s',...\n    "
"model,...\n    masterid,...\n    positionStr\n)\n"
	  MaskIconFrame		  on
	  MaskIconOpaque	  on
	  MaskIconRotate	  "none"
	  MaskIconUnits		  "autoscale"
	  MaskValueString	  "0|1|EL1004v2|Vector Output|0"
	  MaskTabNameString	  ",,,,"
	}
	Block {
	  BlockType		  "S-Function"
	  Name			  "DOUT_0"
	  Ports			  [1]
	  Position		  [180, 20, 260, 60]
	  BackgroundColor	  "yellow"
	  FunctionName		  "ec_slave"
	  Parameters		  "master,domain,alias,position,model,vendor,p"
"roduct_code,revision,pdo_entry,pdo_info,sdo_config,input,output,tsample"
	  MaskType		  "EL31xx"
	  MaskDescription	  "Beckhoff 2,4,8-Channel 16-Bit Analog Input"
"\n\nOutput Type:\n  1-Byte output: one bit coded input\n  Vector output: Outp"
"ut vector is <Channels> wide\n  Separate outputs: have <Channels> number of o"
"utputs\n\nInput Gain/Offset:\n  Specify a possible Gain and Offset for the in"
"put signal"
	  MaskHelp		  "This block generically implements the Ether"
"CAT 16-Bit Analog Input Terminal for various models.\n<p/>\nThe following Ter"
"minals are supported:\n<center>\n<table width=\"80%\">\n<tr><td>EL3102,4,8</t"
"d><td>-10..10V Voltage Input</td></tr>\n<tr><td>EL3112,4   </td><td>0..20mA C"
"urrent Input</td></tr>\n<tr><td>EL3122,4   </td><td>4..20mA Current Input</td"
"></tr>\n<tr><td>EL3142,4,8</td><td>0..20mA Current Input</td></tr>\n<tr><td>E"
"L3152,4,8</td><td>4..20mA Current Input</td></tr>\n<tr><td>EL3162,4,8</td><td"
">0..10V Voltage Input</td></tr>\n</table>\n</center>\n<p/>\nChoose and set th"
"e following options:\n<h4>Master:</h4>\nSet the EtherCAT Master of this termi"
"nal.\n\n<h4>Slave Index:</h4>\nSet the EtherCAT slave index. Following addres"
"s formats are allowed:\n<ol>\n<li> Absolute addressing: a number <<b><tt>n</t"
"t></b>> representing the (zero based) absolute index. <b><tt>n</tt></b> is ty"
"pically larger than 0 because the first coupler has that address.\n\n<li> Fie"
"ld addressing: Has the form <<b><tt>f:n</tt></b>> where <b><tt>f</tt></b> is "
"the (zero based) EtherCAT coupler field and \n<b><tt>n</tt></b> is the termin"
"al offset in that field. Take note that <b><tt>n</tt></b> is also greater tha"
"n 0.\n\n<li> SSId addressing: the Secondary Slave Addressing has the form <<b"
"><tt>#s:n</tt></b>> where <b><tt>s</tt></b> is the Secondary Slave Id of the "
"EtherCAT coupler and <b><tt>n</tt></b> is the offset in that field. The SSId "
"has to be preprogrammed into the coupler with other service tools.\n</ol>\n\n"
"<h4>Device Model:</h4>\nChoose the model at the Indexed position of the maste"
"r.\n\n<h4>Output Type:</h4>\n<ul>\n<li>Choose <b>Vector Output</b> to have a "
"single output as a vector\nwith a size corresponding to the channel count of "
"the terminal. This mode also allows a status output port to be displayed. <br"
"/>\n<li>Choose <b>Separate Outputs</b> to have one output for every channel."
"\n</ul>\n<h4>Output Full Scale</h4>\nWhen <b>Output Data Type</b> is set to <"
"b>Double with scale and offset</b>, the block's output value at full scale te"
"rminal input can be set here.\n\n<h4>Output Offset</h4>\nWhen <b>Output Data "
"Type</b> is set to <b>Double with scale and offset</b>, the blocks output at "
"zero terminal input can be set here. Note that the Full Scale above is also i"
"ncreased by this amount. Note furthermore that this corresponds to the minimu"
"m input for terminals such as 4..20mA.\n\n<h4>Output Data Type</h4>\nChoose t"
"he block's output data type for the output signal. Available are:\n<ul>\n<li>"
"<b><tt>Raw</tt></b> outputting the internal raw value as <tt>int16_T</tt> or "
"<tt>uint16_T</tt> as appropriate\n<li><b><tt>Double</tt></b> outputting 0..10"
", -10..10, 0..0.02 and 0.004..0.02 depending on the Model as appropriate\n<li"
"><b><tt>Double with scale and offset</tt></b>, allowing the output to be scal"
"ed with an offset.\n</ul>\n\n<p>\nChoosing <b>Status Output</b> provides a po"
"rt of type <tt>uint8_T</tt> where the status is presented. This is only enabl"
"ed when <b>Vector Output</b> is selected. Terminal input over- and underrange"
" can be detected using this output. See the terminal's documentation.\n\n<h4>"
"Output Filter</h4>\nWhen not in <b>Raw</b> mode, the <b>Output Filter</b> che"
"ckbox becomes available, allowing the use of an internal low pass filter. Ent"
"er the <b>LPF Time Constant</b> for the filter in the field below.\n<br>For c"
"ontinuous sample time systems (0 in Sample Time), the filter is also continuo"
"us. Discrete samples systems (Sample Time > 0) uses an equivalent discrete lo"
"w pass filter with a similar time constant.\n\n<p>\nSet the <b>Sample Time</b"
"> for the block. <tt>0</tt> is continuous sample time (runs at the model's ba"
"se rate). Setting <tt>-1</tt> will try to set the time using back propagation"
".\n"
	  MaskPromptString	  "Master|Slave Index|Device Model |Input Type"
"|Status Output|Sample Time (-1 for inherited)"
	  MaskStyleString	  "edit,edit,popup(EL2004|EL2004v2|EL2032|EL20"
"32v2),popup(Vector Input|Separate Inputs),checkbox,edit"
	  MaskTunableValueString  "off,off,off,off,off,off"
	  MaskCallbackString	  "||status_idx = find(strcmp(get_param(gcb,'M"
"askNames'),'status'));\n\nen = get_param(gcb,'MaskEnables');\n\nif findstr('2"
"032',get_param(gcb,'model'))\n        en{status_idx} = 'on';\nelse\n    en{st"
"atus_idx} = 'off';\nend\nset_param(gcb,'MaskEnables',en);\n|||"
	  MaskEnableString	  "on,on,on,on,off,on"
	  MaskVisibilityString	  "on,on,on,on,on,on"
	  MaskToolTipString	  "on,on,on,on,on,on"
	  MaskVarAliasString	  ",,,,,"
	  MaskVariables		  "master=@1;index=&2;model=&3;input_type=&4;s"
"tatus=@5;tsample=@6;"
	  MaskInitialization	  "% Calculate master and domain id.\n% accept"
" 2 forms for master:\n% Scalar: master = value\n% else Vector: [master domain"
"]\nif sum(size(master)) > 2\n    domain = master(2);\n    master = master(1);"
"\n    masterid = sprintf('M:%u.%u', master, domain);\nelse\n    master = mast"
"er(1);\n    domain = 0;\n    masterid = sprintf('M:%u', master);\nend\n\n% Ca"
"lculate slave alias and position, and format positionStr for\n% display in th"
"e block graphics\nif max(size(index))\n    if index(1) == '#'\n        [res,n"
"um] = sscanf(index,'#%u:%u');\n        if num ~= 2\n            res = [0 0];"
"\n        end\n    else\n        value = int16(str2num(index));\n        if ~"
"max(size(value))\n            value = [0];\n        end\n        res = [0 val"
"ue(1)];\n    end\nelse\n    res = [0 0];\nend\nalias = res(1);\nposition = re"
"s(2);\nif alias ~= 0\n    positionStr = sprintf('#%u:%u', alias, position);\n"
"else\n    positionStr = num2str(position);\nend\n\nif strcmp(model, 'EL2004v2"
"')\n    revision = 1;\n    pdo_entry = [hex2dec('7000') 1 1; ...\n           "
"      hex2dec('7010') 1 1; ...\n                 hex2dec('7020') 1 1; ...\n  "
"               hex2dec('7030') 1 1];\nelseif strcmp(model, 'EL2004')\n    rev"
"ision = 0;\n    pdo_entry = [hex2dec('3001') 1 1; ...\n                 hex2d"
"ec('3001') 2 1; ...\n                 hex2dec('3001') 3 1; ...\n             "
"    hex2dec('3001') 4 1];\nelseif strcmp(model, 'EL2032v2')\n    revision = 1"
";\n    pdo_entry = [hex2dec('7000') 1 1; ...\n                 hex2dec('7010'"
") 1 1; ...\n                 hex2dec('6000') 1 1; ...\n                 hex2d"
"ec('6010') 1 1];\nelseif strcmp(model, 'EL2032')\n    revision = 0;\n    pdo_"
"entry = [hex2dec('3001') 1 1; ...\n                 hex2dec('3001') 2 1; ..."
"\n                 hex2dec('3101') 1 1; ...\n                 hex2dec('3101')"
" 2 1];\nelseif strcmp(model, 'EL2008')\n    errordlg([gcb ': model ' model 'm"
"ust still be verified!']); \n    revision = 1;\n    pdo_entry = [hex2dec('700"
"0') 1 1; ...\n                 hex2dec('7010') 1 1; ...\n                 hex"
"2dec('7020') 1 1; ...\n                 hex2dec('7030') 1 1; ...\n           "
"      hex2dec('7040') 1 1; ...\n                 hex2dec('7050') 1 1; ...\n  "
"               hex2dec('7060') 1 1; ...\n                 hex2dec('7070') 1 1"
"];\nelse\n    errordlg([gcb ': model ' model ' has not been defined.']);\nend"
"\nif findstr(model,'2004')\n    product_code = hex2dec('07d43052');\n    pdo_"
"info = [1 hex2dec('1600') 0 1; ...\n                1 hex2dec('1601') 1 1; .."
".\n                1 hex2dec('1602') 2 1; ...\n                1 hex2dec('160"
"3') 3 1];\nelseif findstr(model,'2032')\n    product_code = hex2dec('07f03052"
"');\n    pdo_info = [1 hex2dec('1600') 0 1; ...\n                1 hex2dec('1"
"601') 1 1; ...\n                0 hex2dec('1A00') 2 1; ...\n                0"
" hex2dec('1A00') 3 1];\nelseif findstr(model,'2008')\n    product_code = hex2"
"dec('07d83052');\n    pdo_info = [1 hex2dec('1600') 0 1; ...\n               "
" 1 hex2dec('1601') 1 1; ...\n                1 hex2dec('1602') 2 1; ...\n    "
"            1 hex2dec('1603') 3 1; ...\n                1 hex2dec('1604') 4 1"
"; ...\n                1 hex2dec('1605') 5 1; ...\n                1 hex2dec("
"'1606') 6 1; ...\n                1 hex2dec('1607') 7 1];\nend\nvendor = 2;\n"
"\nsdo_config = [];\n\ninput(1).pdo_map = [find(pdo_info(:,1)' == 1)-1; find(p"
"do_info(:,1)' == 1)*0]';\n\nif status && findstr(model,'2032')\n    output(1)"
".pdo_map = [find(pdo_info(:,1)' == 0)-1; find(pdo_info(:,1)' == 0)*0]';\nelse"
"\n    output = [];\nend\n\nif strcmp(input_type,'Vector Input')\nelseif strcm"
"p(input_type, 'Separate Inputs')\n    if size(input(1).pdo_map,1) > 1\n      "
"  for i = 2:size(input(1).pdo_map,1)\n            input(i).pdo_map = input(1)"
".pdo_map(i,:);\n        end\n        input(1).pdo_map(2:size(input(1).pdo_map"
",1),:) = [];\n    end\n        \n    if size(output,2) && size(output(1).pdo_"
"map,1) > 1\n        for i = 2:size(output(1).pdo_map,1)\n            output(i"
").pdo_map = output(1).pdo_map(i,:);\n        end\n        output(1).pdo_map(2"
":size(output(1).pdo_map,1),:) = [];\n    end\nelse\n    errordlg([gcb ': unkn"
"own input type: ' output_type]);\nend\n"
	  MaskDisplay		  "fprintf(...\n    '%s\\n%s Idx:%s',...\n    "
"model,...\n    masterid,...\n    positionStr\n)\n"
	  MaskSelfModifiable	  on
	  MaskIconFrame		  on
	  MaskIconOpaque	  on
	  MaskIconRotate	  "none"
	  MaskIconUnits		  "autoscale"
	  MaskValueString	  "0|1|EL2004v2|Vector Input|off|0"
	  MaskTabNameString	  ",,,,,"
	}
	Block {
	  BlockType		  "S-Function"
	  Name			  "ENC_0"
	  Ports			  [0, 1]
	  Position		  [25, 199, 105, 241]
	  BackgroundColor	  "yellow"
	  FunctionName		  "ec_slave"
	  Parameters		  "master,domain,alias,position,model,vendor,p"
"roduct,revision,pdo_entry,pdo_info,sdo_config,input,output,tsample"
	  MaskType		  "EL5101"
	  MaskDescription	  "Beckhoff EtherCAT Incremental Encoder Input"
	  MaskHelp		  "This block implements the EtherCAT Incremen"
"tal Encoder Input Terminal EL5101.\n\nThe first output is data, the second op"
"tional output is a Status Byte. Various options affect the behaviour of the t"
"erminal and the block's output:\n\n<h4>Master:</h4>\nSet the EtherCAT Master "
"of this terminal.\n\n<h4>Slave Index:</h4>\nSet the EtherCAT slave index. Fol"
"lowing address formats are allowed:\n<ol>\n<li> Absolute addressing: a string"
" '<b><tt>n</tt></b>' representing the (zero based) absolute index. <b><tt>n</"
"tt></b> is typically larger than 0 because the first coupler has that address"
".\n\n<li> SSId addressing: the Secondary Slave Addressing has the form '<b><t"
"t>#s:n</tt></b>' where <b><tt>s</tt></b> is the Secondary Slave Id of the Eth"
"erCAT coupler and <b><tt>n</tt></b> is the offset in that field. The SSId has"
" to be preprogrammed into the coupler with other service tools.\n</ol>\n\n<h4"
">Configuration Parameters</h4>\n<dl>\n<dt><b><tt>Enable Register Reload</tt><"
"/b></dt> \n<dd>When the counter value wraps (either overflows or underflows),"
" reload the value specified in <em>Counter Reload Value</em>. This option can"
"not be used together with <em>Enable Index Reset</em></dd>\n\n<dt><b><tt>Enab"
"le Index Reset</tt></b></dt> \n<dd>activates terminal input \"C\", which rese"
"ts the counter value. This option cannot be used together with <em>Enable Reg"
"ister Reload</em>.</dd>\n\n<dt><b><tt>Enable FWD Count</tt></b></dt> \n<dd>di"
"sables quadrature evaluation of the \"A\" and \"B\" terminal inputs. Counter "
"only counts up.</dd>\n\n<dt><b><tt>Gate</tt></b></dt> \n<dd>\nStops the count"
"er on either <b>Rising</b> or <b>Falling</b> edge. This input is enabled when"
" <em>Latch Output Port</en> is enabled.\n</dd>\n\n<dt><b><tt>Frequency Window"
"</tt></b></dt>\n<dd>Value determines the width of the Window variable in incr"
"ements of 16us (whatever that means???) This input is enabled when <em>Freque"
"ncy Output Port</em> is selected</dd>\n\n<dt><b><tt>Counter Reload Value</tt>"
"</b></dt>\n<dd>The value with which the counter is reloaded in case of <em>En"
"able Register Reload</em> is activated</dd>\n</dl>\n\n<h4>Inputs</h4>\nEnable"
" <tt><b>Control Input Port</b></tt> or <tt><b>Preset Input Port</b></tt>. Ref"
"er to the documentation for these rather complex inputs. The ordering of the "
"inputs matches the ordering in the configuration mask.\n\n<h4>Output Data Typ"
"e</h4>\nChoose the block's output data type for the output signal. Available "
"are:\n<ul>\n<li><b><tt>Raw</tt></b> outputting the internal raw value as <tt>"
"uint32_T</tt> as appropriate\n<li><b><tt>Double</tt></b> outputting 0..1 corr"
"esponding to the Full Scale. Full Scale is affected by the Frame Type, SSI Fr"
"ame Size and Data Length. Refer to manufactuer's documentation.\n</ul>\n\n<h4"
">Outputs</h4>\nSelect the desired outputs as presented int the configuratoin "
"mask. The ordering matches the ordering in the mask. Refer to manufacturors d"
"ocumentation.\n\n<p>\nSet the <b>Sample Time</b> for the block. <tt>0</tt> is"
" continuous sample time (runs at the model's base rate). Setting <tt>-1</tt> "
"will try to set the time using back propagation.\n"
	  MaskPromptString	  "Master|Slave Index|Enable Register Reload|E"
"nable Index Reset|Enable FWD Count|Gate|Frequency Window (0..65535)|Counter R"
"eload Value (0..65535)  |Control Input Port|Preset Input Port|Output Data Typ"
"e|Counter Value Output Port|Latch Output Port|Frequency Output Port|Period Ou"
"tput Port|Window Output Port|Status Output Port|Sample Time (-1 inherited)"
	  MaskStyleString	  "edit,edit,checkbox,checkbox,checkbox,popup("
"None|Positive|Negative),edit,edit,checkbox,checkbox,popup(Raw bits|Double),ch"
"eckbox,checkbox,checkbox,checkbox,checkbox,checkbox,edit"
	  MaskTunableValueString  "off,off,off,off,off,off,off,off,off,off,off"
",off,off,off,off,off,off,off"
	  MaskCallbackString	  "||el5101_check('Reload');|el5101_check('Ind"
"exReset');|||||||||el5101_check('Latch');|el5101_check('Freq');||||"
	  MaskEnableString	  "on,on,on,on,on,off,off,off,on,on,on,on,on,o"
"n,on,on,on,on"
	  MaskVisibilityString	  "on,on,on,on,on,on,on,on,on,on,on,on,on,on,o"
"n,on,on,on"
	  MaskToolTipString	  "on,on,on,on,on,on,on,on,on,on,on,on,on,on,o"
"n,on,on,on"
	  MaskVarAliasString	  ",,,,,,,,,,,,,,,,,"
	  MaskVariables		  "master=@1;index=@2;reload=@3;reset=@4;fwdco"
"unt=@5;gate=@6;freqwin=@7;reloadvalue=@8;control=@9;preset=@10;dtype=@11;valu"
"e=@12;latch=@13;freq=@14;period=@15;window=@16;status=@17;tsample=@18;"
	  MaskInitialization	  "% Calculate master and domain id.\n% accept"
" 2 forms for master:\n% Scalar: master = value\n% else Vector: [master domain"
"]\nif max(size(master)) > 2\n    domain = master(2);\n    master = master(1);"
"\n    masterid = sprintf('M:%u.%u', master, domain);\nelse\n    master = mast"
"er(1);\n    domain = 0;\n    masterid = sprintf('M:%u', master);\nend\n\n% Ca"
"lculate slave alias and position, and format positionStr for\n% display in th"
"e block graphics\nif max(size(index))\n    if index(1) == '#'\n        [res,n"
"um] = sscanf(index,'#%u:%u');\n        if num ~= 2\n            res = [0 0];"
"\n        end\n    else\n        value = int16(str2num(index));\n        if ~"
"max(size(value))\n            value = [0];\n        end\n        res = [0 val"
"ue(1)];\n    end\nelse\n    res = [0 0];\nend\nalias = res(1);\nposition = re"
"s(2);\nif alias ~= 0\n    positionStr = sprintf('#%u:%u', alias, position);\n"
"else\n    positionStr = num2str(position);\nend\n\nproduct = hex2dec('1389305"
"2');\nvendor = 2;\nrevision = 1;\nmodel = 'EL5101';\n\n% PDO Entry is a defin"
"ition of all PDO's that exist in the slave\n% List here a matrix, where every"
" row has 3 elements:\n% 1: PDO index\n% 2: PDO subindex\n% 3: Bit size (8,16,"
"32); Negative values mean signed values\npdo_entry = [ ...\n    hex2dec('6000"
"'), 1, 8; ...      % Status\n    hex2dec('0000'), 0, 8; ...      % Alignment "
"space\n    hex2dec('6000'), 2, 16; ...     % Value\n    hex2dec('6000'), 3, 1"
"6; ...     % Latch\n    hex2dec('6000'), 4, 32; ...     % Frequency\n    hex2"
"dec('6000'), 5, 16; ...     % Period\n    hex2dec('6000'), 6, 16; ...     % W"
"indow\n    hex2dec('7000'), 1, 8; ...      % Control\n    hex2dec('0000'), 0,"
" 8; ...      % Alignment space\n    hex2dec('7000'), 2, 16];        % Input V"
"alue\n\n% SDO Config is the configuration of a slave\n% It is a matrix, every"
" row having 4 elements:\n% 1: SDO Index\n% 2: SDO Subindex\n% 3: Size    (8,1"
"6,32)\n% 4: value\nsdo_config = [\n    hex2dec('8000'), 1,  8, reloadvalue =="
" 1;... % Reload\n    hex2dec('8000'), 2,  8, reset == 1      ;... % Index Res"
"et\n    hex2dec('8000'), 3,  8, fwdcount == 1   ;... % Forward Count\n    hex"
"2dec('8000'), 4,  8, gate == 2       ;... % Positive Gate\n    hex2dec('8000'"
"), 5,  8, gate == 3       ;... % Negative Gate\n    hex2dec('8001'), 1, 16, f"
"reqwin         ;... % Frequency Window\n    hex2dec('8001'), 2, 16, reloadval"
"ue     ;... % Reload Value\n    ];\n\n% This maps ???\n% It is a matrix, ever"
"y row having 4 elements:\n% 1: PDO direction as seen by the slave: 0 = output"
"; 1 = Input\n% 2: PDO Index\n% 3: Starting row of PDO entry (Zero based)\n% 4"
": Number of PDO entry rows\npdo_info = [...\n    1, hex2dec('1601'), 7, 3; .."
".\n    0, hex2dec('1A01'), 0, 4; ...\n    ];\n\nif freq || period || window\n"
"    pdo_info(3,:) = [0, hex2dec('1A02'), 4, 3];\nend\n   \nport = 1;\noutput "
"= [];\nif value\n    output(port).pdo_map = [1 2];\n    if dtype == 2\n      "
"  output(port).full_scale_bits = 16;\n    end\n    \n    port = port + 1;\nen"
"d\nif latch\n    output(port).pdo_map = [1 3];\n    if dtype == 2\n        ou"
"tput(port).full_scale_bits = 16;\n    end\n    \n    port = port + 1;\nend\ni"
"f freq\n    output(port).pdo_map = [2 0];\n    if dtype == 2\n        output("
"port).full_scale_bits = 32;\n    end\n    \n    port = port + 1;\nend\nif per"
"iod\n    output(port).pdo_map = [2 1];\n    if dtype == 2\n        output(por"
"t).full_scale_bits = 16;\n    end\n    \n    port = port + 1;\nend\nif window"
"\n    output(port).pdo_map = [2 2];\n    if dtype == 2\n        output(port)."
"full_scale_bits = 16;\n    end\n    \n    port = port + 1;\nend\nif status\n "
"   output(port).pdo_map = [1 0];\n    \n    port = port + 1;\nend\n\nport = 1"
";\ninput = [];\nif control\n    input(port).pdo_map = [0 0];\n    \n    port "
"= port + 1;\nend\nif preset\n    input(port).pdo_map = [0 1];\n    if dtype ="
"= 2\n        output(port).full_scale_bits = 16;\n    end\n    \n    port = po"
"rt + 1;\nend\n"
	  MaskDisplay		  "fprintf(...\n    'EL5101\\nIncr.-Enc\\n%s I"
"dx:%s',...\n    masterid, positionStr)\n"
	  MaskIconFrame		  on
	  MaskIconOpaque	  on
	  MaskIconRotate	  "none"
	  MaskIconUnits		  "autoscale"
	  MaskValueString	  "0|'1'|off|off|off|None|100|65535|off|off|Do"
"uble|on|off|off|off|off|off|0"
	  MaskTabNameString	  ",,,,,,,,,,,,,,,,,"
	}
	Block {
	  BlockType		  "S-Function"
	  Name			  "GenericEtherCAT"
	  Ports			  [0, 2]
	  Position		  [180, 168, 265, 217]
	  BackgroundColor	  "yellow"
	  FunctionName		  "generic_ethercat"
	  Parameters		  "master,slave,vendor,product,inputs,outputs,"
"config,tsample"
	  MaskPromptString	  "Master index|Slave address|Sample time"
	  MaskStyleString	  "edit,edit,edit"
	  MaskTunableValueString  "off,off,off"
	  MaskCallbackString	  "||"
	  MaskEnableString	  "on,on,on"
	  MaskVisibilityString	  "on,on,on"
	  MaskToolTipString	  "on,on,on"
	  MaskVarAliasString	  ",,"
	  MaskVariables		  "master=@1;slave=@2;tsample=@3;"
	  MaskInitialization	  "vendor = hex2dec('00000002');\nproduct = he"
"x2dec('ffffffff');\n\noutputs(1).index = hex2dec('7000');\noutputs(1).subinde"
"x = hex2dec('00');\noutputs(1).type = 'uint16_T';\n\noutputs(2).index = hex2d"
"ec('7001');\noutputs(2).subindex = hex2dec('00');\noutputs(2).type = 'uint8_T"
"';\n\ninputs = {};\nconfig = {};"
	  MaskDisplay		  "disp('Generic\\nEtherCAT\\nSlave')"
	  MaskIconFrame		  on
	  MaskIconOpaque	  on
	  MaskIconRotate	  "none"
	  MaskIconUnits		  "autoscale"
	  MaskValueString	  "0|0|0"
	  MaskTabNameString	  ",,"
	}
	Block {
	  BlockType		  "S-Function"
	  Name			  "K-Bus"
	  Ports			  [0, 1]
	  Position		  [25, 259, 105, 301]
	  BackgroundColor	  "yellow"
	  FunctionName		  "ec_slave"
	  Parameters		  "master,domain,alias,position,model,vendor,p"
"roduct,revision,pdo_entry,pdo_info,sdo_config,input,output,tsample"
	  MaskType		  "K-Bus Input"
	  MaskDescription	  "Beckhoff EK1110 K-Bus to EtherCAT Coupler"
	  MaskHelp		  "This block provides an interface to the K-B"
"us process image for the EK1120 Coupler.\n<p>\nChoose and set the following o"
"ptions:\n<h4>Master:</h4>\nSet the EtherCAT Master of this terminal.\n\n<h4>S"
"lave Index:</h4>\nSet the EtherCAT slave index. Following address formats are"
" allowed:\n<ol>\n<li> Absolute addressing: a string '<b><tt>n</tt></b>' repre"
"senting the (zero based) absolute index. <b><tt>n</tt></b> is typically large"
"r than 0 because the first coupler has that address.\n\n<li> SSId addressing:"
" the Secondary Slave Addressing has the form '<b><tt>#s:n</tt></b>' where <b>"
"<tt>s</tt></b> is the Secondary Slave Id of the EtherCAT coupler and <b><tt>n"
"</tt></b> is the offset in that field. The SSId has to be preprogrammed into "
"the coupler with other service tools.\n</ol>\n"
	  MaskPromptString	  "Master|Slave Index|EtherCATInfo XML file|Sa"
"mple Time (-1 inherited)"
	  MaskStyleString	  "edit,edit,edit,edit"
	  MaskTunableValueString  "off,off,off,off"
	  MaskCallbackString	  "|||"
	  MaskEnableString	  "on,on,on,on"
	  MaskVisibilityString	  "on,on,on,on"
	  MaskToolTipString	  "on,on,on,on"
	  MaskVarAliasString	  ",,,"
	  MaskVariables		  "master=@1;index=@2;ethercatinfo=@3;tsample="
"@4;"
	  MaskInitialization	  "% Calculate master and domain id.\n% accept"
" 2 forms for master:\n% Scalar: master = value\n% else Vector: [master domain"
"]\nif max(size(master)) > 2\n    domain = master(2);\n    master = master(1);"
"\n    masterid = sprintf('M:%u.%u', master, domain);\nelse\n    master = mast"
"er(1);\n    domain = 0;\n    masterid = sprintf('M:%u', master);\nend\n\n% Ca"
"lculate slave alias and position, and format positionStr for\n% display in th"
"e block graphics\nif max(size(index))\n    if index(1) == '#'\n        [res,n"
"um] = sscanf(index,'#%u:%u');\n        if num ~= 2\n            res = [0 0];"
"\n        end\n    else\n        value = int16(str2num(index));\n        if ~"
"max(size(value))\n            value = [0];\n        end\n        res = [0 val"
"ue(1)];\n    end\nelse\n    res = [0 0];\nend\nalias = res(1);\nposition = re"
"s(2);\nif alias ~= 0\n    positionStr = sprintf('#%u:%u', alias, position);\n"
"else\n    positionStr = num2str(position);\nend\n\nmodel = 'BK1120';\nproduct"
" = hex2dec('04602c22');\nvendor = 2;\nrevision = 0;\n\nif ischar(ethercatinfo"
") && max(size(ethercatinfo))\n    slave = getSlaveDescription(ethercatinfo,pr"
"oduct,revision);\nelse\n    if max(size(ethercatinfo))\n        errordlg([gcb"
" ': Enter a file name for EtherCATInfo.']);\n    end\n    slave = struct('TxP"
"do', [], 'RxPdo', []);\nend\n\nsdo_config = [];\npdo_info = [];\npdo_entry = "
"[];\n\npdo_entry_idx = 1;\npdo_info_idx = 1;\n\noutput = [];\nport_idx = 1;\n"
"for i = 1:size(slave.TxPdo,2)\n    pdo_info(pdo_info_idx, :) = [ 0 slave.TxPd"
"o(i).index, ...\n        pdo_entry_idx-1 size(slave.TxPdo(i).entry,2)];\n    "
"for j = 1:size(slave.TxPdo(i).entry,2)\n        \n        if slave.TxPdo(i).e"
"ntry(j).signed\n            bitlen = -slave.TxPdo(i).entry(j).bitlen;\n      "
"  else\n            bitlen = slave.TxPdo(i).entry(j).bitlen;\n        end\n  "
"      pdo_entry(pdo_entry_idx, :) = [...\n            slave.TxPdo(i).entry(j)"
".index, ...\n            slave.TxPdo(i).entry(j).subindex, ...\n            b"
"itlen, ...\n            ];\n        pdo_entry_idx = pdo_entry_idx + 1;\n     "
"   \n        if ~slave.TxPdo(i).entry(j).index\n            continue\n       "
" end\n\n        output(port_idx).pdo_map = [pdo_info_idx-1 j-1];\n        \n "
"       port_idx = port_idx + 1;\n    end\n    pdo_info_idx = pdo_info_idx + 1"
";\nend\n\ninput = [];\nport_idx = 1;\nfor i = 1:size(slave.RxPdo,2)\n    pdo_"
"info(pdo_info_idx, :) = [ 1 slave.RxPdo(i).index, ...\n        pdo_entry_idx-"
"1 size(slave.RxPdo(i).entry,2)];\n    for j = 1:size(slave.RxPdo(i).entry,2)"
"\n        \n        if slave.RxPdo(i).entry(j).signed\n            bitlen = -"
"slave.RxPdo(i).entry(j).bitlen;\n        else\n            bitlen = slave.RxP"
"do(i).entry(j).bitlen;\n        end\n        pdo_entry(pdo_entry_idx, :) = [."
"..\n            slave.RxPdo(i).entry(j).index, ...\n            slave.RxPdo(i"
").entry(j).subindex, ...\n            bitlen, ...\n            ];\n        pd"
"o_entry_idx = pdo_entry_idx + 1;\n        \n        if ~slave.RxPdo(i).entry("
"j).index\n            continue\n        end\n\n        input(port_idx).pdo_ma"
"p = [pdo_info_idx-1 j-1];\n        \n        port_idx = port_idx + 1;\n    en"
"d\n    pdo_info_idx = pdo_info_idx + 1;\nend\n"
	  MaskDisplay		  "fprintf(...\n    'BK1120\\nK-Bus Coupler\\n"
"%s Idx:%s',...\n    masterid, positionStr);\n"
	  MaskIconFrame		  on
	  MaskIconOpaque	  on
	  MaskIconRotate	  "none"
	  MaskIconUnits		  "autoscale"
	  MaskValueString	  "0|'1'|''|0"
	  MaskTabNameString	  ",,,"
	}
	Block {
	  BlockType		  "S-Function"
	  Name			  "MSD_0"
	  Ports			  [2, 2]
	  Position		  [325, 147, 460, 218]
	  BackgroundColor	  "yellow"
	  FunctionName		  "moog_msd"
	  Parameters		  "master,index,tsample,iomode"
	  MaskType		  "Moog MSC"
	  MaskDescription	  "Moog Servodrive Controller"
	  MaskPromptString	  "Master|Slave Index|Sample Time|Input/Output"
" Mode"
	  MaskStyleString	  "edit,edit,edit,popup(Inputs and Outputs|Inp"
"uts only|Outputs only)"
	  MaskTunableValueString  "off,off,off,off"
	  MaskCallbackString	  "|||moog_msd_callback('display_callback',gcb"
")"
	  MaskEnableString	  "on,on,on,on"
	  MaskVisibilityString	  "on,on,on,on"
	  MaskToolTipString	  "on,on,on,on"
	  MaskVarAliasString	  ",,,"
	  MaskVariables		  "master=@1;index=&2;tsample=@3;iomode=@4;"
	  MaskInitialization	  "moog_msd_callback('display_callback',gcb)"
	  MaskDisplay		  "fprintf('Moog Servo Drive\\nM:%i Idx:%s', m"
"aster, index) image(imread('moog.png'), [.3, .7, .4, .2]) port_label('input',"
" 1, 'control') port_label('input', 2, 'v_tgt') port_label('output', 1, 'statu"
"s') port_label('output', 2, 'v_cur')"
	  MaskSelfModifiable	  on
	  MaskIconFrame		  on
	  MaskIconOpaque	  on
	  MaskIconRotate	  "none"
	  MaskIconUnits		  "normalized"
	  MaskValueString	  "0|0|0|Inputs and Outputs"
	  MaskTabNameString	  ",,,"
	}
	Block {
	  BlockType		  "S-Function"
	  Name			  "Master Stats"
	  Ports			  [0, 3]
	  Position		  [320, 29, 390, 61]
	  BackgroundColor	  "yellow"
	  FunctionName		  "master_stats"
	  Parameters		  "master,tsample"
	  MaskType		  "Master Status"
	  MaskDescription	  "Collects status information from EtherCAT M"
"aster\nOutputs:\n1) Bus Failure\n2) Bus topology has changed\n3) Slaves on th"
"e bus"
	  MaskPromptString	  "Master|Sample Time"
	  MaskStyleString	  "edit,edit"
	  MaskTunableValueString  "off,off"
	  MaskCallbackString	  "|"
	  MaskEnableString	  "on,on"
	  MaskVisibilityString	  "on,on"
	  MaskToolTipString	  "on,on"
	  MaskVarAliasString	  ","
	  MaskVariables		  "master=@1;tsample=@2;"
	  MaskInitialization	  "domain = num2str(master(1));\nif sum(size(m"
"aster)) == 3\n    domain = [domain '/' num2str(master(2))];\nend\n"
	  MaskDisplay		  "fprintf('Master Status\\nM/d:%s',\ndomain);"
	  MaskIconFrame		  on
	  MaskIconOpaque	  on
	  MaskIconRotate	  "none"
	  MaskIconUnits		  "autoscale"
	  MaskValueString	  "0|1"
	  MaskTabNameString	  ","
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "Obsolete"
	  Ports			  []
	  Position		  [325, 259, 425, 301]
	  OpenFcn		  "errordlg('Do not use these obsolete blocks'"
");"
	  MinAlgLoopOccurrences	  off
	  RTWSystemCode		  "Auto"
	  FunctionWithSeparateData off
	  MaskHideContents	  off
	  System {
	    Name		    "Obsolete"
	    Location		    [461, 573, 959, 873]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "A4"
	    PaperUnits		    "centimeters"
	    TiledPaperMargins	    [0.500000, 0.500000, 0.500000, 0.500000]
	    TiledPageScale	    1
	    ShowPageBoundaries	    off
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      "S-Function"
	      Name		      "INC_0"
	      Ports		      [0, 1]
	      Position		      [40, 40, 120, 80]
	      BackgroundColor	      "yellow"
	      FunctionName	      "old_el5101"
	      Parameters	      "master,index,scale,offset,dtype,status,"
"tsample"
	      MaskType		      "EL5101"
	      MaskDescription	      "Beckhoff EtherCAT Incremental Encoder I"
"nput"
	      MaskHelp		      "This block implements the EtherCAT Incr"
"emental Encoder Input Terminal EL5101.\n\nThe first output is data, the secon"
"d optional output is a Status Byte. Various options affect the behaviour of t"
"he terminal and the block's output:\n\n<h4>Master:</h4>\nSet the EtherCAT Mas"
"ter of this terminal.\n\n<h4>Slave Index:</h4>\nSet the EtherCAT slave index."
" Following address formats are allowed:\n<ol>\n<li> Absolute addressing: a nu"
"mber <<b><tt>n</tt></b>> representing the (zero based) absolute index. <b><tt"
">n</tt></b> is typically larger than 0 because the first coupler has that add"
"ress.\n\n<li> Field addressing: Has the form <<b><tt>f:n</tt></b>> where <b><"
"tt>f</tt></b> is the (zero based) EtherCAT coupler field and \n<b><tt>n</tt><"
"/b> is the terminal offset in that field. Take note that <b><tt>n</tt></b> is"
" also greater than 0.\n\n<li> SSId addressing: the Secondary Slave Addressing"
" has the form <<b><tt>#s:n</tt></b>> where <b><tt>s</tt></b> is the Secondary"
" Slave Id of the EtherCAT coupler and <b><tt>n</tt></b> is the offset in that"
" field. The SSId has to be preprogrammed into the coupler with other service "
"tools.\n</ol>\n\n<h4>Output Full Scale</h4>\nWhen <b>Output Data Type</b> is "
"set to <b>Double with scale and offset</b>, the block's output value at full "
"scale terminal input can be set here. This value  directly affects the output"
" despite a possible output LPF filter.\n\n<h4>Output Offset</h4>\nWhen <b>Out"
"put Data Type</b> is set to <b>Double with scale and offset</b>, the blocks o"
"utput at zero terminal input can be set here. Note that the Full Scale above "
"is also increased by this amount. This value  directly affects the output des"
"pite a possible output LPF filter.\n\n<h4>Output Data Type</h4>\nChoose the b"
"lock's output data type for the output signal. Available are:\n<ul>\n<li><b><"
"tt>Raw</tt></b> outputting the internal raw value as <tt>uint32_T</tt> as app"
"ropriate\n<li><b><tt>Double</tt></b> outputting 0..1 corresponding to the Ful"
"l Scale. Full Scale is affected by the Frame Type, SSI Frame Size and Data Le"
"ngth. Refer to manufactuer's documentation.\n<li><b><tt>Double with scale and"
" offset</tt></b>, allowing the output to be scaled with an offset.\n</ul>\n\n"
"<p> \nChoosing <b>Status Output</b> provides a port of type <tt>uint8_T</tt> "
"where the status is presented. Refer to manufacturors documentation for the u"
"sed coding.\n This is only enabled when <b>Vector Output</b> is selected. \n"
"\n<h4>Output Filter</h4>\nWhen not in <b>Raw</b> mode, the <b>Output Filter</"
"b> checkbox becomes available, allowing the use of an internal low pass filte"
"r. Enter the <b>LPF Time Constant</b> for the filter in the field below.\n<br"
">For continuous sample time systems (0 in Sample Time), the filter is also co"
"ntinuous. Discrete samples systems (Sample Time > 0) uses an equivalent discr"
"ete low pass filter with a similar time constant.\n\n<p>\nSet the <b>Sample T"
"ime</b> for the block. <tt>0</tt> is continuous sample time (runs at the mode"
"l's base rate). Setting <tt>-1</tt> will try to set the time using back propa"
"gation.\n"
	      MaskPromptString	      "Master|Slave Index|Output Full Scale|Ou"
"tput Offset|Output Data Type|Status Output|Sample Time"
	      MaskStyleString	      "edit,edit,edit,edit,popup(Raw bits|Doub"
"le|Double with scale and offset),checkbox,edit"
	      MaskTunableValueString  "off,off,on,on,off,off,off"
	      MaskCallbackString      "||||old_el5101_check('dtype');||"
	      MaskEnableString	      "on,on,off,off,on,off,on"
	      MaskVisibilityString    "on,on,on,on,on,off,on"
	      MaskToolTipString	      "on,on,on,on,on,on,on"
	      MaskVarAliasString      ",,,,,,"
	      MaskVariables	      "master=@1;index=&2;scale=@3;offset=@4;d"
"type=@5;status=@6;tsample=@7;"
	      MaskDisplay	      "fprintf(...\n    'EL5101\\nIncr.-Enc. I"
"nput\\nM:%i Idx:%s',...\n    master,...\n    index)\n"
	      MaskIconFrame	      on
	      MaskIconOpaque	      on
	      MaskIconRotate	      "none"
	      MaskIconUnits	      "autoscale"
	      MaskValueString	      "0|1|1|0|Double|off|0"
	      MaskTabNameString	      ",,,,,,"
	    }
	  }
	}
	Block {
	  BlockType		  "S-Function"
	  Name			  "SSI_0"
	  Ports			  [0, 1]
	  Position		  [25, 140, 105, 180]
	  BackgroundColor	  "yellow"
	  FunctionName		  "ec_slave"
	  Parameters		  "master,domain,alias,position,model,vendor,p"
"roduct,revision,pdo_entry,pdo_info,sdo_config,input,output,tsample"
	  MaskType		  "EL5001"
	  MaskDescription	  "Beckhoff EtherCAT SSI Input"
	  MaskHelp		  "This block implements the EtherCAT SSI Inpu"
"t Terminal EL5001.\n\nThe first output is data, the second optional output is"
" a Status Byte. Various options affect the behaviour of the terminal and the "
"block's output:\n\n<h4>Master:</h4>\nSet the EtherCAT Master of this terminal"
".\n\n<h4>Slave Index:</h4>\nSet the EtherCAT slave index. Following address f"
"ormats are allowed:\n<ol>\n<li> Absolute addressing: a number <<b><tt>n</tt><"
"/b>> representing the (zero based) absolute index. <b><tt>n</tt></b> is typic"
"ally larger than 0 because the first coupler has that address.\n\n<li> SSId a"
"ddressing: the Secondary Slave Addressing has the form <<b><tt>#s:n</tt></b>>"
" where <b><tt>s</tt></b> is the Secondary Slave Id of the EtherCAT coupler an"
"d <b><tt>n</tt></b> is the offset in that field. The SSId has to be preprogra"
"mmed into the coupler with other service tools.\n</ol>\n\n<h4>Output Full Sca"
"le</h4>\nWhen <b>Output Data Type</b> is set to <b>Double with scale and offs"
"et</b>, the block's output value at full scale terminal input can be set here"
". This value  directly affects the output despite a possible output LPF filte"
"r.\n\n<h4>Output Offset</h4>\nWhen <b>Output Data Type</b> is set to <b>Doubl"
"e with scale and offset</b>, the blocks output at zero terminal input can be "
"set here. Note that the Full Scale above is also increased by this amount. Th"
"is value  directly affects the output despite a possible output LPF filter.\n"
"\n<h4>Output Data Type</h4>\nChoose the block's output data type for the outp"
"ut signal. Available are:\n<ul>\n<li><b><tt>Raw</tt></b> outputting the inter"
"nal raw value as <tt>uint32_T</tt> as appropriate\n<li><b><tt>Double</tt></b>"
" outputting 0..1 corresponding to the Full Scale. Full Scale is affected by t"
"he Frame Type, SSI Frame Size and Data Length. Refer to manufactuer's documen"
"tation.\n<li><b><tt>Double with scale and offset</tt></b>, allowing the outpu"
"t to be scaled with an offset.\n</ul>\n\n<p>\nFor <b>SSI Code</b>, <b>Baudrat"
"e</b>, <b>Frame Type</b>, <b>SSI Frame Size</b>, <b>Data Length</b>, <b>Disab"
"le Frame Error</b>, <b>Enable Inhibit Time</b> and <b>Min Inhibit Time</b>, r"
"efer to manufacturer's documentation.\n<p> \nChoosing <b>Status Output</b> pr"
"ovides a port of type <tt>uint8_T</tt> where the status is presented. Refer t"
"o manufacturors documentation for the used coding.\n\n<h4>Output Filter</h4>"
"\nWhen not in <b>Raw</b> mode, the <b>Output Filter</b> checkbox becomes avai"
"lable, allowing the use of an internal low pass filter. Enter the <b>LPF Time"
" Constant</b> for the filter in the field below.\n<br>For continuous sample t"
"ime systems (0 in Sample Time), the filter is also continuous. Discrete sampl"
"es systems (Sample Time > 0) uses an equivalent discrete low pass filter with"
" a similar time constant.\n\n<p>\nSet the <b>Sample Time</b> for the block. <"
"tt>0</tt> is continuous sample time (runs at the model's base rate). Setting "
"<tt>-1</tt> will try to set the time using back propagation.\n"
	  MaskPromptString	  "Master|Slave Index|Output Full Scale|Output"
" Offset|Output Data Type|SSI Code |Baudrate |Frame Type |SSI Frame Size |Data"
" Length |Disable Frame Error|Enable Inhibit Time|Min Inhibit Time [us] (1..65"
"535)|Status Output|Output Filter|LPF Time Constant (sec)|Sample Time"
	  MaskStyleString	  "edit,edit,edit,edit,popup(Raw bits|Double|D"
"ouble with scale and offset),popup(Binary|Gray),popup(1250k|1000k|500k|250k|1"
"25k),popup(Multiturn (25 bits)|Singleturn (13 bits)|Variable (set size in Fra"
"me Size)),popup(1|2|3|4|5|6|7|8|9|10|11|12|13|14|15|16|17|18|19|20|21|22|23|2"
"4|25|26|27|28|29|30|31|32),popup(1|2|3|4|5|6|7|8|9|10|11|12|13|14|15|16|17|18"
"|19|20|21|22|23|24|25|26|27|28|29|30|31|32),checkbox,checkbox,edit,checkbox,c"
"heckbox,edit,edit"
	  MaskTunableValueString  "off,off,off,off,off,off,off,off,off,off,off"
",off,off,off,off,on,off"
	  MaskCallbackString	  "||||el5001_check('dtype');|||el5001_check('"
"frame');||||el5001_check('inhibit');|el5001_check('inh_time');||el5001_check("
"'filter');||"
	  MaskEnableString	  "on,on,off,off,on,on,on,on,off,on,on,on,off,"
"on,on,off,on"
	  MaskVisibilityString	  "on,on,on,on,on,on,on,on,on,on,on,on,on,on,o"
"n,on,on"
	  MaskToolTipString	  "on,on,on,on,on,on,on,on,on,on,on,on,on,on,o"
"n,on,on"
	  MaskVarAliasString	  ",,,,,,,,,,,,,,,,"
	  MaskVariables		  "master=@1;index=&2;scale=@3;offset=@4;dtype"
"=@5;code=@6;baud=@7;frame=@8;fsize=@9;length=@10;frame_error=@11;inhibit=@12;"
"inh_time=@13;status=@14;filter=@15;tau=@16;tsample=@17;"
	  MaskInitialization	  "% Calculate master and domain id.\n% accept"
" 2 forms for master:\n% Scalar: master = value\n% else Vector: [master domain"
"]\nif max(size(master)) > 2\n    domain = master(2);\n    master = master(1);"
"\n    masterid = sprintf('M:%u.%u', master, domain);\nelse\n    master = mast"
"er(1);\n    domain = 0;\n    masterid = sprintf('M:%u', master);\nend\n\n% Ca"
"lculate slave alias and position, and format positionStr for\n% display in th"
"e block graphics\nif max(size(index))\n    if index(1) == '#'\n        [res,n"
"um] = sscanf(index,'#%u:%u');\n        if num ~= 2\n            res = [0 0];"
"\n        end\n    else\n        value = int16(str2num(index));\n        if ~"
"max(size(value))\n            value = [0];\n        end\n        res = [0 val"
"ue(1)];\n    end\nelse\n    res = [0 0];\nend\nalias = res(1);\nposition = re"
"s(2);\nif alias ~= 0\n    positionStr = sprintf('#%u:%u', alias, position);\n"
"else\n    positionStr = num2str(position);\nend\n\nproduct = hex2dec('1389305"
"2');\nmodel = 'EL5001';\nvendor = 2;\nrevision = 1;\n\n% PDO Entry is a defin"
"ition of all PDO's that exist in the slave\n% List here a matrix, where every"
" row has 3 elements:\n% 1: PDO index\n% 2: PDO subindex\n% 3: Bit size (8,16,"
"32); Negative values mean signed values\npdo_entry = [ ...\n    hex2dec('6000"
"'), 1, 8; ...\n    hex2dec('6000'), 2, 32];\n\n% SDO Config is the configurat"
"ion of a slave\n% It is a matrix, every row having 4 elements:\n% 1: SDO Inde"
"x\n% 2: SDO Subindex\n% 3: Size    (8,16,32)\n% 4: value\nsdo_config = [\n   "
" hex2dec('4061'), 1,  8, frame_error     ;... % FrameError\n    hex2dec('4061"
"'), 2,  8, 1               ;... % Power Fail\n    hex2dec('4061'), 3,  8, inh"
"ibit         ;... % Enable Inhibit\n    hex2dec('4066'), 0,  8, code == 2    "
"   ;... % SSI Code\n    hex2dec('4067'), 0, 16, baud            ;... % Baud R"
"ate\n    hex2dec('4068'), 0,  8, frame-1         ;... % Frame Type\n    hex2d"
"ec('4069'), 0, 16, fsize           ;... % Frame Size\n    hex2dec('406A'), 0,"
" 16, length          ;... % Data Length\n    hex2dec('406B'), 0, 16, inh_time"
"        ;... % Inhibit Time\n    ];\n\n% This maps ???\n% It is a matrix, eve"
"ry row having 4 elements:\n% 1: PDO direction as seen by the slave: 0 = outpu"
"t; 1 = Input\n% 2: PDO Index\n% 3: Starting row of PDO entry (Zero based)\n% "
"4: Number of PDO entry rows\npdo_info = [0, hex2dec('1A00'), 0, 2];\n   \n% V"
"ector output chosen\n\noutput(1).pdo_map = [0 1];\nif dtype ~= 1\n    output("
"1).full_scale_bits = 32;\n    if dtype == 3\n        output(1).gain = scale;"
"\n        output(1).offset = offset;\n        output(1).gain_name = 'FullScal"
"e';\n        output(1).offset_name = 'Offset';\n    end\n    if filter\n     "
"   if sum(tau == 0)\n            errordlg([gcb ': Specify a nonzero time cons"
"tant '...\n                'for the output filter.']);\n        end\n        "
"if (tsample)\n            output(1).filter = tsample/tau;\n            output"
"(1).filter_name = 'InputWeight';\n        else\n            output(1).filter "
"= 2*pi/tau;\n            output(1).filter_name = 'Omega';\n        end\n    e"
"nd\nend\n\nif status\n    output(2).pdo_map = [0 0];\nend\n\ninput = [];\n"
	  MaskDisplay		  "fprintf('EL5001\\nSSI Input\\n%s Idx:%s',.."
".\n    masterid,positionStr)\n\n"
	  MaskSelfModifiable	  on
	  MaskIconFrame		  on
	  MaskIconOpaque	  on
	  MaskIconRotate	  "none"
	  MaskIconUnits		  "autoscale"
	  MaskValueString	  "0|1|1|0|Double|Binary|1250k|Multiturn (25 b"
"its)|25|24|off|off|1|off|off|0.1|0"
	  MaskTabNameString	  ",,,,,,,,,,,,,,,,"
	}
      }
    }
    Block {
      BlockType		      SubSystem
      Name		      "Generate Code"
      Ports		      []
      Position		      [106, 15, 209, 55]
      BackgroundColor	      "lightBlue"
      ShowName		      off
      OpenFcn		      "model=bdroot;     \ntry               \n  rtwbu"
"ild(model);\ncatch             \n  error(lasterr); \nend               \n    "
"              "
      FontName		      "Arial"
      FontSize		      12
      FontWeight	      "bold"
      MinAlgLoopOccurrences   off
      RTWSystemCode	      "Auto"
      FunctionWithSeparateData off
      MaskHideContents	      off
      MaskDisplay	      "disp(['Generate Code\\n',...\n	  '(doubl"
"e-click)'])"
      MaskIconFrame	      on
      MaskIconOpaque	      on
      MaskIconRotate	      "none"
      MaskIconUnits	      "autoscale"
      System {
	Name			"Generate Code"
	Location		[1035, 233, 1395, 566]
	Open			off
	ModelBrowserVisibility	off
	ModelBrowserWidth	200
	ScreenColor		"white"
	PaperOrientation	"landscape"
	PaperPositionMode	"auto"
	PaperType		"usletter"
	PaperUnits		"inches"
	TiledPaperMargins	[0.500000, 0.500000, 0.500000, 0.500000]
	TiledPageScale		1
	ShowPageBoundaries	off
	ZoomFactor		"100"
      }
    }
    Block {
      BlockType		      SubSystem
      Name		      "Hilscher"
      Ports		      []
      Position		      [295, 229, 366, 290]
      MinAlgLoopOccurrences   off
      RTWSystemCode	      "Auto"
      FunctionWithSeparateData off
      MaskHideContents	      off
      System {
	Name			"Hilscher"
	Location		[20, 469, 368, 718]
	Open			off
	ModelBrowserVisibility	off
	ModelBrowserWidth	200
	ScreenColor		"white"
	PaperOrientation	"landscape"
	PaperPositionMode	"auto"
	PaperType		"A4"
	PaperUnits		"centimeters"
	TiledPaperMargins	[0.500000, 0.500000, 0.500000, 0.500000]
	TiledPageScale		1
	ShowPageBoundaries	off
	ZoomFactor		"100"
	Block {
	  BlockType		  "S-Function"
	  Name			  "PD_In"
	  Ports			  [0, 1]
	  Position		  [45, 25, 115, 65]
	  BackgroundColor	  "yellow"
	  FunctionName		  "cif_pd_in"
	  Parameters		  "device,addr,ip_type,width,swap,op_type,tsam"
"ple"
	  MaskType		  "Profibus Input"
	  MaskDescription	  "Hilscher CIF-80PB Profibus Input"
	  MaskHelp		  "This block provides an interface to the Pro"
"fibus incoming process image for the Hilscher CIF-80PB Card.\n<p>\nSupply the"
" following information:<br>\n<b>PCI Device</b>: Either supply the address in "
"PCI-Addressing format <em>bus:slot</em> (hexadecimal format), or the (decimal"
") position as cards are detected "
	  MaskPromptString	  "PCI Device|Address|Sensor Data Type|Vector "
"Length|Swap Input Bytes|Output Data Format|Sample Time (-1 inherited)"
	  MaskStyleString	  "edit,edit,popup(Bit0|Bit1|Bit2|Bit3|Bit4|Bi"
"t5|Bit6 |Bit7|int8_T|uint8_T|int16_T|uint16_T|int32_T|uint32_T),edit,checkbox"
",popup(int8|uint8|int16|uint16|int32|uint32|boolean|double|single|Inherited v"
"ia back propagation),edit"
	  MaskTunableValueString  "off,off,off,off,off,off,off"
	  MaskCallbackString	  "||||||"
	  MaskEnableString	  "on,on,on,on,on,on,on"
	  MaskVisibilityString	  "on,on,on,on,on,on,on"
	  MaskToolTipString	  "on,on,on,on,on,on,on"
	  MaskVarAliasString	  ",,,,,,"
	  MaskVariables		  "device=&1;addr=@2;ip_type=@3;width=@4;swap="
"@5;op_type=@6;tsample=@7;"
	  MaskInitialization	  "device = test_var(device);"
	  MaskDisplay		  "fprintf('CIF-80PB\\nPCI: %s\\nAddr:%i',\nde"
"vice,addr);"
	  MaskIconFrame		  on
	  MaskIconOpaque	  on
	  MaskIconRotate	  "none"
	  MaskIconUnits		  "autoscale"
	  MaskValueString	  "01:0E|120|int8_T|8|off|int8|0"
	  MaskTabNameString	  ",,,,,,"
	}
	Block {
	  BlockType		  "S-Function"
	  Name			  "PD_Out"
	  Ports			  [1]
	  Position		  [40, 100, 110, 140]
	  BackgroundColor	  "yellow"
	  FunctionName		  "cif_pd_out"
	  Parameters		  "device,addr,op_type,swap,tsample"
	  MaskType		  "Profibus Input"
	  MaskDescription	  "Hilscher CIF-80PB Profibus Output"
	  MaskHelp		  "This block provides an interface to the Pro"
"fibus outgoing process image for the Hilscher CIF-80PB Card.\n<p>\nSupply the"
" following information:<br>\n<b>PCI Device</b>: Either supply the address in "
"PCI-Addressing format <em>bus:slot</em> (hexadecimal format), or the (decimal"
") position as cards are detected "
	  MaskPromptString	  "PCI Device|Address|Actuator Data Type|Swap "
"Input Bytes|Sample Time (-1 inherited)"
	  MaskStyleString	  "edit,edit,popup(Bit0|Bit1|Bit2|Bit3|Bit4|Bi"
"t5|Bit6 |Bit7|int8_T|uint8_T|int16_T|uint16_T|int32_T|uint32_T),checkbox,edit"
	  MaskTunableValueString  "off,off,off,off,off"
	  MaskCallbackString	  "||||"
	  MaskEnableString	  "on,on,on,on,on"
	  MaskVisibilityString	  "on,on,on,on,on"
	  MaskToolTipString	  "on,on,on,on,on"
	  MaskVarAliasString	  ",,,,"
	  MaskVariables		  "device=&1;addr=@2;op_type=@3;swap=@4;tsampl"
"e=@5;"
	  MaskInitialization	  "device = test_var(device);"
	  MaskDisplay		  "fprintf('CIF-80PB\\nPCI: %s\\nAddr:%i',\nde"
"vice,addr);"
	  MaskIconFrame		  on
	  MaskIconOpaque	  on
	  MaskIconRotate	  "none"
	  MaskIconUnits		  "autoscale"
	  MaskValueString	  "01:0E|120|int8_T|off|-1"
	  MaskTabNameString	  ",,,,"
	}
      }
    }
    Block {
      BlockType		      "S-Function"
      Name		      "In"
      Ports		      [0, 1]
      Position		      [445, 210, 525, 250]
      BackgroundColor	      "yellow"
      FunctionName	      "etherlab_in"
      Parameters	      "varname,src_dtype,len,scale,offset,out_dtype,ts"
"ample"
      MaskType		      "Generic Output Port"
      MaskPromptString	      "Signal Name|Source Data Type|Array Length|Outpu"
"t Scale|Output Offset|Block Output Data Type|Sample Time (-1 for inherited)"
      MaskStyleString	      "edit,popup(boolean|int8|uint8|int16|uint16|int3"
"2|uint32|single|double),edit,edit,edit,popup(Same as Source|Double|Double wit"
"h Scale and Offset),edit"
      MaskTunableValueString  "off,off,off,off,off,off,off"
      MaskCallbackString      "||||||"
      MaskEnableString	      "on,on,on,on,on,on,on"
      MaskVisibilityString    "on,on,on,on,on,on,on"
      MaskToolTipString	      "on,on,on,on,on,on,on"
      MaskVarAliasString      ",,,,,,"
      MaskVariables	      "varname=@1;src_dtype=@2;len=@3;scale=@4;offset="
"@5;out_dtype=@6;tsample=@7;"
      MaskDisplay	      "fprintf(varname)\n"
      MaskIconFrame	      on
      MaskIconOpaque	      on
      MaskIconRotate	      "none"
      MaskIconUnits	      "autoscale"
      MaskValueString	      "'SIG01'|boolean|1|0|0|Same as Source|0"
      MaskTabNameString	      ",,,,,,"
    }
    Block {
      BlockType		      "S-Function"
      Name		      "Out"
      Ports		      [1]
      Position		      [445, 145, 525, 185]
      BackgroundColor	      "yellow"
      FunctionName	      "etherlab_out"
      Parameters	      "varname,dtype,tsample"
      MaskType		      "Generic Output Port"
      MaskPromptString	      "Signal Name|Output Data Type|Sample Time (-1 fo"
"r inherited)"
      MaskStyleString	      "edit,popup(Inherited|boolean|int8|uint8|int16|u"
"int16|int32|uint32|int64|uint64|single|double),edit"
      MaskTunableValueString  "off,off,off"
      MaskCallbackString      "||"
      MaskEnableString	      "on,on,on"
      MaskVisibilityString    "on,on,on"
      MaskToolTipString	      "on,on,on"
      MaskVarAliasString      ",,"
      MaskVariables	      "varname=@1;dtype=@2;tsample=@3;"
      MaskDisplay	      "fprintf(varname)\n"
      MaskIconFrame	      on
      MaskIconOpaque	      on
      MaskIconRotate	      "none"
      MaskIconUnits	      "autoscale"
      MaskValueString	      "'SIG01'|Inherited|-1"
      MaskTabNameString	      ",,"
    }
    Block {
      BlockType		      SubSystem
      Name		      "Printf"
      Ports		      [2]
      Position		      [115, 154, 215, 196]
      MinAlgLoopOccurrences   off
      RTWSystemCode	      "Auto"
      FunctionWithSeparateData off
      MaskHideContents	      off
      MaskPromptString	      "Format String"
      MaskStyleString	      "edit"
      MaskTunableValueString  "off"
      MaskEnableString	      "on"
      MaskVisibilityString    "on"
      MaskToolTipString	      "on"
      MaskVariables	      "format=&1;"
      MaskIconFrame	      on
      MaskIconOpaque	      on
      MaskIconRotate	      "none"
      MaskIconUnits	      "autoscale"
      MaskValueString	      "0"
      System {
	Name			"Printf"
	Location		[761, 352, 1259, 652]
	Open			off
	ModelBrowserVisibility	off
	ModelBrowserWidth	200
	ScreenColor		"white"
	PaperOrientation	"landscape"
	PaperPositionMode	"auto"
	PaperType		"usletter"
	PaperUnits		"inches"
	TiledPaperMargins	[0.500000, 0.500000, 0.500000, 0.500000]
	TiledPageScale		1
	ShowPageBoundaries	off
	ZoomFactor		"100"
	Block {
	  BlockType		  Inport
	  Name			  "Trigger"
	  Position		  [75, 58, 105, 72]
	  IconDisplay		  "Port number"
	}
	Block {
	  BlockType		  Inport
	  Name			  "Data"
	  Position		  [75, 128, 105, 142]
	  Port			  "2"
	  IconDisplay		  "Port number"
	}
	Block {
	  BlockType		  SubSystem
	  Name			  "Triggered\nSubsystem"
	  Ports			  [1, 0, 0, 1]
	  Position		  [185, 114, 285, 156]
	  TreatAsAtomicUnit	  on
	  MinAlgLoopOccurrences	  off
	  RTWSystemCode		  "Auto"
	  FunctionWithSeparateData off
	  MaskHideContents	  off
	  System {
	    Name		    "Triggered\nSubsystem"
	    Location		    [409, 398, 907, 698]
	    Open		    off
	    ModelBrowserVisibility  off
	    ModelBrowserWidth	    200
	    ScreenColor		    "white"
	    PaperOrientation	    "landscape"
	    PaperPositionMode	    "auto"
	    PaperType		    "usletter"
	    PaperUnits		    "inches"
	    TiledPaperMargins	    [0.500000, 0.500000, 0.500000, 0.500000]
	    TiledPageScale	    1
	    ShowPageBoundaries	    off
	    ZoomFactor		    "100"
	    Block {
	      BlockType		      Inport
	      Name		      "In1"
	      Position		      [110, 103, 140, 117]
	      IconDisplay	      "Port number"
	    }
	    Block {
	      BlockType		      TriggerPort
	      Name		      "Trigger"
	      Ports		      []
	      Position		      [225, 20, 245, 40]
	      StatesWhenEnabling      "held"
	    }
	    Block {
	      BlockType		      "S-Function"
	      Name		      "S-Function"
	      Ports		      [1, 1]
	      Position		      [200, 95, 260, 125]
	      FunctionName	      "printf"
	      Parameters	      "format"
	    }
	    Line {
	      SrcBlock		      "In1"
	      SrcPort		      1
	      DstBlock		      "S-Function"
	      DstPort		      1
	    }
	  }
	}
	Line {
	  SrcBlock		  "Trigger"
	  SrcPort		  1
	  Points		  [125, 0]
	  DstBlock		  "Triggered\nSubsystem"
	  DstPort		  trigger
	}
	Line {
	  SrcBlock		  "Data"
	  SrcPort		  1
	  Points		  [0, 0]
	  DstBlock		  "Triggered\nSubsystem"
	  DstPort		  1
	}
      }
    }
    Block {
      BlockType		      "S-Function"
      Name		      "Raise"
      Ports		      [1]
      Position		      [170, 235, 230, 265]
      BackgroundColor	      "red"
      CopyFcn		      "raise_check(gcb,'CheckCopy');"
      FunctionName	      "raise"
      Parameters	      "ErrId,ErrStr,TSample"
      MaskPromptString	      "Error Identifier|Error String|Sample Time (-1 i"
"nherited)|Destination Paths|Destination Count"
      MaskStyleString	      "edit,edit,edit,edit,edit"
      MaskTunableValueString  "off,off,off,off,off"
      MaskCallbackString      "raise_check(gcb,'CheckId');||||"
      MaskEnableString	      "on,on,on,off,on"
      MaskVisibilityString    "on,on,on,off,off"
      MaskToolTipString	      "on,on,on,on,on"
      MaskVarAliasString      ",,,,"
      MaskVariables	      "ErrId=&1;ErrStr=&2;TSample=@3;DstPath=&4;DstCou"
"nt=@5;"
      MaskDisplay	      "fprintf('%s',ErrId);"
      MaskIconFrame	      on
      MaskIconOpaque	      on
      MaskIconRotate	      "none"
      MaskIconUnits	      "autoscale"
      MaskValueString	      "E10|Voltage Too High|-1|0|0"
      MaskTabNameString	      ",,,,"
    }
    Block {
      BlockType		      "S-Function"
      Name		      "Raise\nSummary"
      Ports		      []
      Position		      [175, 290, 235, 320]
      BackgroundColor	      "red"
      CopyFcn		      "raise_summary_check(gcb,'CheckCopy');"
      FunctionName	      "raise_summary"
      Parameters	      "ErrId,ErrStr,ErrSrc,DstPath"
      MaskPromptString	      "Error Identifier|Error String|Error Sources|Des"
"tination Paths"
      MaskStyleString	      "edit,edit,edit,edit"
      MaskTunableValueString  "off,off,off,off"
      MaskCallbackString      "|||"
      MaskEnableString	      "on,on,on,off"
      MaskVisibilityString    "on,on,on,off"
      MaskToolTipString	      "on,on,on,on"
      MaskVarAliasString      ",,,"
      MaskVariables	      "ErrId=&1;ErrStr=&2;ErrSrc=&3;DstPath=&4;"
      MaskDisplay	      "fprintf('%s\\n%s',ErrId,ErrSrc);"
      MaskIconFrame	      on
      MaskIconOpaque	      on
      MaskIconRotate	      "none"
      MaskIconUnits	      "autoscale"
      MaskValueString	      "E1x|Voltage Too High|E10|0"
      MaskTabNameString	      ",,,"
    }
    Block {
      BlockType		      "S-Function"
      Name		      "World Time"
      Ports		      [0, 1]
      Position		      [435, 49, 505, 81]
      BackgroundColor	      "yellow"
      FunctionName	      "world_time"
      Parameters	      "tsample"
      MaskType		      "World Time"
      MaskDescription	      "Outputs the current world time for the sample t"
"ime."
      MaskHelp		      "This block outputs the hosts current real world"
" time in seconds since 1.1.1970"
      MaskPromptString	      "Sample Time"
      MaskStyleString	      "edit"
      MaskTunableValueString  "off"
      MaskEnableString	      "on"
      MaskVisibilityString    "on"
      MaskToolTipString	      "on"
      MaskVariables	      "tsample=@1;"
      MaskIconFrame	      on
      MaskIconOpaque	      on
      MaskIconRotate	      "none"
      MaskIconUnits	      "autoscale"
      MaskValueString	      "0"
    }
    Block {
      BlockType		      SubSystem
      Name		      "cbdb"
      Ports		      []
      Position		      [75, 300, 126, 330]
      CopyFcn		      "if ~strcmp(gcs,'rtai_lib')\ndisplay('CopyFcn');"
"       \nend                       "
      DeleteFcn		      "if ~strcmp(gcs,'rtai_lib')\ndisplay('DeleteFcn'"
");     \nend                       "
      UndoDeleteFcn	      "if ~strcmp(gcs,'rtai_lib')\ndisplay('UndoDelete"
"Fcn'); \nend                       "
      LoadFcn		      "if ~strcmp(gcs,'rtai_lib')\ndisplay('LoadFcn');"
"       \nend                       "
      ModelCloseFcn	      "if ~strcmp(gcs,'rtai_lib')\ndisplay('ModelClose"
"Fcn'); \nend                       "
      PreSaveFcn	      "if ~strcmp(gcs,'rtai_lib')\ndisplay('PreSaveFcn"
"');    \nend                       "
      PostSaveFcn	      "if ~strcmp(gcs,'rtai_lib')\ndisplay('PostSaveFc"
"n');   \nend                       "
      InitFcn		      "if ~strcmp(gcs,'rtai_lib')\ndisplay('InitFcn');"
"       \nend                       "
      StartFcn		      "if ~strcmp(gcs,'rtai_lib')\ndisplay('StartFcn')"
";      \nend                       "
      StopFcn		      "if ~strcmp(gcs,'rtai_lib')\ndisplay('StopFcn');"
"       \nend                       "
      NameChangeFcn	      "if ~strcmp(gcs,'rtai_lib')\ndisplay('NameChange"
"Fcn'); \nend                       "
      ClipboardFcn	      "if ~strcmp(gcs,'rtai_lib')\ndisplay('ClipboardF"
"cn');  \nend                       "
      DestroyFcn	      "if ~strcmp(gcs,'rtai_lib')\ndisplay('DestroyFcn"
"');    \nend                       "
      OpenFcn		      "if ~strcmp(gcs,'rtai_lib')\ndisplay('OpenFcn');"
"       \nend                       "
      CloseFcn		      "if ~strcmp(gcs,'rtai_lib')\ndisplay('CloseFcn')"
";      \nend                       "
      ParentCloseFcn	      "if ~strcmp(gcs,'rtai_lib')\ndisplay('ParentClos"
"eFcn');\nend                       "
      MoveFcn		      "if ~strcmp(gcs,'rtai_lib')\ndisplay('MoveFcn');"
"       \nend                       "
      MinAlgLoopOccurrences   off
      RTWSystemCode	      "Auto"
      FunctionWithSeparateData off
      MaskHideContents	      off
      MaskDisplay	      "disp('Callback\\nDebugger');"
      MaskIconFrame	      on
      MaskIconOpaque	      on
      MaskIconRotate	      "none"
      MaskIconUnits	      "autoscale"
      System {
	Name			"cbdb"
	Location		[65, 462, 230, 544]
	Open			off
	ModelBrowserVisibility	off
	ModelBrowserWidth	200
	ScreenColor		"white"
	PaperOrientation	"landscape"
	PaperPositionMode	"auto"
	PaperType		"A4"
	PaperUnits		"centimeters"
	TiledPaperMargins	[0.500000, 0.500000, 0.500000, 0.500000]
	TiledPageScale		1
	ShowPageBoundaries	off
	ZoomFactor		"100"
      }
    }
  }
}
